function isMouseEventSupported(eventName){var el=document.createElement("div");eventName="on"+eventName;var isSupported=eventName in el;return isSupported||(el.setAttribute(eventName,"return;"),isSupported="function"==typeof el[eventName]),el=null,isSupported}(function(){var __slice=[].slice;window.namespace=function(target,name,block){var item,top,_i,_len,_ref,_ref1;for(arguments.length<3&&(_ref=[window].concat(__slice.call(arguments)),target=_ref[0],name=_ref[1],block=_ref[2]),top=target,_ref1=name.split("."),_i=0,_len=_ref1.length;_len>_i;_i++)item=_ref1[_i],target=target[item]||(target[item]={});return block(target,top)}}).call(this),function(){var console;$.extend($.easing,{easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b}}),window.console||(console={}),console&&!console.log&&(console.log=function(){})}.call(this),function(){var Typeform;Typeform=function(){function Typeform(element,logicJumpsController,scoreCalculator,priceCalculator,submitButton,settings,currencyFormatter,numberFormatter,controlsFactory,observer,outrosCollection,hiddenFields,performanceLogger,submissionRepository){var resizeEvent,self,timeout,_this=this;this.logicJumpsController=logicJumpsController,this.scoreCalculator=scoreCalculator,this.priceCalculator=priceCalculator,this.submitButton=submitButton,this.currencyFormatter=currencyFormatter,this.numberFormatter=numberFormatter,this.controlsFactory=controlsFactory,this.observer=observer,this.outrosCollection=outrosCollection,this.hiddenFields=hiddenFields,this.performanceLogger=performanceLogger,this.submissionRepository=submissionRepository,self=this,this.settings=$.extend({},defaults,settings),this.setIsMobile(),this.templates={stripeDescription:$("#stripe-field-description").html(),stripeLogo:$("#stripe-logo").html()},this.$typeform=$(element),$("body").addClass("resizing"),this.init(),_.defer(function(){return _this.start()}),resizeEvent="touch"===this.settings.browser?"orientationchange":"resize",timeout="touch"===this.settings.browser?1e3:200,$(window).on(resizeEvent,_.debounce(function(){return"touch"===Globals.browser&&$(":focus").blur(),$("body").addClass("resizing"),self.Loader.show()},timeout,!0)),$(window).on(resizeEvent,_.debounce(function(){return self.resize(),self.Loader.hide()},timeout))}var afterHideLoader,defaults,hideInitialLoad,initializeLogicJumps,initializePiping,setEmptyAlert,showCurrentPage;return defaults={browser:"default",parent:!1,uid:0},Typeform.prototype.setIsMobile=function(){return Globals.isMobile="touch"===this.settings.browser&&$(window).width()<600},Typeform.prototype.init=function(){var $form,$intro,self,_this=this;self=this,this.Loader=new App.Loader($("#loader"),this.settings.showLoadingBranding,App.singletons.performanceLogger),this.extend(),$intro=this.$typeform.find(".intro"),this.hasIntro=$intro.length,$form=this.$typeform.find(".form"),this.hasForm=$form.length,this.hasIntro&&(this.Intro=new App.Screen($intro,this.observer,{browser:Globals.browser,onClose:function(){return self.hasForm?(self.Form.show(),self.Form.open()):setEmptyAlert()}})),this.hasForm&&(this.Form=new App.Form($form,this.logicJumpsController,this.scoreCalculator,this.priceCalculator,this.submitButton,this.observer,this.templates,{stripePublishableKey:this.settings.stripePublishableKey,onClose:function(){return _this.outrosCollection.open(),Globals.showLogo&&!_this.outrosCollection.isBrandedOutroActive()&&("default"===Globals.browser?_.delay(function(){return App.Banner.render(App.Texts["banner-text"],App.Texts["banner-link"])},800):App.Banner.render(App.Texts["banner-text"],App.Texts["banner-link"],!0)),_this}},this.currencyFormatter,this.numberFormatter,this.controlsFactory,this.submissionRepository)),$("#phishingLink").length&&$("#phishingLink").attr("href",$("#phishingLink").attr("href").replace("{{UID}}",this.settings.uid))},Typeform.prototype.start=function(){var _this=this;return this.Loader.show(),this.resize(),_.defer(function(){return $("body").addClass("form-ready"),hideInitialLoad.call(_this),initializePiping.call(_this),_this.hasForm&&initializeLogicJumps.call(_this),showCurrentPage.call(_this),afterHideLoader.call(_this)})},Typeform.prototype.resize=function(){return $("body").addClass("resizing"),this.setIsMobile(),this.hasIntro&&this.Intro.resize(),this.hasForm&&this.Form.resize($(window).height()),this.outrosCollection.resize(),$("body").removeClass("resizing")},setEmptyAlert=function(){return $("<div class='empty-form primaryColor fontFamily'>"+App.Texts["form-empty"]+"</div>").fadeIn(200).appendTo($("#typeform"))},Typeform.prototype.extend=function(){var $asterisk,self;return self=this,this.updateFontClass(settings.font),$("body").removeClass("preload"),"preview"===this.settings.parent&&(document.domain="typeform.com"),$("input,textarea,select").each(function(){return $(this).attr("autocomplete","off")}),$asterisk=$("<span class='asterisk'>*</span>"),this.$typeform.find(".questions > .required").each(function(){return $(this).find(".question").children("span").append($asterisk.clone())}),App.Utils.setContainerColor(App.Utils.getCssValue("backgroundColor","background-color"),App.Utils.getCssValue("secondaryColor","color")),"default"===Globals.browser&&("field"===this.settings.parent?$("#typeform").on("updateControl",this,_updateControl):("design"===this.settings.parent||"preview"===this.settings.parent)&&(parent.previewReady(),$("#typeform").on("updateStyle",_updateStyle).on("loadingFont",function(){return self.Loader.show()}).on("appliedFont",function(){return setTimeout(function(){return self.resize(),self.Loader.hide()},200)}))),parent?$(document).on("keydown",function(e){var key;return key=document.all?e.keyCode:e.which,App.Keyboard.isEsc(key)?parent.postMessage("ESC","*"):void 0}):void 0},Typeform.prototype.updateFontClass=function(font){var fontName;return(fontName=this.getFont(font))?$("body").alterClass("font-family-*","font-family-"+fontName):void 0},Typeform.prototype.getFont=function(fontStr){return fontStr?fontStr.split(":")[0].replace(/\+/g,"-").toLowerCase():void 0},initializePiping=function(){return this.textConnector=new App.TextConnector({appSettings:this.settings,form:this.Form,intro:this.Intro,outros:this.outrosCollection.get(),scoreCalculator:this.scoreCalculator,priceCalculator:this.priceCalculator,currencyFormatter:this.currencyFormatter,numberFormatter:this.numberFormatter,hiddenFields:this.hiddenFields}),$(document).data("hidden",this.textConnector.getHiddenFields())},initializeLogicJumps=function(){return this.Form.check()},hideInitialLoad=function(){return this.hasIntro?this.Loader.hideInitialLoad(this.Intro):this.Loader.hideInitialLoad()},showCurrentPage=function(){return this.outrosCollection.hide(),this.hasIntro?(this.hasForm&&this.Form.hide(),this.Intro.show(),this.Intro.open()):"field"===Globals.parent?_.isEmpty(this.outrosCollection.get())?this.Form.open():(this.hasForm&&this.Form.hide(),Globals.showLogo&&App.Banner.render(App.Texts["banner-text"],App.Texts["banner-link"]),this.outrosCollection.resetActive(),this.outrosCollection.open()):this.hasForm?this.Form.open(0,!1):setEmptyAlert()},afterHideLoader=function(){return this.hasForm?this.Form.afterHideLoader():void 0},Typeform}(),namespace("App",function(exports){return exports.Typeform=Typeform})}.call(this),function(){var Loader;Loader=function(){function Loader($loader,delay,performanceLogger){this.$loader=$loader,this.delay=delay,this.performanceLogger=performanceLogger}return Loader.prototype.minimumDelay=1500,Loader.prototype.showCalled=null,Loader.prototype.show=function(){return this.showCalled=new Date,this.$loader.show()},Loader.prototype.hide=function(intro){return intro&&intro.attachment&&intro.attachment.isAttachmentAGif()&&intro.attachment.$img.hide(),intro&&intro.attachment&&intro.attachment.isAttachmentAGif()&&(intro.attachment.$img.css({opacity:0}),intro.attachment.$img.show(),intro.attachment.restartGif()),this.$loader.hide()},Loader.prototype.hideInitialLoad=function(intro){var timeElapsed,_this=this;return this.performanceLogger.typeformLoaded(),timeElapsed=new Date-this.showCalled,this.delay&&timeElapsed<this.minimumDelay?setTimeout(function(){return _this.hide(intro)},this.minimumDelay-timeElapsed):this.hide(intro)},Loader}(),namespace("App",function(exports){return exports.Loader=Loader})}.call(this),function(){var Screen;Screen=function(){function Screen($screen,observer,settings){this.$screen=$screen,this.observer=observer,this.settings=$.extend({},defaults,settings),this.id=this.$screen.attr("id"),this.hasButton=this.$screen.data("field"),this.isActive=this.settings.isActive,this.isDefaultBranded=this.$screen.hasClass("defaultOutroBranded"),this.init()}var defaults,getUrlIcon,loadShareIcon,onWindowLoad,shareIcons;return Screen.prototype.id=null,Screen.prototype.isActive=!0,Screen.prototype.hasButton=!0,Screen.prototype.isDefaultBranded=!1,defaults={onClose:function(){},persistentFooter:!0,templateSettings:{interpolate:/\{\{([a-zA-Z0-9_ ]+)\}\}/g}},shareIcons=["facebook","twitter","linkedin","googleplus","buffer"],getUrlIcon=function(iconName){return window.settings.baseAssetPath+("quickyformapp/images/sharing-icons/share-"+iconName+".png")},Screen.prototype.init=function(){var $attachment;return this.$contentWrapper=this.$screen.find(".content-wrapper"),this.$media=this.$contentWrapper.find(".media"),this.$text=this.$contentWrapper.find(".text"),this.$description=this.$contentWrapper.find(".description"),this.$buttonWrapper=this.$contentWrapper.find(".button-wrapper"),this.$button=this.$screen.find(".button"),this.$footer=this.$screen.find(".footer"),this.connectRedirectUrl(),this.loadShareIcons(),$attachment=this.$screen.find(".attachment"),this.attachment=$attachment.length?new App.Attachment($attachment,{useLazyLoad:!0,preventUpdate:!0,browser:this.settings.browser}):!1},Screen.prototype.loadShareIcons=function(){return this.$shareIconsWrapper=this.$contentWrapper.find(".social"),window.addEventListener?window.addEventListener("load",_.bind(onWindowLoad,this)):window.attachEvent("onload",_.bind(onWindowLoad,this))},Screen.prototype.getUsedVars=function(sentence){return sentence.match(/[^[\{{][a-zA-Z0-9_]+(?=}})/g)},Screen.prototype.open=function(){var self;return self=this,"field"!==Globals.parent&&this.bindEvents(),$(window).scrollTop(0),this.$screen.fadeIn(Globals.pageTransitionDelay,function(){var $iframe;return self.attachment&&self.attachment.load(),$iframe=self.$screen.find("iframe"),$iframe.attr("src",$iframe.attr("src"))})},Screen.prototype.close=function(){var self;return self=this,this.$screen.fadeOut(Globals.pageTransitionDelay,function(){return self.settings.onClose(),self.$screen.remove()}),this.unbindEvents()},Screen.prototype.show=function(){return this.$screen.show()},Screen.prototype.hide=function(){return this.$screen.hide()},Screen.prototype.bindEvents=function(){var redirectUrl,self;return self=this,redirectUrl=_.template(this.getRedirectURL(),this.urlModel.toJSON(),this.settings.templateSettings),redirectUrl&&"reload"!==redirectUrl&&self.$button.attr("href",_.unescape(redirectUrl)),this.$screen.on("touchend.screen mouseup.screen",".button",this,function(e){return self=e.data,"reload"===redirectUrl?(location.reload(!0),!1):""===redirectUrl?(self.close(),!1):void 0}),Globals.useKeyboardEvents?$(document).on("keydown.screen",function(e){var key;return key=document.all?e.keyCode:e.which,App.Keyboard.isEnter(key)||App.Keyboard.isTab(key)?("reload"===redirectUrl||""===redirectUrl?self.hasButton&&self.$button.mouseup():window===top?window.location.href=redirectUrl:parent.postMessage(redirectUrl,"*"),!1):void 0}):void 0},Screen.prototype.unbindEvents=function(){return this.$screen.off(".screen"),$(document).off(".screen"),$("body").off(".touchScroll")},Screen.prototype.getRedirectURL=function(){var $redirect,rUrl;return $redirect=this.$screen.find("#redirect-button-url"),rUrl="",$redirect.length&&(rUrl=_.unescape($redirect.val()),rUrl?this.$screen.find(".button").attr("href",rUrl):rUrl="reload"),rUrl},Screen.prototype.getUrlModel=function(){return this.urlModel},Screen.prototype.connectRedirectUrl=function(){var url,usedVars,_this=this;return url=this.getRedirectURL(),usedVars=this.getUsedVars(url),this.urlModel=new Backbone.Model,_.each(usedVars,function(varname){return _this.urlModel.set(varname,void 0)})},Screen.prototype.update=function(obj){var $attachment,$image,$media,$placeholder,attachment,attachmentObject,resizeScreen,self;return self=this,"undefined"!=typeof obj.text&&(""===obj.text?this.$text.hide():this.$text.show().html(obj.text)),"undefined"!=typeof obj.description&&(""===obj.description?this.$description.hide():this.$description.show().html(obj.description)),"undefined"!=typeof obj.button&&(""===obj.button?(this.persistentFooter=!1,this.$screen.find(".button-wrapper").hide(),this.$button=this.$screen.find(".button-wrapper").children(".button")):(this.persistentFooter=!0,this.$screen.find(".button-wrapper").show().children(".button").html(obj.button),this.$button=this.$screen.find(".misco"))),"undefined"!=typeof obj.social&&(obj.social===!0&&this.$screen.find(".social").show(),obj.social===!1&&this.$screen.find(".social").hide()),$media=this.$screen.find(".media"),$placeholder=$media.children(".placeholder"),$image=$media.children(".attachment"),attachmentObject=obj.attachment,"string"==typeof attachmentObject?"placeholder"===attachmentObject?($media.show(),$placeholder.show(),$image.remove()):($media.hide(),$image.remove()):"object"==typeof attachmentObject&&($attachment=$media.children(".attachment"),$attachment.length&&$attachment.remove(),$attachment=$("<div class='attachment'/>"),$media.prepend($attachment),""!==attachmentObject.image&&$attachment.html('<img src="" width="0" height="0"/>'),$media.show().css("height",""),$attachment.data("attachment",attachmentObject),attachment=new App.Attachment($attachment,{useLazyLoad:!0,browser:this.settings.browser,useFreezeFrame:!1}),clearTimeout(trimeoutAttachment),attachment.load(),$placeholder.hide()),resizeScreen=function(){var height;return height=$placeholder.width()/3,$placeholder.css("height",Math.max(160,height))},$(window).off("resize.intro-update").on("resize.intro-update",resizeScreen),resizeScreen(),self.$screen.find(".attachment").css("height","").removeClass("layout-float"),self.$media.css("height",""),_.defer(function(){return self.resize()})},Screen.prototype.resize=function(){this.resizeComponents(),this.preCalculateContentHeight(),this.resizeLayout()},Screen.prototype.resizeComponents=function(){var $button,$content,$img,$social,$video,ch,content_height,cw,h,imageHeight,imageWidth,margin,maxWidth,offset,padding,sep,w;return imageHeight=imageWidth=content_height=0,$content=this.$contentWrapper.children(".content"),this.$screen.removeClass("layout-float"),$content.removeClass("scrollable"),this.$text.css("padding-top",0),$content.css("padding-top",""),this.$text.css("margin-left",0),$button=this.$buttonWrapper.children(".button"),$button.show(),maxWidth=window.innerWidth,$img=this.$media.children(".attachment").find("img"),$video=this.$media.children(".attachment").find(".video"),$social=$content.find(".social"),sep=30,Globals.isTouch===!0&&maxWidth<Globals.responsiveThreshold&&(sep=18),padding=""!==$.trim(this.$text.html())&&($img.length||$video.length)?sep:0,this.$text.css("padding-top",padding),margin=$button.length&&($img.length||$video.length||""!==$.trim(this.$text.html())||""!==$.trim(this.$description.html()))?sep:0,this.$buttonWrapper.css("margin-top",margin),$img.length&&(imageHeight=$img.data("height"),imageWidth=$img.data("width"),imageHeight||(imageHeight=$img.parent().data().height,$img.data("height",imageHeight)),imageWidth||(imageWidth=$img.parent().data().width,$img.data("width",imageWidth)),cw=Math.min(this.$media.width(),imageWidth),ch=cw*imageHeight/imageWidth,$img.css({width:cw,height:ch}),$img.parent().css({width:cw,height:ch}),$button.length&&$button[0].offsetTop+100>window.innerHeight&&(cw<$content.width()-400?(this.$screen.addClass("layout-float"),this.$text.css("margin-left",cw+30),this.$text.height()<$img.height()&&this.$text.css("padding-top",($media.height()-this.$text.height())/2)):this.$screen.removeClass("layout-float")),this.$text[0].offsetTop+100>window.innerHeight&&(offset=178,Globals.isMobile?offset=135:"default"===Globals.browser&&(offset=198),h=Math.max(ch-(this.$text[0].offsetTop-window.innerHeight+offset),100),w=h*cw/ch,$img.css({width:w,height:h}),$img.parent().css({width:w,height:h}),ch=h,cw=w),$social.length&&$social.hasClass("show"&&$social[0].offsetTop+100>window.innerHeight))?(h=Math.max(Math.min(h,ch-($social[0].offsetTop-window.innerHeight+138)),100),w=h*cw/ch,$img.css({width:w,height:h}),$img.parent().css({width:w,height:h}),ch=h,cw=w):void 0},Screen.prototype.preCalculateContentHeight=function(){var $content;$content=this.$contentWrapper.children(".content"),this.contentHeight=$content.height()},Screen.prototype.resizeLayout=function(){var $button,$content,contentHeight,isSmall,maxHeight,maxWidth,offsetTop,scrollOffset,showBranding;if($button=this.$buttonWrapper.children(".button"),$content=this.$contentWrapper.children(".content"),contentHeight=this.contentHeight,maxHeight=window.innerHeight,maxWidth=window.innerWidth,$("body").hasClass("branding")&&this.$contentWrapper.parent().hasClass("outro")&&(maxHeight-="default"!==Globals.browser?40:60),isSmall=!1,"touch"===Globals.browser&&maxWidth<Globals.responsiveThreshold&&(isSmall=!0),this.$footer){if(Globals.isMobile)return $button.length?($button.parent().hide(),this.$footer.show(),scrollOffset=80):scrollOffset=0,contentHeight>maxHeight-scrollOffset?$content.addClass("scrollable"):$("body").hasClass("branding")&&this.$contentWrapper.parent().hasClass("outro")?$content.css("padding-top",(maxHeight-scrollOffset-$content.height())/2+40):$content.css("padding-top",(maxHeight-scrollOffset-$content.height())/2);if($("body").hasClass("branding")&&this.$contentWrapper.parent().hasClass("outro")?maxHeight-100>contentHeight?($content.css("padding-bottom",(maxHeight-contentHeight)/2+20),$content.css("padding-top",(maxHeight-contentHeight)/2+22),Globals.isTouch&&$content.css("padding-top",(maxHeight-contentHeight)/2+40)):($content.css({"padding-top":40,"padding-bottom":100}),Globals.isTouch&&$content.css("padding-top",(maxHeight-contentHeight)/2+60)):maxHeight-40>contentHeight?$content.css("padding-top",(maxHeight-contentHeight)/2):$content.css(this.$contentWrapper.parent().hasClass("outro")?{"padding-top":40,"padding-bottom":100}:{"padding-top":40,"margin-bottom":40}),$button.length)if(offsetTop=25,showBranding="default"===Globals.browser&&this.$contentWrapper.parent().hasClass("outro")&&$("body").hasClass("branding"),this.$buttonWrapper.offset().top-window.pageYOffset-maxHeight>-79){if(this.$footer.show(),$button.hide(),this.$buttonWrapper.css("margin-top",0),$content.addClass("scrollable"),showBranding)return $content.css("padding-top",parseInt($content.css("padding-top"))+offsetTop),$("body").addClass("banner-top")}else if(this.$footer.hide(),$button.show(),$content.removeClass("scrollable"),showBranding)return $content.css("padding-top",parseInt($content.css("padding-top"))-offsetTop),$("body").removeClass("banner-top")}},onWindowLoad=function(){return _.each(shareIcons,loadShareIcon,this)},loadShareIcon=function(iconName){return this.$shareIconsWrapper.find(".icon-"+iconName).attr("src",getUrlIcon(iconName))},Screen}(),namespace("App",function(exports){return exports.Screen=Screen})}.call(this),function(){var validation;validation={creditCardNumber:function(value){return{isValid:Stripe.card.validateCardNumber(value),errorMessage:App.Texts.invalid_number}},creditCardCvc:function(value){return{isValid:Stripe.card.validateCVC(value),errorMessage:App.Texts.invalid_cvc}}},namespace("App",function(exports){return exports.validation=validation})}.call(this),function(){var Utils;Utils={getWindowHeight:function(){var d,e,g,w;return w=window,d=document,e=d.documentElement,g=d.getElementsByTagName("body")[0],w.innerHeight||e.clientHeight||g.clientHeight},getCssValue:function(cls,attr){var temp,value;return temp=$("<div class='"+cls+"'></div>"),$("body").append(temp),value=temp.css(attr),temp.remove(),value},setStepClassByLightness:function($el){var backgroundColor,hexBC,lightness,step;backgroundColor=App.Utils.getCssValue("backgroundColor","background-color"),hexBC=App.Utils.rgb2hex(backgroundColor),lightness=$.husl.fromHex(hexBC)[2],step=App.Utils.getStepByLightness(lightness),$el.removeClass("step0 step1 step2 step3 step4 step5").addClass("step"+step)},getStepByLightness:function(lightness){switch(!1){case!(lightness>80):return 0;case!(lightness>60):return 1;case!(lightness>40):return 2;case!(lightness>20):return 3;case!(lightness>9):return 4;default:return 5}},selectEffect:function($el){return $el.selectEffect(2)},setContainerColor:function(backgroundColor,secondaryColor){var hexBC,hexSC,lightness,step;return"undefined"!=typeof backgroundColor&&"undefined"!=typeof secondaryColor?(hexBC=App.Utils.rgb2hex(backgroundColor),hexSC=App.Utils.rgb2hex(secondaryColor),lightness=$.husl.fromHex(hexBC)[2],step=App.Utils.getStepByLightness(lightness),window.containerStep=step,$(".container, .style-transparent-choice").each(function(){var lightnessSC;return $(this).removeClass("step0 step1 step2 step3 step4 step5"),$(this).addClass("step"+step),lightnessSC=$.husl.fromHex(hexSC)[2]}),$(".tooltip").each(function(){var lightnessSC;return $(this).removeClass("dark light"),$(this).addClass(lightness>80?"dark":"light"),lightnessSC=$.husl.fromHex(hexSC)[2]}),lightness>80&&$("body").addClass("dark"),$(".header,.footer, .lightness-step,.footer-confirm").removeClass("step0 step1 step2 step3 step4 step5").addClass("step"+step)):void 0},rgb2hex:function(color){var rgb;return rgb=color.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),_.isNull(rgb)?color:"#"+App.Utils.hex(rgb[1])+App.Utils.hex(rgb[2])+App.Utils.hex(rgb[3])},hex:function(x){var hexDigits;return hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],"undefined"!=typeof x?isNaN(x)?"00":hexDigits[(x-x%16)/16]+hexDigits[x%16]:void 0},getCaret:function(el){var r,rc,re;return el.selectionStart?el.selectionStart:document.selection?(el.focus(),r=document.selection.createRange(),null==r?0:(re=el.createTextRange(),rc=re.duplicate(),re.moveToBookmark(r.getBookmark()),rc.setEndPoint("EndToStart",re),rc.text.length)):0},isCaretAtStart:function(el){return 0===App.Utils.getCaret(el[0])},isCaretAtEnd:function(el){return App.Utils.getCaret(el[0])===el.val().length},remoteLog:function(str){return $.ajax({data:"file=test.txt&data="+str,url:"/demo/log.php"})},letters:"abcdefghijklmnopqrstuvwxyz",getLetter:function(number){var last,remaining,rest;return null==number&&(number=null),_.isNumber(number)?(last=this.letters[number%this.letters.length],remaining=Math.floor(number/this.letters.length)-1,rest=number<this.letters.length?"":this.getLetter(remaining),rest+last):void 0}},namespace("App",function(exports){return exports.Utils=Utils}),$.fn.enable=function(op){return $button=$(this),1==op?($button.addClass("enabled"),$button.removeClass("disabled")):($button.addClass("disabled"),$button.removeClass("enabled")),$button},$.fn.replaceText=function(search,replace){return this.each(function(){$(this).html($(this).html().replace(new RegExp(search,"g"),replace))})},$.fn.shuffle=function(){var allElems=this.get(),getRandom=function(max){return Math.floor(Math.random()*max)},shuffled=$.map(allElems,function(){var random=getRandom(allElems.length),randEl=$(allElems[random]).clone(!0)[0];return allElems.splice(random,1),randEl});return this.each(function(i){$(this).replaceWith($(shuffled[i]))}),$(shuffled)},$.fn.translate3d=function(x,y,z){return $(this).css(Globals.vendor+"transform","translate3d("+x+"px,"+y+"px,"+z+"px)")},$.fn.alterClass=function(removals,additions){var self=this;if(-1===removals.indexOf("*"))return self.removeClass(removals),additions?self.addClass(additions):self;var patt=new RegExp("\\s"+removals.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g");return self.each(function(i,it){for(var cn=" "+it.className+" ";patt.test(cn);)cn=cn.replace(patt," ");it.className=$.trim(cn)}),additions?self.addClass(additions):self},$.fn.selectEffect=function(loop){var elem=$(this);if("default"==Globals.browser){var loop="undefined"!=typeof loop?loop:2,vel=130,i=2,$btn=elem.find(".button");$btn.removeClass("full");var doEffect=function(){elem.stop(!0,!0).animate({opacity:0},vel,function(){elem.animate({opacity:1},vel)})};doEffect();var it=setInterval(function(){doEffect(),i++,i>loop&&(clearInterval(it),$btn.addClass("full"))},2*vel+1)}return elem},function(removeClass){jQuery.fn.removeClass=function(value){if(value&&"function"==typeof value.test)for(var i=0,l=this.length;l>i;i++){var elem=this[i];if(1===elem.nodeType&&elem.className){for(var classNames=elem.className.split(/\s+/),n=classNames.length;n--;)value.test(classNames[n])&&classNames.splice(n,1);elem.className=jQuery.trim(classNames.join(" "))}}else removeClass.call(this,value);return this}}(jQuery.fn.removeClass)}.call(this),function(){var conv,dotProduct,f,f_inv,fromLinear,lab_e,lab_k,m,m_inv,maxChroma,maxChromaD,refU,refV,refX,refY,refZ,rgbPrepare,root,round,stylus,toLinear,_hradExtremum,_maxChroma;if(m={R:[3.2406,-1.5372,-.4986],G:[-.9689,1.8758,.0415],B:[.0557,-.204,1.057]},m_inv={X:[.4124,.3576,.1805],Y:[.2126,.7152,.0722],Z:[.0193,.1192,.9505]},refX=.95047,refY=1,refZ=1.08883,refU=.19784,refV=.46834,lab_e=.008856,lab_k=903.3,_maxChroma=function(L,H){var cosH,hrad,sinH,sub1,sub2;return hrad=H/360*2*Math.PI,sinH=Math.sin(hrad),cosH=Math.cos(hrad),sub1=Math.pow(L+16,3)/1560896,sub2=sub1>.008856?sub1:L/903.3,function(channel){var bottom,lbottom,m1,m2,m3,rbottom,top,_ref;return _ref=m[channel],m1=_ref[0],m2=_ref[1],m3=_ref[2],top=(.99915*m1+1.05122*m2+1.1446*m3)*sub2,rbottom=.8633*m3-.17266*m2,lbottom=.12949*m3-.38848*m1,bottom=(rbottom*sinH+lbottom*cosH)*sub2,function(limit){return L*(top-1.05122*limit)/(bottom+.17266*sinH*limit)}}},_hradExtremum=function(L){var lhs,rhs,sub;return lhs=(Math.pow(L,3)+48*Math.pow(L,2)+768*L+4096)/1560896,rhs=.008856,sub=lhs>rhs?lhs:10*L/9033,function(channel,limit){var bottom,hrad,m1,m2,m3,top,_ref;return _ref=m[channel],m1=_ref[0],m2=_ref[1],m3=_ref[2],top=-3015466475*m3*sub+603093295*m2*sub-603093295*limit,bottom=1356959916*m1*sub-452319972*m3*sub,hrad=Math.atan2(top,bottom),0===limit&&(hrad+=Math.PI),hrad}},maxChroma=function(L,H){var C,channel,limit,mc1,mc2,result,_i,_j,_len,_len1,_ref,_ref1;for(result=1/0,mc1=_maxChroma(L,H),_ref=["R","G","B"],_i=0,_len=_ref.length;_len>_i;_i++)for(channel=_ref[_i],mc2=mc1(channel),_ref1=[0,1],_j=0,_len1=_ref1.length;_len1>_j;_j++)limit=_ref1[_j],C=mc2(limit),C>0&&result>C&&(result=C);return result},maxChromaD=function(L){var C,channel,he1,hrad,limit,minima_C,_i,_j,_len,_len1,_ref,_ref1;for(minima_C=[],he1=_hradExtremum(L),_ref=["R","G","B"],_i=0,_len=_ref.length;_len>_i;_i++)for(channel=_ref[_i],_ref1=[0,1],_j=0,_len1=_ref1.length;_len1>_j;_j++)limit=_ref1[_j],hrad=he1(channel,limit),C=maxChroma(L,180*hrad/Math.PI),minima_C.push(C);return Math.min.apply(Math,minima_C)},dotProduct=function(a,b){var i,ret,_i,_ref;for(ret=0,i=_i=0,_ref=a.length-1;_ref>=0?_ref>=_i:_i>=_ref;i=_ref>=0?++_i:--_i)ret+=a[i]*b[i];return ret},round=function(num,places){var n;return n=Math.pow(10,places),Math.round(num*n)/n},f=function(t){return t>lab_e?Math.pow(t,1/3):7.787*t+16/116},f_inv=function(t){return Math.pow(t,3)>lab_e?Math.pow(t,3):(116*t-16)/lab_k},fromLinear=function(c){return.0031308>=c?12.92*c:1.055*Math.pow(c,1/2.4)-.055},toLinear=function(c){var a;return a=.055,c>.04045?Math.pow((c+a)/(1+a),2.4):c/12.92},rgbPrepare=function(tuple){var ch,n,_i,_j,_len,_len1,_results;for(tuple=function(){var _i,_len,_results;for(_results=[],_i=0,_len=tuple.length;_len>_i;_i++)n=tuple[_i],_results.push(round(n,3));return _results}(),_i=0,_len=tuple.length;_len>_i;_i++){if(ch=tuple[_i],-1e-4>ch||ch>1.0001)throw new Error("Illegal rgb value: "+ch);0>ch&&(ch=0),ch>1&&(ch=1)}for(_results=[],_j=0,_len1=tuple.length;_len1>_j;_j++)ch=tuple[_j],_results.push(Math.round(255*ch));return _results},conv={xyz:{},luv:{},lch:{},husl:{},huslp:{},rgb:{},hex:{}},conv.xyz.rgb=function(tuple){var B,G,R;return R=fromLinear(dotProduct(m.R,tuple)),G=fromLinear(dotProduct(m.G,tuple)),B=fromLinear(dotProduct(m.B,tuple)),[R,G,B]},conv.rgb.xyz=function(tuple){var B,G,R,X,Y,Z,rgbl;return R=tuple[0],G=tuple[1],B=tuple[2],rgbl=[toLinear(R),toLinear(G),toLinear(B)],X=dotProduct(m_inv.X,rgbl),Y=dotProduct(m_inv.Y,rgbl),Z=dotProduct(m_inv.Z,rgbl),[X,Y,Z]},conv.xyz.luv=function(tuple){var L,U,V,X,Y,Z,varU,varV;return X=tuple[0],Y=tuple[1],Z=tuple[2],varU=4*X/(X+15*Y+3*Z),varV=9*Y/(X+15*Y+3*Z),L=116*f(Y/refY)-16,0===L?[0,0,0]:(U=13*L*(varU-refU),V=13*L*(varV-refV),[L,U,V])},conv.luv.xyz=function(tuple){var L,U,V,X,Y,Z,varU,varV,varY;return L=tuple[0],U=tuple[1],V=tuple[2],0===L?[0,0,0]:(varY=f_inv((L+16)/116),varU=U/(13*L)+refU,varV=V/(13*L)+refV,Y=varY*refY,X=0-9*Y*varU/((varU-4)*varV-varU*varV),Z=(9*Y-15*varV*Y-varV*X)/(3*varV),[X,Y,Z])},conv.luv.lch=function(tuple){var C,H,Hrad,L,U,V;return L=tuple[0],U=tuple[1],V=tuple[2],C=Math.pow(Math.pow(U,2)+Math.pow(V,2),.5),Hrad=Math.atan2(V,U),H=360*Hrad/2/Math.PI,0>H&&(H=360+H),[L,C,H]},conv.lch.luv=function(tuple){var C,H,Hrad,L,U,V;return L=tuple[0],C=tuple[1],H=tuple[2],Hrad=H/360*2*Math.PI,U=Math.cos(Hrad)*C,V=Math.sin(Hrad)*C,[L,U,V]},conv.husl.lch=function(tuple){var C,H,L,S,max;return H=tuple[0],S=tuple[1],L=tuple[2],L>99.9999999?[100,0,H]:1e-8>L?[0,0,H]:(max=maxChroma(L,H),C=max/100*S,[L,C,H])},conv.lch.husl=function(tuple){var C,H,L,S,max;return L=tuple[0],C=tuple[1],H=tuple[2],L>99.9999999?[H,0,100]:1e-8>L?[H,0,0]:(max=maxChroma(L,H),S=C/max*100,[H,S,L])},conv.huslp.lch=function(tuple){var C,H,L,S,max;return H=tuple[0],S=tuple[1],L=tuple[2],L>99.9999999?[100,0,H]:1e-8>L?[0,0,H]:(max=maxChromaD(L),C=max/100*S,[L,C,H])},conv.lch.huslp=function(tuple){var C,H,L,S,max;return L=tuple[0],C=tuple[1],H=tuple[2],L>99.9999999?[H,0,100]:1e-8>L?[H,0,0]:(max=maxChromaD(L),S=C/max*100,[H,S,L])},conv.rgb.hex=function(tuple){var ch,hex,_i,_len;for(hex="#",tuple=rgbPrepare(tuple),_i=0,_len=tuple.length;_len>_i;_i++)ch=tuple[_i],ch=ch.toString(16),1===ch.length&&(ch="0"+ch),hex+=ch;return hex},conv.hex.rgb=function(hex){var b,g,r;return"#"===hex.charAt(0)&&(hex=hex.substring(1,7)),r=hex.substring(0,2),g=hex.substring(2,4),b=hex.substring(4,6),[parseInt(r,16)/255,parseInt(g,16)/255,parseInt(b,16)/255]},conv.lch.rgb=function(tuple){return conv.xyz.rgb(conv.luv.xyz(conv.lch.luv(tuple)))},conv.rgb.lch=function(tuple){return conv.luv.lch(conv.xyz.luv(conv.rgb.xyz(tuple)))},conv.husl.rgb=function(tuple){return conv.lch.rgb(conv.husl.lch(tuple))},conv.rgb.husl=function(tuple){return conv.lch.husl(conv.rgb.lch(tuple))},conv.huslp.rgb=function(tuple){return conv.lch.rgb(conv.huslp.lch(tuple))},conv.rgb.huslp=function(tuple){return conv.lch.huslp(conv.rgb.lch(tuple))},root={},"undefined"!=typeof require&&null!==require)try{stylus=require("stylus"),root=function(){return function(style){return style.define("husl",function(H,S,L,A){var B,G,R,_ref;return _ref=rgbPrepare(conv.husl.rgb([H.val,S.val,L.val])),R=_ref[0],G=_ref[1],B=_ref[2],new stylus.nodes.RGBA(R,G,B,null!=A?A.val:1)}),style.define("huslp",function(H,S,L,A){var B,G,R,_ref;return _ref=rgbPrepare(conv.huslp.rgb([H.val,S.val,L.val])),R=_ref[0],G=_ref[1],B=_ref[2],new stylus.nodes.RGBA(R,G,B,null!=A?A.val:1)})}}}catch(_error){}root.fromRGB=function(R,G,B){return conv.rgb.husl([R,G,B])},root.fromHex=function(hex){return conv.rgb.husl(conv.hex.rgb(hex))},root.toRGB=function(H,S,L){return conv.husl.rgb([H,S,L])},root.toHex=function(H,S,L){return conv.rgb.hex(conv.husl.rgb([H,S,L]))},root.p={},root.p.toRGB=function(H,S,L){return conv.xyz.rgb(conv.luv.xyz(conv.lch.luv(conv.huslp.lch([H,S,L]))))
},root.p.toHex=function(H,S,L){return conv.rgb.hex(conv.xyz.rgb(conv.luv.xyz(conv.lch.luv(conv.huslp.lch([H,S,L])))))},root.p.fromRGB=function(R,G,B){return conv.lch.huslp(conv.luv.lch(conv.xyz.luv(conv.rgb.xyz([R,G,B]))))},root.p.fromHex=function(hex){return conv.lch.huslp(conv.luv.lch(conv.xyz.luv(conv.rgb.xyz(conv.hex.rgb(hex)))))},root._conv=conv,root._maxChroma=maxChroma,root._rgbPrepare=rgbPrepare,"undefined"!=typeof module&&null!==module&&(module.exports=root),"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.husl=root)}.call(this),function(){var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.6.0",_.each=_.forEach=function(obj,iterator,context){if(null==obj)return obj;if(obj.length===+obj.length){for(var i=0,length=obj.length;length>i;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var keys=_.keys(obj),i=0,length=keys.length;length>i;i++)if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return;return obj},_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:(_.each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),_.each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;null==obj&&(obj=[]);var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}if(_.each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.find=_.detect=function(obj,predicate,context){var result;return _.some(obj,function(value,index,list){return predicate.call(context,value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:(_.each(obj,function(value,index,list){predicate.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(predicate),context)},_.every=_.all=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!0;return null==obj?result:(_.each(obj,function(value,index,list){return(result=result&&predicate.call(context,value,index,list))?void 0:breaker}),!!result)},_.some=_.any=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!1;return null==obj?result:(_.each(obj,function(value,index,list){return result||(result=predicate.call(context,value,index,list))?breaker:void 0}),!!result)},_.contains=_.include=function(obj,target){return null==obj?!1:_.some(obj,function(value){return value===target})},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iterator,context){var value,computed,result=-1/0,lastComputed=-1/0;if(!iterator&&_.isArray(obj))for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value);else _.each(obj,function(value,index,list){computed=iterator?iterator.call(context,value,index,list):value,computed>lastComputed&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iterator,context){var value,computed,result=1/0,lastComputed=1/0;if(!iterator&&_.isArray(obj))for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value);else _.each(obj,function(value,index,list){computed=iterator?iterator.call(context,value,index,list):value,lastComputed>computed&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){var rand,index=0,shuffled=[];return _.each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return null==value?_.identity:_.isFunction(value)?value:_.property(value)};_.sortBy=function(obj,iterator,context){return iterator=lookupIterator(iterator),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iterator,context){var result={};return iterator=lookupIterator(iterator),_.each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)}),result}};_.groupBy=group(function(result,key,value){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,key,value){result[key]=value}),_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iterator,context){iterator=lookupIterator(iterator);for(var value=iterator.call(context,obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;length>i;i++){var value=input[i];_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,strict,output):strict||output.push(value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.partition=function(obj,predicate,context){predicate=lookupIterator(predicate);var pass=[],fail=[];return _.each(obj,function(elem){(predicate.call(context,elem)?pass:fail).push(elem)}),[pass,fail]},_.uniq=_.unique=function(array,isSorted,iterator,context){if(null==array)return[];_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);for(var result=[],seen=[],i=0,length=array.length;length>i;i++){var value=array[i];iterator&&(value=iterator.call(context,value,i,array)),(isSorted?i&&seen===value:_.contains(seen,value))||(isSorted?seen=value:seen.push(value),result.push(array[i]))}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0,[]))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(slice.call(arguments,1),!0,!0,[]);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=new Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;for(var i=null==from?array.length:from;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(length);length>idx;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw new Error("bindAll must be passed function names");return _.each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),context=args=null))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments),func=null,memo)}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=new Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=new Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return _.each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj,iterator,context){var result={};if(_.isFunction(iterator))for(var key in obj){var value=obj[key];iterator.call(context,value,key,obj)&&(result[key]=value)}else for(var keys=concat.apply([],slice.call(arguments,1)),i=0,length=keys.length;length>i;i++){var key=keys[i];key in obj&&(result[key]=obj[key])}return result},_.omit=function(obj,iterator,context){var keys;return _.isFunction(iterator)?iterator=_.negate(iterator):(keys=_.map(concat.apply([],slice.call(arguments,1)),String),iterator=function(value,key){return!_.contains(keys,key)}),_.pick(obj,iterator,context)},_.defaults=function(obj){return _.each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){return function(obj){if(obj===attrs)return!0;for(var key in attrs)if(attrs[key]!==obj[key])return!1;return!0}},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;n>i;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,data,settings){settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(){var Backbone,root=this,previousBackbone=root.Backbone,array=[],push=array.push,slice=array.slice,splice=array.splice;Backbone="undefined"!=typeof exports?exports:root.Backbone={},Backbone.VERSION="1.0.0";var _=root._;_||"undefined"==typeof require||(_=require("underscore")),Backbone.$=root.jQuery||root.Zepto||root.ender||root.$,Backbone.noConflict=function(){return root.Backbone=previousBackbone,this},Backbone.emulateHTTP=!1,Backbone.emulateJSON=!1;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);return events.push({callback:callback,context:context,ctx:context||this}),this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback)return this;var self=this,once=_.once(function(){self.off(name,once),callback.apply(this,arguments)});return once._callback=callback,this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context]))return this;if(!name&&!callback&&!context)return this._events={},this;for(names=name?[name]:_.keys(this._events),i=0,l=names.length;l>i;i++)if(name=names[i],events=this._events[name]){if(this._events[name]=retain=[],callback||context)for(j=0,k=events.length;k>j;j++)ev=events[j],(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context)&&retain.push(ev);retain.length||delete this._events[name]}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args))return this;var events=this._events[name],allEvents=this._events.all;return events&&triggerEvents(events,args),allEvents&&triggerEvents(allEvents,arguments),this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners)return this;var deleteListener=!name&&!callback;"object"==typeof name&&(callback=this),obj&&((listeners={})[obj._listenerId]=obj);for(var id in listeners)listeners[id].off(name,callback,this),deleteListener&&delete this._listeners[id];return this}},eventSplitter=/\s+/,eventsApi=function(obj,action,name,rest){if(!name)return!0;if("object"==typeof name){for(var key in name)obj[action].apply(obj,[key,name[key]].concat(rest));return!1}if(eventSplitter.test(name)){for(var names=name.split(eventSplitter),i=0,l=names.length;l>i;i++)obj[action].apply(obj,[names[i]].concat(rest));return!1}return!0},triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx);return;case 1:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:for(;++i<l;)(ev=events[i]).callback.apply(ev.ctx,args)}},listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={}),id=obj._listenerId||(obj._listenerId=_.uniqueId("l"));return listeners[id]=obj,"object"==typeof name&&(callback=this),obj[implementation](name,callback,this),this}}),Events.bind=Events.on,Events.unbind=Events.off,_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults,attrs=attributes||{};options||(options={}),this.cid=_.uniqueId("c"),this.attributes={},_.extend(this,_.pick(options,modelOptions)),options.parse&&(attrs=this.parse(attrs,options)||{}),(defaults=_.result(this,"defaults"))&&(attrs=_.defaults({},attrs,defaults)),this.set(attrs,options),this.changed={},this.initialize.apply(this,arguments)},modelOptions=["url","urlRoot","collection"];_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return null!=this.get(attr)},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(null==key)return this;if("object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,options||(options={}),!this._validate(attrs,options))return!1;unset=options.unset,silent=options.silent,changes=[],changing=this._changing,this._changing=!0,changing||(this._previousAttributes=_.clone(this.attributes),this.changed={}),current=this.attributes,prev=this._previousAttributes,this.idAttribute in attrs&&(this.id=attrs[this.idAttribute]);for(attr in attrs)val=attrs[attr],_.isEqual(current[attr],val)||changes.push(attr),_.isEqual(prev[attr],val)?delete this.changed[attr]:this.changed[attr]=val,unset?delete current[attr]:current[attr]=val;if(!silent){changes.length&&(this._pending=!0);for(var i=0,l=changes.length;l>i;i++)this.trigger("change:"+changes[i],this,current[changes[i]],options)}if(changing)return this;if(!silent)for(;this._pending;)this._pending=!1,this.trigger("change",this,options);return this._pending=!1,this._changing=!1,this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:!0}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:!0}))},hasChanged:function(attr){return null==attr?!_.isEmpty(this.changed):_.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):!1;var val,changed=!1,old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff)_.isEqual(old[attr],val=diff[attr])||((changed||(changed={}))[attr]=val);return changed},previous:function(attr){return null!=attr&&this._previousAttributes?this._previousAttributes[attr]:null},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){return model.set(model.parse(resp,options),options)?(success&&success(model,resp,options),void model.trigger("sync",model,resp,options)):!1},wrapError(this,options),this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(null==key||"object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,!(!attrs||options&&options.wait||this.set(attrs,options)))return!1;if(options=_.extend({validate:!0},options),!this._validate(attrs,options))return!1;attrs&&options.wait&&(this.attributes=_.extend({},attributes,attrs)),void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);return options.wait&&(serverAttrs=_.extend(attrs||{},serverAttrs)),_.isObject(serverAttrs)&&!model.set(serverAttrs,options)?!1:(success&&success(model,resp,options),void model.trigger("sync",model,resp,options))},wrapError(this,options),method=this.isNew()?"create":options.patch?"patch":"update","patch"===method&&(options.attrs=attrs),xhr=this.sync(method,this,options),attrs&&options.wait&&(this.attributes=attributes),xhr},destroy:function(options){options=options?_.clone(options):{};var model=this,success=options.success,destroy=function(){model.trigger("destroy",model,model.collection,options)};if(options.success=function(resp){(options.wait||model.isNew())&&destroy(),success&&success(model,resp,options),model.isNew()||model.trigger("sync",model,resp,options)},this.isNew())return options.success(),!1;wrapError(this,options);var xhr=this.sync("delete",this,options);return options.wait||destroy(),xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();return this.isNew()?base:base+("/"===base.charAt(base.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(resp){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(options){return this._validate({},_.extend(options||{},{validate:!0}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return!0;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;return error?(this.trigger("invalid",this,error,_.extend(options||{},{validationError:error})),!1):!0}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.attributes),_[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={}),options.url&&(this.url=options.url),options.model&&(this.model=options.model),void 0!==options.comparator&&(this.comparator=options.comparator),this._reset(),this.initialize.apply(this,arguments),models&&this.reset(models,_.extend({silent:!0},options))},setOptions={add:!0,remove:!0,merge:!0},addOptions={add:!0,merge:!1,remove:!1};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.defaults(options||{},addOptions))},remove:function(models,options){models=_.isArray(models)?models.slice():[models],options||(options={});var i,l,index,model;for(i=0,l=models.length;l>i;i++)model=this.get(models[i]),model&&(delete this._byId[model.id],delete this._byId[model.cid],index=this.indexOf(model),this.models.splice(index,1),this.length--,options.silent||(options.index=index,model.trigger("remove",model,this,options)),this._removeReference(model));return this},set:function(models,options){options=_.defaults(options||{},setOptions),options.parse&&(models=this.parse(models,options)),_.isArray(models)||(models=models?[models]:[]);var i,l,model,existing,sort,at=options.at,sortable=this.comparator&&null==at&&options.sort!==!1,sortAttr=_.isString(this.comparator)?this.comparator:null,toAdd=[],toRemove=[],modelMap={};for(i=0,l=models.length;l>i;i++)(model=this._prepareModel(models[i],options))&&((existing=this.get(model))?(options.remove&&(modelMap[existing.cid]=!0),options.merge&&(existing.set(model.attributes,options),sortable&&!sort&&existing.hasChanged(sortAttr)&&(sort=!0))):options.add&&(toAdd.push(model),model.on("all",this._onModelEvent,this),this._byId[model.cid]=model,null!=model.id&&(this._byId[model.id]=model)));if(options.remove){for(i=0,l=this.length;l>i;++i)modelMap[(model=this.models[i]).cid]||toRemove.push(model);toRemove.length&&this.remove(toRemove,options)}if(toAdd.length&&(sortable&&(sort=!0),this.length+=toAdd.length,null!=at?splice.apply(this.models,[at,0].concat(toAdd)):push.apply(this.models,toAdd)),sort&&this.sort({silent:!0}),options.silent)return this;for(i=0,l=toAdd.length;l>i;i++)(model=toAdd[i]).trigger("add",model,this,options);return sort&&this.trigger("sort",this,options),this
},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;l>i;i++)this._removeReference(this.models[i]);return options.previousModels=this.models,this._reset(),this.add(models,_.extend({silent:!0},options)),options.silent||this.trigger("reset",this,options),this},push:function(model,options){return model=this._prepareModel(model,options),this.add(model,_.extend({at:this.length},options)),model},pop:function(options){var model=this.at(this.length-1);return this.remove(model,options),model},unshift:function(model,options){return model=this._prepareModel(model,options),this.add(model,_.extend({at:0},options)),model},shift:function(options){var model=this.at(0);return this.remove(model,options),model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){return null==obj?void 0:this._byId[null!=obj.id?obj.id:obj.cid||obj]},at:function(index){return this.models[index]},where:function(attrs,first){return _.isEmpty(attrs)?first?void 0:[]:this[first?"find":"filter"](function(model){for(var key in attrs)if(attrs[key]!==model.get(key))return!1;return!0})},findWhere:function(attrs){return this.where(attrs,!0)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return options||(options={}),_.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(_.bind(this.comparator,this)),options.silent||this.trigger("sort",this,options),this},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var success=options.success,collection=this;return options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options),success&&success(collection,resp,options),collection.trigger("sync",collection,resp,options)},wrapError(this,options),this.sync("read",this,options)},create:function(model,options){if(options=options?_.clone(options):{},!(model=this._prepareModel(model,options)))return!1;options.wait||this.add(model,options);var collection=this,success=options.success;return options.success=function(resp){options.wait&&collection.add(model,options),success&&success(model,resp,options)},model.save(null,options),model},parse:function(resp){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model)return attrs.collection||(attrs.collection=this),attrs;options||(options={}),options.collection=this;var model=new this.model(attrs,options);return model._validate(attrs,options)?model:(this.trigger("invalid",this,attrs,options),!1)},_removeReference:function(model){this===model.collection&&delete model.collection,model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){("add"!==event&&"remove"!==event||collection===this)&&("destroy"===event&&this.remove(model,options),model&&event==="change:"+model.idAttribute&&(delete this._byId[model.previous(model.idAttribute)],null!=model.id&&(this._byId[model.id]=model)),this.trigger.apply(this,arguments))}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.models),_[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view"),this._configure(options||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},delegateEventSplitter=/^(\S+)\s*(.*)$/,viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(element,delegate){return this.$el&&this.undelegateEvents(),this.$el=element instanceof Backbone.$?element:Backbone.$(element),this.el=this.$el[0],delegate!==!1&&this.delegateEvents(),this},delegateEvents:function(events){if(!events&&!(events=_.result(this,"events")))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(_.isFunction(method)||(method=this[events[key]]),method){var match=key.match(delegateEventSplitter),eventName=match[1],selector=match[2];method=_.bind(method,this),eventName+=".delegateEvents"+this.cid,""===selector?this.$el.on(eventName,method):this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(options){this.options&&(options=_.extend({},_.result(this,"options"),options)),_.extend(this,_.pick(options,viewOptions)),this.options=options},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"),!1);else{var attrs=_.extend({},_.result(this,"attributes"));this.id&&(attrs.id=_.result(this,"id")),this.className&&(attrs["class"]=_.result(this,"className"));var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,!1)}}}),Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(options.url||(params.url=_.result(model,"url")||urlError()),null!=options.data||!model||"create"!==method&&"update"!==method&&"patch"!==method||(params.contentType="application/json",params.data=JSON.stringify(options.attrs||model.toJSON(options))),options.emulateJSON&&(params.contentType="application/x-www-form-urlencoded",params.data=params.data?{model:params.data}:{}),options.emulateHTTP&&("PUT"===type||"DELETE"===type||"PATCH"===type)){params.type="POST",options.emulateJSON&&(params.data._method=type);var beforeSend=options.beforeSend;options.beforeSend=function(xhr){return xhr.setRequestHeader("X-HTTP-Method-Override",type),beforeSend?beforeSend.apply(this,arguments):void 0}}"GET"===params.type||options.emulateJSON||(params.processData=!1),"PATCH"!==params.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var xhr=options.xhr=Backbone.ajax(_.extend(params,options));return model.trigger("request",model,xhr,options),xhr};var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={}),options.routes&&(this.routes=options.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},optionalParam=/\((.*?)\)/g,namedParam=/(\(\?)?:\w+/g,splatParam=/\*\w+/g,escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){_.isRegExp(route)||(route=this._routeToRegExp(route)),_.isFunction(name)&&(callback=name,name=""),callback||(callback=this[name]);var router=this;return Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);callback&&callback.apply(router,args),router.trigger.apply(router,["route:"+name].concat(args)),router.trigger("route",name,args),Backbone.history.trigger("route",router,name,args)}),this},navigate:function(fragment,options){return Backbone.history.navigate(fragment,options),this},_bindRoutes:function(){if(this.routes){this.routes=_.result(this,"routes");for(var route,routes=_.keys(this.routes);null!=(route=routes.pop());)this.route(route,this.routes[route])}},_routeToRegExp:function(route){return route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/]+)"}).replace(splatParam,"(.*?)"),new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param){return param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[],_.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},routeStripper=/^[#\/]|\s+$/g,rootStripper=/^\/+|\/+$/g,isExplorer=/msie [\w.]+/,trailingSlash=/\/$/;History.started=!1,_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(null==fragment)if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,"");fragment.indexOf(root)||(fragment=fragment.substr(root.length))}else fragment=this.getHash();return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=!0,this.options=_.extend({},{root:"/"},this.options,options),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment(),docMode=document.documentMode,oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||7>=docMode);this.root=("/"+this.root+"/").replace(rootStripper,"/"),oldIE&&this._wantsHashChange&&(this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(fragment)),this._hasPushState?Backbone.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!oldIE?Backbone.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=fragment;var loc=this.location,atRoot=loc.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash&&(this.fragment=this.getHash().replace(routeStripper,""),this.history.replaceState({},document.title,this.root+this.fragment+loc.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),History.started=!1},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(){var current=this.getFragment();return current===this.fragment&&this.iframe&&(current=this.getFragment(this.getHash(this.iframe))),current===this.fragment?!1:(this.iframe&&this.navigate(current),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride),matched=_.any(this.handlers,function(handler){return handler.route.test(fragment)?(handler.callback(fragment),!0):void 0});return matched},navigate:function(fragment,options){if(!History.started)return!1;if(options&&options!==!0||(options={trigger:options}),fragment=this.getFragment(fragment||""),this.fragment!==fragment){this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState)this.history[options.replace?"replaceState":"pushState"]({},document.title,url);else{if(!this._wantsHashChange)return this.location.assign(url);this._updateHash(this.location,fragment,options.replace),this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))&&(options.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,fragment,options.replace))}options.trigger&&this.loadUrl(fragment)}},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else location.hash="#"+fragment}}),Backbone.history=new History;var extend=function(protoProps,staticProps){var child,parent=this;child=protoProps&&_.has(protoProps,"constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)},_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&_.extend(child.prototype,protoProps),child.__super__=parent.prototype,child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(model,options){var error=options.error;options.error=function(resp){error&&error(model,resp,options),model.trigger("error",model,resp,options)}}}.call(this),function($,window){$window=$(window),$.fn.lazyload=function(options){function update(){var counter=0;settings.preventUpdate!==!0&&elements.each(function(){var $this=$(this);if(!settings.skip_invisible||$this.is(":visible"))if($.abovethetop(this,settings)||$.leftofbegin(this,settings));else if($.belowthefold(this,settings)||$.rightoffold(this,settings)){if(++counter>settings.failure_limit)return!1}else $this.trigger("appear")})}var elements=this,settings={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:!0,appear:null,load:null,preventUpdate:!1};return options&&(void 0!==options.failurelimit&&(options.failure_limit=options.failurelimit,delete options.failurelimit),void 0!==options.effectspeed&&(options.effect_speed=options.effectspeed,delete options.effectspeed),$.extend(settings,options)),$container=void 0===settings.container||settings.container===window?$window:$(settings.container),0===settings.event.indexOf("scroll")&&$container.bind(settings.event,function(){return update()}),this.each(function(){var self=this,$self=$(self);self.loaded=!1,$self.one("appear",function(){if(!this.loaded){if(settings.appear){var elements_left=elements.length;settings.appear.call(self,elements_left,settings)}$("<img />").bind("load",function(){$self.hide().attr("src",$self.data(settings.data_attribute))[settings.effect](settings.effect_speed),self.loaded=!0;var temp=$.grep(elements,function(element){return!element.loaded});if(elements=$(temp),settings.load){var elements_left=elements.length;settings.load.call(self,elements_left,settings)}}).attr("src",$self.data(settings.data_attribute))}}),0!==settings.event.indexOf("scroll")&&$self.bind(settings.event,function(){self.loaded||$self.trigger("appear")})}),$window.bind("resize",function(){update()}),update(),this},$.belowthefold=function(element,settings){var fold;return fold=void 0===settings.container||settings.container===window?$window.height()+$window.scrollTop():$container.offset().top+$container.height(),fold<=$(element).offset().top-settings.threshold},$.rightoffold=function(element,settings){var fold;return fold=void 0===settings.container||settings.container===window?$window.width()+$window.scrollLeft():$container.offset().left+$container.width(),fold<=$(element).offset().left-settings.threshold},$.abovethetop=function(element,settings){var fold;return fold=void 0===settings.container||settings.container===window?$window.scrollTop():$container.offset().top,fold>=$(element).offset().top+settings.threshold+$(element).height()},$.leftofbegin=function(element,settings){var fold;return fold=void 0===settings.container||settings.container===window?$window.scrollLeft():$container.offset().left,fold>=$(element).offset().left+settings.threshold+$(element).width()},$.inviewport=function(element,settings){return!($.rightofscreen(element,settings)||$.leftofscreen(element,settings)||$.belowthefold(element,settings)||$.abovethetop(element,settings))},$.extend($.expr[":"],{"below-the-fold":function(a){return $.belowthefold(a,{threshold:0,container:window})},"above-the-top":function(a){return!$.belowthefold(a,{threshold:0,container:window})},"right-of-screen":function(a){return $.rightoffold(a,{threshold:0,container:window})},"left-of-screen":function(a){return!$.rightoffold(a,{threshold:0,container:window})},"in-viewport":function(a){return!$.inviewport(a,{threshold:0,container:window})},"above-the-fold":function(a){return!$.belowthefold(a,{threshold:0,container:window})},"right-of-fold":function(a){return $.rightoffold(a,{threshold:0,container:window})},"left-of-fold":function(a){return!$.rightoffold(a,{threshold:0,container:window})}})}(jQuery,window),FreezeFrame=function($){function FreezeFrame(_options){_ff=this,this.auto_run=null==_options.auto_run?!0:_options.auto_run,this.class_name=null==_options.class_name?"freezeframe":_options.class_name,this.trigger_event=null==_options.trigger_event?"hover":_options.trigger_event.toLowerCase(),null==_options.support_touch_devices?this.support_touch_devices=!0:this.support_touch_devuces=_options.support_touch_devices.toLowerCase(),this.animation_play_duration=null==_options.animation_play_duration?1e4:parseInt(_options.animation_play_duration),this.loading_background_color=null==_options.loading_background_color?"#666":_options.loading_background_color.toLowerCase(),this.loading_background_image=null==_options.loading_background_image?"data:image/gif;base64,R0lGODlhEAAQAPIAAGZmZv///4mJidbW1v///8PDw7CwsKampiH+GkNyZWF0ZWQgd2l0aCBhamF4bG9hZC5pbmZvACH5BAAKAAAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQACgABACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkEAAoAAgAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkEAAoAAwAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkEAAoABAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQACgAFACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQACgAGACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAAKAAcALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==":_options.loading_background_image,this.loading_background_position=null==_options.loading_background_position?"center center":_options.loading_background_position.toLowerCase(),this.animation_icon_image=null==_options.animation_icon_image?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAl9JREFUeNrs2s2K2lAUAGATb3TE2Cr+oaJQNFOh1MVsxK0OuJbSdX2V9gG67GqW3RbaB7B9gy7qgKJF8G/EarHVWGMyJj230EXLLITm6q05F44/IVw5X3JPjiGCZVkuJw/R5fCBAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAjwjyMej79MpVKP/hcAwe6boul0+p3P5/vmdruv4evbVqvVdRRALpd7HQqFpn6/XxUEwdI07UZV1ffNZvMzjwDE7gk9Hs8mGAwuYCl8hTNB32630nw+f1IqlRY8QtgOQAjRZVleJxKJ77AcVLptOBwup9PpPR4hbAcQRdGUJOk2HA5riqKokUjEgKK4GY/HKo8QhMGcv4oKIJg0+Xw+r8H7bSaT0XiEICwnhyLoCgQCptfrNSgCjxDkED8ChdGiwSMEOaQ2jxDkGOtuH4jJZHJ/Nps9LRaLi+Vy2WDVUB0FYB+IXq+36ff7P0ajURj2eQbF9EO73W6cFMBdENA8mXQbNFDier0mhULhQaVSeZzNZj+d3Bnwe+i6LkDCAqx9QmMwGJwlk8nzarV6Cf3EDHZ5DvHx5ADuSjwWiz0sl8uX8H9izjLxowLskfgL1okfBYCnxA8KwGPiBwGg9xpWq5XIY+IsAQT6stvt6BGX4Nrt4jFxZgCmaYqGYRDo4nzdbncny3KGx8SZAcCRl6CH9yuKcl6r1S6i0egXHhP/Y53aGfV6/U2n02nA5yuIC7vntzsEBo/KXkG84vaI/12w8Flhhw8EQAAEQAAEQAAEQAAEQAAEQAAEQAAEQAAEcNr4KcAABsB8S2vxAV8AAAAASUVORK5CYII=":_options.animation_icon_image,this.animation_icon_position=null==_options.animation_icon_position?"top left":_options.animation_icon_position.toLowerCase(),this.loading_fade_in_speed=null==_options.loading_fade_in_speed?500:parseInt(_options.loading_fade_in_speed),this.animation_fade_out_speed=null==_options.animation_fade_out_speed?250:parseInt(_options.animation_fade_out_speed),this.is_touch_device=isMouseEventSupported("ontouchstart"),this.freezeframe_count=0}var _ff;return FreezeFrame.prototype.setup=function(){$("<canvas>",{id:"freezeframe-canvas"}).css("display","none").prependTo($("body")),this.canvas=$("canvas#freezeframe-canvas"),this.context=this.canvas[0].getContext("2d")},FreezeFrame.prototype.run=function(images,shouldAnimate){var ext,images=images||[],figure_background=_ff.loading_background_color;_ff.loading_background_image!==!1&&(figure_background+=" url('"+_ff.loading_background_image+"') "+_ff.loading_background_position+" no-repeat"),0===images.length&&(images=$('img[class*="'+_ff.class_name+'"]').not('[class*="'+_ff.class_name+'_done"]')),$(images).each(function(index){if($(this).removeClass(_ff.class_name).addClass(_ff.class_name+"_done"),$(this).crossOrigin="anonymous",ext=$(this)[0].src.split("."),ext=ext[ext.length-1].toLowerCase(),"gif"!==ext)images.splice(index,1);else{var freezeframe_figure=$("<figure />").attr("class","freezeframe-container "+_ff.freezeframe_count).css({display:"inline-block",overflow:"hidden",background:figure_background});if($(this).css({opacity:0,display:"block"}).wrap(freezeframe_figure),freezeframe_figure=$(this).parent(),_ff.animation_icon_image!==!1){var animation_icon=$("<div />").attr("class","freezeframe-animation-icon").css({display:"block",position:"absolute",background:"transparent url('"+_ff.animation_icon_image+"') "+_ff.animation_icon_position+" no-repeat","pointer-events":"none","z-index":100,opacity:0});$(freezeframe_figure).prepend(animation_icon),animation_icon=$(this).siblings($(".freezeframe-animation-icon"))}_ff.freezeframe_count++;var _self=this;$(this).imagesLoaded(function(){$(this).off("imagesLoaded"),_ff.canvas[0].width=$(this).width(),_ff.canvas[0].height=$(this).height(),$(this).attr("animated",$(this).attr("src"));var originalUrl=$(this).data("first-frame"),first_frame=originalUrl.substring(0,originalUrl.length-4)+"-firstframe.png";void 0===first_frame&&(_ff.context.drawImage(_self,0,0,$(this).width(),$(this).height()),first_frame=_ff.canvas[0].toDataURL()),$(this).attr("src",first_frame),_ff.animation_icon_image!==!1&&$(animation_icon).css({width:parseInt($(this)[0].width),height:parseInt($(this)[0].height)}).animate({opacity:1},_ff.loading_fade_in_speed),$(this).animate({opacity:1},_ff.loading_fade_in_speed,function(){function animate(){$(freezeframe_figure).css("background","transparent"),$(this).attr("src",$(this).attr("src")).css("opacity",1),_ff.animation_icon_image!==!1&&$(animation_icon).css("opacity",0)}function stopAnimation(){var originalUrl=$(this).data("first-frame"),first_frame=originalUrl.substring(0,originalUrl.length-4)+"-lastframe.png";$(freezeframe_figure).css("background","url('"+first_frame+"')"),$(freezeframe_figure).css("background-size","contain"),$(this).css("opacity",0),_ff.animation_icon_image!==!1&&$(animation_icon).animate({opacity:1},_ff.animation_fade_out_speed)}function stopAnimationAndClearInterval(interval){clearInterval(interval),stopAnimation.call(this),animating=!1}if($(freezeframe_figure).css("background","url('"+first_frame+"')"),$(freezeframe_figure).css("background-size","contain"),$(this).css("opacity",0).attr("src",$(this).attr("animated")),shouldAnimate===!0&&animate.call(this),_ff.support_touch_devices&&_ff.is_touch_device||"click"==_ff.trigger_event.toLowerCase()){var animating=!1;$(this).click(function(){animating?stopAnimationAndClearInterval.call(this,stopAnimationInterval):(animate.call(this),stopAnimationInterval=setInterval(function(){stopAnimationAndClearInterval.call(this,stopAnimationInterval)},_ff.animation_play_duration),animating=!0)})}else if("hover"===_ff.trigger_event)$(this).mouseenter(function(){animate.call(this)}),$(this).mouseleave(function(){stopAnimation.call(this)});else{var customEvent=_ff.trigger_event.toLowerCase(),customEventEnter=customEvent+"enter",customEventLeave=customEvent+"leave";$(this).on(customEventEnter,function(){animate.call(this)}),$(this).on(customEventLeave,function(){stopAnimation.call(this)})}})})}})},FreezeFrame}(jQuery),jQuery(document).ready(function(){"undefined"==typeof freezeframe_options?freezeframe_options={}:null,freezeframe=new FreezeFrame(freezeframe_options),freezeframe.setup(),freezeframe.auto_run===!0&&freezeframe.run()}),function($,undefined){"use strict";var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(callback){function doneLoading(){var $proper=$(proper),$broken=$(broken);deferred&&(broken.length?deferred.reject($images,$proper,$broken):deferred.resolve($images)),$.isFunction(callback)&&callback.call($this,$images,$proper,$broken)}function imgLoadedHandler(event){imgLoaded(event.target,"error"===event.type)}function imgLoaded(img,isBroken){img.src!==BLANK&&-1===$.inArray(img,loaded)&&(loaded.push(img),isBroken?broken.push(img):proper.push(img),$.data(img,"imagesLoaded",{isBroken:isBroken,src:img.src}),hasNotify&&deferred.notifyWith($(img),[isBroken,$images,$(proper),$(broken)]),$images.length===loaded.length&&(setTimeout(doneLoading),$images.unbind(".imagesLoaded",imgLoadedHandler)))}var $this=this,deferred=$.isFunction($.Deferred)?$.Deferred():0,hasNotify=$.isFunction(deferred.notify),$images=$this.find("img").add($this.filter("img")),loaded=[],proper=[],broken=[];return $.isPlainObject(callback)&&$.each(callback,function(key,value){"callback"===key?callback=value:deferred&&deferred[key](value)}),$images.length?$images.bind("load.imagesLoaded error.imagesLoaded",imgLoadedHandler).each(function(i,el){var src=el.src,cached=$.data(el,"imagesLoaded");return cached&&cached.src===src?void imgLoaded(el,cached.isBroken):el.complete&&el.naturalWidth!==undefined?void imgLoaded(el,0===el.naturalWidth||0===el.naturalHeight):void((el.readyState||el.complete)&&(el.src=BLANK,el.src=src))}):doneLoading(),deferred?deferred.promise($this):$this}}(jQuery),window.Modernizr=function(window,document,undefined){function setCss(str){mStyle.cssText=str}function is(obj,type){return typeof obj===type}function contains(str,substr){return!!~(""+str).indexOf(substr)}function testProps(props,prefixed){for(var i in props){var prop=props[i];if(!contains(prop,"-")&&mStyle[prop]!==undefined)return"pfx"==prefixed?prop:!0}return!1}function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined)return elem===!1?props[i]:is(item,"function")?item.bind(elem||obj):item}return!1}function testPropsAll(prop,prefixed,elem){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+" "+cssomPrefixes.join(ucProp+" ")+ucProp).split(" ");return is(prefixed,"string")||is(prefixed,"undefined")?testProps(props,prefixed):(props=(prop+" "+domPrefixes.join(ucProp+" ")+ucProp).split(" "),testDOMProps(props,prefixed,elem))}var inputElem,featureName,hasOwnProp,version="2.8.3",Modernizr={},docElement=document.documentElement,mod="modernizr",modElem=document.createElement(mod),mStyle=modElem.style,prefixes=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),omPrefixes="Webkit Moz O ms",cssomPrefixes=omPrefixes.split(" "),domPrefixes=omPrefixes.toLowerCase().split(" "),tests={},classes=[],slice=classes.slice,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement("div"),body=document.body,fakeBody=body||document.createElement("body");if(parseInt(nodes,10))for(;nodes--;)node=document.createElement("div"),node.id=testnames?testnames[nodes]:mod+(nodes+1),div.appendChild(node);return style=["&#173;",'<style id="s',mod,'">',rule,"</style>"].join(""),div.id=mod,(body?div:fakeBody).innerHTML+=style,fakeBody.appendChild(div),body||(fakeBody.style.background="",fakeBody.style.overflow="hidden",docOverflow=docElement.style.overflow,docElement.style.overflow="hidden",docElement.appendChild(fakeBody)),ret=callback(div,rule),body?div.parentNode.removeChild(div):(fakeBody.parentNode.removeChild(fakeBody),docElement.style.overflow=docOverflow),!!ret},isEventSupported=function(){function isEventSupported(eventName,element){element=element||document.createElement(TAGNAMES[eventName]||"div"),eventName="on"+eventName;var isSupported=eventName in element;return isSupported||(element.setAttribute||(element=document.createElement("div")),element.setAttribute&&element.removeAttribute&&(element.setAttribute(eventName,""),isSupported=is(element[eventName],"function"),is(element[eventName],"undefined")||(element[eventName]=undefined),element.removeAttribute(eventName))),element=null,isSupported}var TAGNAMES={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return isEventSupported}(),_hasOwnProperty={}.hasOwnProperty;hasOwnProp=is(_hasOwnProperty,"undefined")||is(_hasOwnProperty.call,"undefined")?function(object,property){return property in object&&is(object.constructor.prototype[property],"undefined")}:function(object,property){return _hasOwnProperty.call(object,property)},Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError;var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F,result=target.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return target.apply(that,args.concat(slice.call(arguments)))};return bound}),tests.draganddrop=function(){var div=document.createElement("div");return"draggable"in div||"ondragstart"in div&&"ondrop"in div};for(var feature in tests)hasOwnProp(tests,feature)&&(featureName=feature.toLowerCase(),Modernizr[featureName]=tests[feature](),classes.push((Modernizr[featureName]?"":"no-")+featureName));return Modernizr.addTest=function(feature,test){if("object"==typeof feature)for(var key in feature)hasOwnProp(feature,key)&&Modernizr.addTest(key,feature[key]);else{if(feature=feature.toLowerCase(),Modernizr[feature]!==undefined)return Modernizr;test="function"==typeof test?test():test,"undefined"!=typeof enableClasses&&enableClasses&&(docElement.className+=" "+(test?"":"no-")+feature),Modernizr[feature]=test}return Modernizr},setCss(""),modElem=inputElem=null,Modernizr._version=version,Modernizr._prefixes=prefixes,Modernizr._domPrefixes=domPrefixes,Modernizr._cssomPrefixes=cssomPrefixes,Modernizr.hasEvent=isEventSupported,Modernizr.testProp=function(prop){return testProps([prop])},Modernizr.testAllProps=testPropsAll,Modernizr.testStyles=injectElementWithStyles,Modernizr}(this,this.document),function($){"use strict";$.ajaxPrefilter(function(options){return options.iframe?(options.originalURL=options.url,"iframe"):void 0}),$.ajaxTransport("iframe",function(options,origOptions){function cleanUp(){files.each(function(i,file){var $file=$(file);$file.data("clone").replaceWith($file)}),form.remove(),iframe.one("load",function(){iframe.remove()}),iframe.attr("src","javascript:false;")}var form=null,iframe=null,name="iframe-"+$.now(),files=$(options.files).filter(":file:enabled"),markers=null,accepts=null;return options.dataTypes.shift(),options.data=origOptions.data,files.length?(form=$("<form enctype='multipart/form-data' method='post'></form>").hide().attr({action:options.originalURL,target:name}),"string"==typeof options.data&&options.data.length>0&&$.error("data must not be serialized"),$.each(options.data||{},function(name,value){$.isPlainObject(value)&&(name=value.name,value=value.value),$("<input type='hidden' />").attr({name:name,value:value}).appendTo(form)
}),$("<input type='hidden' value='IFrame' name='X-Requested-With' />").appendTo(form),accepts=options.dataTypes[0]&&options.accepts[options.dataTypes[0]]?options.accepts[options.dataTypes[0]]+("*"!==options.dataTypes[0]?", */*; q=0.01":""):options.accepts["*"],$("<input type='hidden' name='X-HTTP-Accept'>").attr("value",accepts).appendTo(form),markers=files.after(function(){var $this=$(this),$clone=$this.clone().prop("disabled",!0);return $this.data("clone",$clone),$clone}).next(),files.appendTo(form),{send:function(headers,completeCallback){iframe=$("<iframe src='javascript:false;' name='"+name+"' id='"+name+"' style='display:none'></iframe>"),iframe.one("load",function(){iframe.one("load",function(){var doc=this.contentWindow?this.contentWindow.document:this.contentDocument?this.contentDocument:this.document,root=doc.documentElement?doc.documentElement:doc.body,textarea=root.getElementsByTagName("textarea")[0],type=textarea&&textarea.getAttribute("data-type")||null,status=textarea&&textarea.getAttribute("data-status")||200,statusText=textarea&&textarea.getAttribute("data-statusText")||"OK",content={html:root.innerHTML,text:type?textarea.value:root?root.textContent||root.innerText:null};cleanUp(),completeCallback(status,statusText,content,type?"Content-Type: "+type:null)}),form[0].submit()}),$("body").append(form,iframe)},abort:function(){null!==iframe&&(iframe.unbind("load").attr("src","javascript:false;"),cleanUp())}}):void 0})}(jQuery),function(factory){if("function"==typeof define&&define.amd)define(factory);else if("object"==typeof exports)module.exports=factory();else{var _OldCookies=window.Cookies,api=window.Cookies=factory(window.jQuery);api.noConflict=function(){return window.Cookies=_OldCookies,api}}}(function(){function extend(){for(var i=0,result={};i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes)result[key]=attributes[key]}return result}function init(converter){function api(key,value,attributes){var result;if(arguments.length>1){if(attributes=extend({path:"/"},api.defaults,attributes),"number"==typeof attributes.expires){var expires=new Date;expires.setMilliseconds(expires.getMilliseconds()+864e5*attributes.expires),attributes.expires=expires}try{result=JSON.stringify(value),/^[\{\[]/.test(result)&&(value=result)}catch(e){}return value=encodeURIComponent(String(value)),value=value.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),key=encodeURIComponent(String(key)),key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),key=key.replace(/[\(\)]/g,escape),document.cookie=[key,"=",value,attributes.expires&&"; expires="+attributes.expires.toUTCString(),attributes.path&&"; path="+attributes.path,attributes.domain&&"; domain="+attributes.domain,attributes.secure&&"; secure"].join("")}key||(result={});for(var cookies=document.cookie?document.cookie.split("; "):[],rdecode=/(%[0-9A-Z]{2})+/g,i=0;i<cookies.length;i++){var parts=cookies[i].split("="),name=parts[0].replace(rdecode,decodeURIComponent),cookie=parts.slice(1).join("=");if('"'===cookie.charAt(0)&&(cookie=cookie.slice(1,-1)),cookie=converter&&converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent),this.json)try{cookie=JSON.parse(cookie)}catch(e){}if(key===name){result=cookie;break}key||(result[name]=cookie)}return result}return api.get=api.set=api,api.getJSON=function(){return api.apply({json:!0},[].slice.call(arguments))},api.defaults={},api.remove=function(key,attributes){api(key,"",extend(attributes,{expires:-1}))},api.withConverter=init,api}return init()}),function(){var FeatureDetector;FeatureDetector=function(){function FeatureDetector(modernizr,window,browser,browserDetector){this.modernizr=modernizr,this.window=window,this.browser=browser,this.browserDetector=browserDetector}return FeatureDetector.prototype.fileDragAndDrop=function(){return this.modernizr.draganddrop&&"touch"!==this.browser&&!this.browserDetector.isIE(this.window.navigator.userAgent)},FeatureDetector.prototype.xhrLevel2=function(){return null!=window.XMLHttpRequest&&null!=window.ProgressEvent&&null!=window.FormData},FeatureDetector.prototype.uploadUsingMultiple=function(){return this.browserDetector.isIOsUIWebView(this.window.navigator.userAgent)},FeatureDetector}(),namespace("App.Utils",function(exports){return exports.FeatureDetector=FeatureDetector})}.call(this),function(){var BrowserDetector;BrowserDetector=function(){function BrowserDetector(){}return BrowserDetector.isIE=function(ua){var msie,rv,trident;return msie=ua.indexOf("MSIE "),trident=ua.indexOf("Trident/"),msie>0?null!=parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10):trident>0?(rv=ua.indexOf("rv:"),null!=parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)):!1},BrowserDetector.isIphone=function(ua){return/(iPhone)/.test(ua)},BrowserDetector.isIOs=function(ua){return/(iPad|iPhone|iPod)/.test(ua)},BrowserDetector.isIOsUIWebView=function(ua){return BrowserDetector.isIOs(ua)&&!/Safari/.test(ua)},BrowserDetector}(),namespace("App.Utils",function(exports){return exports.BrowserDetector=BrowserDetector})}.call(this),function(){var CookiesAdapter=function(cookies){this.cookies=cookies};CookiesAdapter.prototype.getCacheType=function(){return this.cookies.get("varnish_cache")},namespace("App.Utils",function(exports){exports.CookiesAdapter=CookiesAdapter})}();var ProgressBar=function(elem,totalSteps,opts){var defaults={mode:0,text:"{{step}} of {{total}} questions answered",hidden:!1},options=$.extend({},defaults,opts);$label=$("<div class='label'/>"),$bar=$("<div class='bar'/>"),$wrapper=$("<div class='wrapper'/>"),$progress=$("<div class='progress'/>"),$a=$("<span/>"),$b=$("<span/>"),$span=$("<span/>"),elem.append($label,$bar.append($wrapper,$progress));var $text=$span.clone();$label.append($text),this.updateTotal=function(total){totalSteps=total},this.updateStep=function(step){var percent=parseInt(100*step/totalSteps,0);$text.html(0===options.mode?options.text.replace("{{step}}",step).replace("{{total}}",totalSteps):options.text.replace("{{percent}}",percent)),$progress.css("width",0===percent?0:percent+"%"),100==percent?$progress.addClass("rounded"):$progress.removeClass("rounded")},this.updateStep(0),this.show=function(){options.hidden&&elem.addClass("show")},this.hide=function(){options.hidden&&elem.removeClass("show")}};$.fn.progressBar=function(totalSteps,opts){return this.each(function(){var elem=$(this);if(!elem.data("progress")){var progressBar=new ProgressBar(elem,totalSteps,opts);elem.data("progress",progressBar)}})},function(){var Sanitize,sanitize,template;sanitize=function(value){var quotedString;return _.isString(value)?(quotedString=JSON.stringify(value),quotedString.substring(1,quotedString.length-1)):value},template=function(template,value){return template.replace("<%=a%>",sanitize(value))},Sanitize={sanitize:sanitize,template:template},namespace("App",function(exports){return exports.Sanitize=Sanitize})}.call(this),function(){var Submit;Submit=function(){function Submit($elem,stripeService,scoreCalculator,priceCalculator,numberFormatter,submitButton,submissionRepository,settings){this.$elem=$elem,this.stripeService=stripeService,this.scoreCalculator=scoreCalculator,this.priceCalculator=priceCalculator,this.numberFormatter=numberFormatter,this.submitButton=submitButton,this.submissionRepository=submissionRepository,this.settings=$.extend({},this.defaults,settings),this.renderButton(),this.initialize()}return Submit.prototype.inReview=!1,Submit.prototype.defaults={blurHeight:0,maxHeight:0,onSuccess:function(){},scrollSpeed:250,clickEventName:"click",useKeyboard:!1},Submit.prototype.initialize=function(){return this},Submit.prototype.getBrowser=function(){return Globals.browser},Submit.prototype.getToken=function(){return Globals.token},Submit.prototype.getLanguage=function(){return Globals.language},Submit.prototype.getHiddenFields=function(){return $(document).data("hidden")},Submit.prototype.disableUseFocus=function(){return window.Globals?(this.cachedUseFocus=Globals.useFocus,Globals.useFocus=!1):void 0},Submit.prototype.resetUseFocus=function(){return window.Globals?Globals.useFocus=this.cachedUseFocus:void 0},Submit.prototype.areHiddenFieldsEnabled=function(){return Globals.hiddenFieldsEnabled},Submit.prototype.setControls=function(controls){this.controls=controls,this.numQuestions=controls.length,this.$footerMessage=$(".footer-message")},Submit.prototype.renderButton=function(){this.$elem.find(".button-wrapper.submit").prepend(this.submitButton.render().$el)},Submit.prototype.bindEvents=function(){var _this=this;this.settings.useKeyboard&&$(document).on("keydown.footer",function(e){var key;return key=document.all?e.keyCode:e.which,App.Keyboard.isEnter(key)?_this.$elem.hasClass("review")?_this.review():_this.submit():void 0}),this.submitButton.on(this.settings.clickEventName,this.submit),this.$reviewButton.on(this.settings.clickEventName,this.review)},Submit.prototype.unbindEvents=function(){$(document).off(".footer"),this.$elem.off(".footer"),this.submitButton.off(this.settings.clickEventName),this.$reviewButton.off(this.settings.clickEventName)},Submit.prototype.submit=function(){var list;return list=this.generateList(),this.inReview=!1,list.length?(this.showMessage(App.Texts.review.replace(/{{NUM}}/g,list.length)),this.$footer.addClass("review")):(this.canSubmitForm!==!1&&this.sendForm(),this.canSubmitForm=!1)},Submit.prototype.review=function(){var id,list,self,_this=this;return self=this,list=this.generateList(this.controls,this.numQuestions),id=list[0],$("body").removeClass("default"===this.getBrowser()?"footer-error footer-submit":"full-footer"),this.$footer.removeClass("review"),"undefined"!=typeof id?(this.inReview=!0,this.disableUseFocus(),$(list).each(function(index,val){return self.controls[val].markValidationError?self.controls[val].markValidationError():self.controls[val].$elem.find(".confirm > .button").addClass("red")}),this.resetUseFocus(),setTimeout(function(){return form.scrollTo(id),"default"!==_this.getBrowser()?setTimeout(function(){return self.controls[id].validate(!1,!0,!0)},300):void 0},100)):void 0},Submit.prototype.getReview=function(){return this.inReview},Submit.prototype.setReview=function(r){return this.inReview=r},Submit.prototype.generateList=function(){var displayedControls,i,list,self;for(self=this,i=0,list=[],this.disableUseFocus(),displayedControls=_.filter(self.controls,function(control){return control.isActive&&control.isVisible});i<_.size(displayedControls);)displayedControls[i].validate(!1,!0,!0)||list.push(i),i++;return this.resetUseFocus(),list},Submit.prototype.getNext=function(current){var found,index,list,next,nextError;if(this.inReview){if(list=this.generateList(),index=0,nextError=list[index],found=!1,"undefined"!=typeof nextError)for(;!found;)"undefined"==typeof nextError?(next=list[0],found=!0):(found=nextError>current,next=nextError),nextError=list[index++];else next=this.numQuestions;return next}return!1},Submit.prototype.getFormValues=function(){var displayedControls,values,_this=this;return values={},displayedControls=_.filter(this.controls,function(control){return control.isActive&&control.isVisible}),_.each(displayedControls,function(control){var type;if(!_this.isPaymentFieldChildren(control))return type=control.type,"statement"!==type?values[type+":"+control.id]=control.value:void 0}),values},Submit.prototype.isPaymentFieldChildren=function(control){var parent;return parent=control.parent,null!=parent&&("function"==typeof parent.isPaymentField?parent.isPaymentField():void 0)},Submit.prototype.onBeforeSubmit=function(){return this.showSpinner()},Submit.prototype.onSubmit=function(){return this.hideSpinner()},Submit.prototype.getPriceObject=function(){return null!=this.getPaymentField()?{stripePrice:this.numberFormatter.formatTo2Decimals(this.priceCalculator.get("total"))}:void 0},Submit.prototype.sendForm=function(){var completedPaymentField,data,details,self,setTokenAndSubmit,stripeErrback,submitResults,_this=this;self=this,data={language:this.getLanguage()},this.scoreCalculator.hasCalculations()&&(data.score=this.numberFormatter.formatTo2Decimals(this.scoreCalculator.get("total"))),data=_.extend(data,this.getFormValues(),this.getPriceObject()),this.areHiddenFieldsEnabled()&&(data.extra=this.getHiddenFields()),this.onBeforeSubmit(),submitResults=function(data){var onComplete,onError,onSuccess;return onSuccess=function(){return self.success(App.Texts.success)},onError=function(err){var errorKey,errorMessage;return errorKey=err.responseJSON.error_code,null==errorKey&&(errorKey=0===err.status?"connection":"server"),errorMessage=null!=App.Texts[errorKey]?App.Texts[errorKey]:errorKey,self.error(errorMessage)},onComplete=function(){return self.canSubmitForm=!0,self.onSubmit()},_this.submissionRepository.submit(data,onSuccess,onError,onComplete)},stripeErrback=function(errCode){return self.error(App.Texts[errCode]),self.canSubmitForm=!0,self.onSubmit()},setTokenAndSubmit=function(token){return data.stripeToken=token,submitResults(data)},completedPaymentField=this.getCompletedPaymentField(),null!=completedPaymentField?(details=completedPaymentField.getValues(),this.stripeService.submit(details,setTokenAndSubmit,stripeErrback)):submitResults(data)},Submit.prototype.showSpinner=function(){var $submitButton,opts;return $submitButton=this.$footer.find(".button-wrapper.submit"),this.$submitButtonChildren=$submitButton.children(".button"),this.buttonHtml=this.$submitButtonChildren.html(),opts={lines:12,length:2.3,width:2.5,radius:8,color:this.$submitButtonChildren.css("color"),speed:2.1,trail:60,shadow:!1,hwaccel:!1},$submitButton.find("#spin").remove(),this.$spin=$("<div id='spin'></div>"),new Spinner(opts).spin(this.$spin[0]),$submitButton.addClass("loading").append(this.$spin),this.$submitButtonChildren.css("width",this.$submitButtonChildren.width()).html("")},Submit.prototype.hideSpinner=function(){return this.$submitButtonChildren.html(this.buttonHtml),this.$spin.remove()},Submit.prototype.getPaymentField=function(){return _.find(this.controls,function(control){return control.isPaymentField&&control.isPaymentField()})},Submit.prototype.getCompletedPaymentField=function(){var paymentField;return paymentField=this.getPaymentField(),null!=paymentField&&paymentField.isActive&&paymentField.isVisible&&paymentField.isFilled()?paymentField:void 0},Submit.prototype.success=function(str){return $(".outro.default").find(".content .text").html(str),this.settings.onSuccess()},Submit.prototype.error=function(str){this.showMessage(str)},Submit}(),namespace("App",function(exports){return exports.Submit=Submit})}.call(this),function(){var Attachment;Attachment=function(){function Attachment($attachment,settings){var obj,responsiveThreshold;if(this.$attachment=$attachment,this.settings=$.extend({},defaults,settings),responsiveThreshold="default"===this.settings.browser?0:600,this.settings.minAttachmentHeight=200,"touch"===this.settings.browser&&(this.settings.minAttachmentHeight=$(window).width()>=responsiveThreshold?260:150),obj=this.$attachment.data("attachment"),""!==obj.image)this.attach=this.attachImage,this.type=IMAGE,this.imgLoaded=!1,this.IOSGifLayer=void 0;else{if(""===obj.video)return void this.$attachment.html("");this.attach=this.attachVideo,this.type=VIDEO}this.attach(obj)}var IMAGE,VIDEO,defaults;return defaults={browser:"default",useLazyLoad:!0,embedVideo:!1,lazyLoadImage:window.settings.baseAssetPath+"quickyformapp/images/lazy.png",$question:[],$description:[],attachLimit:0,footerHeight:0,minAttachmentHeight:0,questionType:"",preventUpdate:!1,useFreezeFrame:!0},IMAGE=0,VIDEO=1,Attachment.prototype.attachImage=function(obj){var imageHeight,imageWidth,original,src,_this=this;return this.settings.useLazyLoad?(src=this.settings.lazyLoadImage,original=obj.image):(src=obj.image,original=""),imageWidth=obj.width,imageHeight=obj.height,this.$img=this.$attachment.find("img"),this.$img.attr("data-original",original),this.settings.useLazyLoad&&this.$img.lazyload({effect:"show",event:"lazyload",preventUpdate:this.settings.preventUpdate,load:function(){return _this.imgLoaded=!0,_this.isAttachmentAGif()&&(_this.settings.useFreezeFrame&&"default"===Globals.browser&&_this.applyFrezzeGif(),Globals.isIOs===!0)?_this.addGifToLayer():void 0}}),Globals.isIOs===!0&&this.isAttachmentAGif()&&(this.IOSGifLayer=this.createAttachmentGifLayer()),this.$attachment.data({width:imageWidth,height:imageHeight}),this.$attachment},Attachment.prototype.restartGif=function(){var _this=this;return"touch"===Globals.browser?setTimeout(function(){var src;return src=_this.$img.attr("src"),_this.$img.removeAttr("src").attr("src",src),_this.$img.css({opacity:1})},10):this.$img.trigger("focusenter")},Attachment.prototype.getOriginalSrc=function(){return this.$attachment.data().attachment.image},Attachment.prototype.isAttachmentAVideo=function(){return this.type===VIDEO},Attachment.prototype.isAttachmentAGif=function(){return this.type===IMAGE&&"gif"===this.$img.data("original").slice(-3)},Attachment.prototype.applyFrezzeGif=function(){return this.frezzeGif(),freezeframe.run(this.$img,this.$img.data("focus"))},Attachment.prototype.frezzeGif=function(){return this.$img.addClass("freezeframe")},Attachment.prototype.createAttachmentGifLayer=function(){var gifLayer;return gifLayer=$(".controls-gif-layer"),0===gifLayer.length&&(gifLayer=$("<div />").addClass("controls-gif-layer")),$("body").append(gifLayer),gifLayer},Attachment.prototype.addGifToLayer=function(){var gif;return gif=$("<img />"),gif.attr("src",this.$img.attr("src")),gif.css({"margin-left":-(this.$img.width()-1),"margin-top":-(this.$img.height()-1),height:this.$img.height(),width:this.$img.width()}),this.IOSGifLayer.append(gif)},Attachment.prototype.attachVideo=function(obj){var $iframe,h,scale,w;return this.$video=$("<div class='video'>"),this.$attachment.html(this.$video),scale="touch"===this.settings.browser?1:obj.scale,obj.ratio&&"undefinded"!=typeof obj.ratio||(obj.ratio=1.777),w=this.$attachment.width()*scale,h=w/obj.ratio,this.$video.data({width:w,height:h,video_id:obj.video_id}),this.$video.css({width:w,height:h}),"touch"===this.settings.browser?($iframe=$("<iframe width='100%' height='100%' src='//www.youtube.com/embed/"+obj.video_id+"' frameborder='0' allowfullscreen></iframe>"),this.$video.data("loaded",!0),this.$video.data("iframe",$iframe),this.$video.html($iframe)):void 0},Attachment.prototype.load=function(){return this.type!==IMAGE?this.loadVideo():(this.$img.trigger("lazyload"),this.isAttachmentAGif()?this.isImageLoaded()?this.restartGif():this.$img.data("focus",!0):void 0)},Attachment.prototype.loadVideo=function(){var h,self,w;return self=this,"touch"===this.settings.browser&&this.$video.html(this.$video.data("iframe")),this.$video.data("loaded")!==!0?(this.$video.data("loaded",!0),w=this.$video.width(),h=this.$video.height(),this.$video.tubeplayer({width:w+"px",height:h+"px",wmode:"opaque",iframed:!0,initialVideo:this.$video.data("video_id"),preferredQuality:"hd720",protocol:"https",onPlayerPlaying:function(){return self.$video.trigger("play")}})):void 0},Attachment.prototype.triggerLazyload=function(){return this.type!==IMAGE||this.isImageLoaded()?void 0:this.$img.trigger("lazyload")},Attachment.prototype.pause=function(){return this.type===VIDEO?"undefined"!=typeof this.$video.tubeplayer?this.$video.tubeplayer("pause"):this.$video.html(""):this.type===IMAGE&&this.isAttachmentAGif()?this.$img.trigger("focusleave"):void 0},Attachment.prototype.precalculate=function(){this.questionHeight=this.settings.$question.outerHeight(!0),this.descriptionHeight=0,this.settings.$description.length&&(this.descriptionHeight=this.settings.$description.outerHeight(!0))},Attachment.prototype.resize=function(windowHeight,wWidth){var aHeight,aWidth,h,limit,w;return aWidth=this.$attachment.data("width"),aHeight=this.$attachment.data("height"),w=aWidth,h=aHeight,w>wWidth&&(w=wWidth,h=aHeight*wWidth/aWidth),limit=windowHeight-this.settings.attachLimit-this.settings.footerHeight-this.questionHeight-this.descriptionHeight,limit=Math.max(limit,this.settings.minAttachmentHeight),h>limit&&(w=w*limit/h,h=limit),this.$attachment.css({width:w,height:h}),this.type===IMAGE?this.$img.css({width:w,height:h}):"undefined"!=typeof tubeplayer&&this.$attachment.tubeplayer("size",{width:w,height:h}),"touch"===this.settings.browser?this.$attachment.trigger("updateAuxAttachment",[w,h]):void 0},Attachment.prototype.getTypeAsString=function(){switch(this.type){case IMAGE:return"image";case VIDEO:return"video"}},Attachment.prototype.isImageLoaded=function(){return this.imgLoaded},Attachment}(),namespace("App",function(exports){return exports.Attachment=Attachment})}.call(this),function(){var Keyboard;Keyboard={UP:0,DOWN:1,LEFT:2,RIGHT:3,isNumber:function(key){return key>=48&&57>=key||key>=96&&105>=key},isDash:function(key){return 189===key},isTab:function(key){return 9===key},isEnter:function(key){return 13===key},isSpace:function(key){return 32===key},isArrowLeft:function(key){return 37===key},isArrowUp:function(key){return 38===key},isArrowRight:function(key){return 39===key},isArrowDown:function(key){return 40===key},isShiftOnly:function(key){return 16===key},isEsc:function(key){return 27===key},isDelete:function(key){return 8===key},isSupr:function(key){return 46===key},isAlt:function(key){return 18===key},isUppercase:function(key){return 20===key},isPageUp:function(key){return 33===key},isPageDown:function(key){return 34===key}},namespace("App",function(exports){return exports.Keyboard=Keyboard})}.call(this),function(){var Banner;Banner=function(){function Banner(){}return Banner.$el="",Banner.template='<div id="banner" class="step<%=containerStep%> <%=className%>">		<div class="overlay"></div>		<div class="persistent background"></div>		<div class="persistent"></div>		<div class="content">			<div class="button-wrapper by">				<span><%=text%></span>				<a href="<%=url%>" target="_blank" class="button general enabled">					<%=buttonText%>				</a>				</div>		</div>',Banner.params={utm_campaign:"",utm_source:"typeform.com",utm_medium:"typeform",utm_content:"typeform-thankyou",utm_term:""},Banner.buildQueryParams=function(obj){var k,v;return function(){var _results;_results=[];for(k in obj)v=obj[k],_results.push(k+"="+encodeURIComponent(v));return _results}().join("&")},Banner.render=function(text,buttonText,hasFooterButtonOnMobile){var className,language,params,url;return language=/-ES|es|es-/.test(navigator.language)?"es":"en",params={utm_campaign:"typeform_"+Globals.uid,utm_term:Globals.language.toUpperCase()},url=Globals.signupPath+"?"+Banner.buildQueryParams($.extend({},Banner.params,params)),hasFooterButtonOnMobile&&(className="banner-top"),Banner.$el=$(_.template(Banner.template,{containerStep:window.containerStep,className:className,text:text,url:url,buttonText:buttonText})),$("body").append(Banner.$el),"default"===Globals.browser&&_.defer(Banner.raise),this},Banner.raise=function(){return Banner.$el.addClass("risen")},Banner}(),namespace("App",function(exports){return exports.Banner=Banner})}.call(this),function(){var Logic;Logic=function(){function Logic(){var _this=this;this.setPaymentField(),this.logicJumpsController.onBackwardJump=function(control){return _this.nextCandidate=control,_this.nextCandidate.setFocus?_this.nextCandidate.setFocus(!0,!0):void 0}}var PRELOAD_IMAGES_MAX_DEEP;return PRELOAD_IMAGES_MAX_DEEP=3,Logic.prototype.controls=[],Logic.prototype.logicJumpsController=[],Logic.prototype.setPaymentField=function(){return this.paymentField=_.find(this.controls,function(control){return control.isPaymentField&&control.isPaymentField()})},Logic.prototype.check=function(){var currentControl,_this=this;return"undefined"!=typeof Globals&&null!==Globals&&"field"===Globals.parent?!1:(this.nextCandidate=!1,this.counter=1,this.sub_counter=0,null!=this.scroll&&(currentControl=this.scroll.getCurrentControl(),currentControl&&currentControl.setValue(function(){return currentControl.$elem.trigger("change-value",currentControl)})),this.logicJumpsController.check(0),this.setVisibilityByPipeValue(),this.scoreCalculator.evaluate(),this.priceCalculator.evaluate(),this.refreshGroups(),this.refreshPositions(),this.refresh(),_.defer(function(){return _this.apiProgress?_this.updateProgress():void 0}))},Logic.prototype.refresh=function(){},Logic.prototype.setFocus=function(){},Logic.prototype.unsetFocus=function(){},Logic.prototype.refreshGroups=function(){var groups,_this=this;groups=_.filter(this.controls,function(control){return"group"===control.type}),_.each(groups,function(group){var childs,is_active,is_visible;return childs=_.filter(_this.controls,function(control){return null!=control.parent&&control.parent.id===group.id}),is_active=_.any(childs,function(child){return child.isActive}),is_visible=_.any(childs,function(child){return child.isVisible}),is_active&&group.set("isActive",!0),is_visible&&group.set("isVisible",!0),group.connect&&is_active&&is_visible&&!group.has_button?(group.connect.$elem.removeClass("first"),group.connect=_.find(childs,function(child){return child.isActive&&child.isVisible}),group.connect.$elem.addClass("first")):void 0})},Logic.prototype.refreshPositions=function(){var _this=this;_.each(this.controls,function(control){return control.isActive&&control.isVisible?("statement"!==control.type&&(null!=control.parent?control.set("index",App.Utils.getLetter(_this.sub_counter++)+"."):control.set("index",_this.counter++)),"group"===control.type?_this.sub_counter=0:void 0):!1})},Logic.prototype.setVisibilityByPipeValue=function(){var show;return show=!0,_.chain(this.controls).filter(function(control){return control.isActive}).each(function(control){return show=show&&control.question.isReadyForRender()&&control.description.isReadyForRender(),control.set("isVisible",show),show})},Logic.prototype.next=function(delay,check){var current,displayedControls,nextCandidateIndex,_this=this;null==delay&&(delay=!1),null==check&&(check=!0),delay&&(delay=this.scroll.settings["fast"===delay?"delayAutoScrollFast":"delayAutoScroll"]),current=this.scroll.getCurrent(),this.scroll.getCurrentControl().setValue(),displayedControls=_.filter(this.controls,function(control){return control.isActive&&control.isVisible}),check&&this.check(),nextCandidateIndex=current+1,this.nextCandidate&&(nextCandidateIndex=_.indexOf(displayedControls,this.nextCandidate)),this.scroll.getCurrentControl().validate(function(){var afterControls,isValid;return typeform.Form.footer.inReview?(afterControls=_.rest(displayedControls,current),(isValid=_.every(afterControls,function(control,index){var valid;return valid=control.validate(!1,!0),_.delay(function(){return valid?void 0:_this.scroll.scrollTo(current+index)},delay),valid}))?_this.scroll.scrollToFooter(!0):void 0):_.delay(function(){return _this.scroll.scrollTo(nextCandidateIndex)},delay)})},Logic.prototype.updateProgress=function(){var i,involved_controls,num_involved_controls,total;for(total=0,i=0,involved_controls=_.filter(this.controls,function(control){return control.isActive&&"statement"!==control.type&&"group"!==control.type}),num_involved_controls=_.size(involved_controls),this.apiProgress.updateTotal(num_involved_controls);num_involved_controls>i;)involved_controls[i].done&&involved_controls[i].isCompleted&&total++,i++;this.apiProgress.updateStep(total)},Logic.prototype.getPaymentField=function(){return this.paymentField},Logic.prototype.getControlById=function(controlId){return _.findWhere(this.controls,{id:controlId})},Logic.prototype.getControlIndex=function(controlId){return _.indexOf(this.controls,_.findWhere(this.controls,{id:controlId}))},Logic.prototype.getNextControl=function(controlId){return this.controls[this.getControlIndex(controlId)+1]},Logic.prototype.preloadNextVisibleImages=function(control,deep){var possibleDestinations,_this=this;return null==deep&&(deep=0),deep>PRELOAD_IMAGES_MAX_DEEP||void 0===control?void 0:(possibleDestinations=this.getDestinations(control.id),_.each(possibleDestinations,function(control){return _this.preloadNextVisibleImages(control,deep+1)}),this.preloadControlImages(control))},Logic.prototype.getDestinations=function(controlId){var destinations;return destinations=[],this.addDestinationsByNextBehaviour(destinations,controlId),this.addDestinationsByJumps(destinations,controlId),destinations},Logic.prototype.addDestinationsByNextBehaviour=function(possibleDestinations,controlId){var next;return next=this.getNextControl(controlId),null!=next?possibleDestinations.push(next):void 0},Logic.prototype.addDestinationsByJumps=function(possibleDestinations,controlId){var jumps,_this=this;return jumps=this.logicJumpsController.getOutgoing(controlId),_.each(jumps,function(jump){var destinationControl,destinationId;return destinationId=jump.get("destination").id,_this.isBackwardJump(controlId,destinationId)?void 0:(destinationControl=_this.getControlById(destinationId),possibleDestinations.push(destinationControl))})},Logic.prototype.isBackwardJump=function(originId,destinationId){return this.getControlIndex(destinationId)<this.getControlIndex(originId)},Logic.prototype.preloadControlImages=function(control){return null!=control?("list-image"===control.type?control.triggerLazyload():control.attachment&&control.attachment.triggerLazyload(),control):void 0},Logic}(),namespace("App",function(exports){return exports.Logic=Logic})}.call(this),function(){var Header,HeaderModel,SubHeader,_ref,_ref1,_ref2,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};HeaderModel=function(_super){function HeaderModel(){return _ref=HeaderModel.__super__.constructor.apply(this,arguments)}return __extends(HeaderModel,_super),HeaderModel.prototype.defaults={type:"default",item:"",question:"",attachment:null,state:"default",showStripeBanner:!1},HeaderModel}(Backbone.Model),Header=function(_super){function Header(){return _ref1=Header.__super__.constructor.apply(this,arguments)}return __extends(Header,_super),Header.prototype.tagName="div",Header.prototype.className="header",Header.prototype.template='<div class="content"><div class="close"></div><div class="content-wrapper"><div class="question-wrap"><div class="item"><span></span></div> <div class="question"><div class="attachment"></div><a class="stripe-logo" href="http://www.stripe.com" target="_blank"></a><span></span></div><div class="clear"></div></div> <div class="full-content"><div class="description"></div><div class="attachment"></div></div></div></div> <div class="overlay"></div> <div class="persistent background"></div> <div class="persistent"></div><div class="smooth-break"></div>',Header.prototype.height=55,Header.prototype.is_open=!1,Header.prototype.properties={heights:{"default":55,group:100},one_line_threshold:35,two_lines_threshold:60,more_than_three_lines_threshold:80,min_attachment_height:120,inner_padding:15,padding_bottom:40},Header.prototype.initialize=function(params){return this.observer=params.observer,this.$el.html(this.template),this.$el.addClass("step"+window.containerStep),this.hide(),this.setEvents(),this},Header.prototype.setEvents=function(){var click_event,_this=this;click_event="touch"===Globals.browser?"touchend":"click",this.listenTo(this.model,"change:item",this.renderItem),this.listenTo(this.model,"change:question",this.renderQuestion),this.listenTo(this.model,"change:attachment",this.renderAttachment),this.listenTo(this.model,"change:description",this.renderDescription),this.listenTo(this.model,"change:showStripeBanner",this.renderStripeBanner),this.listenTo(this.model,"change:type",this.setType),this.listenTo(this.model,"change:state",this.setState),$(window).on("resize",function(){return _this.model.set("state","default")}),this.$el.on(click_event,".close",function(){return _this.reset(),!1}),this.$el.on("thumbnail-hide",function(){_this.$el.removeClass("thumbnail-show"),_this.resize()
}),this.$el.on("thumbnail-show",function(){"group"===_this.model.attributes.type&&(_this.$el.addClass("thumbnail-show"),_this.resize())})},Header.prototype.render=function(){return this.setType(),this.renderItem(),this.renderQuestion(),this.renderAttachment(),this.renderStripeBanner(),this.$el},Header.prototype.setType=function(){this.$el.alterClass("type-*","type-"+this.model.attributes.type),this.height="group"===this.model.attributes.type?this.getProperty("heights","group"):this.getProperty("heights","default")},Header.prototype.setState=function(){this.$el.alterClass("state-*","state-"+this.model.attributes.state),this.resize(),"full"===this.model.attributes.state?(this.$el.css({height:$(window).height()+40}),$("body").addClass("scroll-disable")):(this.$el.css({height:this.height}),$("body").removeClass("scroll-disable"))},Header.prototype.isOpenable=function(){return"group"===this.model.attributes.type&&!this.model.get("showStripeBanner")&&("n"===this.lines||null!=this.model.attributes.description||this.model.attributes.attachment)},Header.prototype.reset=function(){this.height=this.getProperty("heights",this.model.attributes.type),this.$el.css({height:this.height}),this.model.set({state:"default"})},Header.prototype.renderItem=function(){this.$item||(this.$item=this.$el.find(".item > span")),this.$item.html(this.model.attributes.item)},Header.prototype.renderQuestion=function(){this.$question||(this.$question=this.$el.find(".question")),this.$question.children("span").html(this.model.attributes.question)},Header.prototype.renderStripeBanner=function(){this.$stripeBanner||(this.$stripeBanner=this.$el.find(".stripe-logo")),this.$stripeBanner.html(_.template(_.unescape(App.Texts.payment_description_stripe),{logo:$("#stripe-logo").html()})),this.model.get("showStripeBanner")?this.$stripeBanner.show():this.$stripeBanner.hide()},Header.prototype.renderDescription=function(){var description;this.$description||(this.$description=this.$el.find(".description")),description=this.model.attributes.description,this.$description.html(description||""),"group"!==this.model.get("type")||null==description||this.model.get("showStripeBanner")?this.$description.hide():this.$description.show()},Header.prototype.renderAttachment=function(){var $img,attachment;attachment=this.model.attributes.attachment,this.$attachment||(this.$attachment=this.$el.find(".attachment")),this.$attachment.empty(),!attachment||"group"!==this.model.get("type")||attachment.isAttachmentAGif()||attachment.isAttachmentAVideo()||($img=$("<img/>"),$img.attr("src",attachment.getOriginalSrc()),this.$attachment.html($img))},Header.prototype.show=function(){return this.is_open=!0,this.resize(),this.isOpenable()?this.$el.addClass("openable"):this.$el.removeClass("openable"),this.$el.css({height:this.height,top:-1}),this},Header.prototype.hide=function(){return this.is_open=!1,this.$el.css({height:this.height}),this.$el.css({top:-this.height-60}),this},Header.prototype.getProperty=function(a,b){return _.isUndefined(b)?this.properties[a]:this.properties[a][b]},Header.prototype.resize=function(){var attachment,attachment_height,attachment_width,container_width,description_height,h,paddings,question_height,w,window_height;this.$el.addClass("resizing"),question_height=this.$question.children("span").height(),null==this.$questionWrap&&(this.$questionWrap=this.$el.find(".question-wrap")),"default"===this.model.attributes.state?(question_height=this.$question.children("span").height(),this.$questionWrap.css({marginTop:0}),this.lines="one",question_height>this.getProperty("one_line_threshold")&&(this.lines="two",question_height>this.getProperty("two_lines_threshold")&&(this.lines="three",question_height>this.getProperty("more_than_three_lines_threshold")&&(this.lines="n"))),this.$el.alterClass("*-lines",this.lines+"-lines")):"full"===this.model.attributes.state&&(question_height=this.$question.height(),window_height=$(window).height(),container_width=this.$el.find(".full-content").width(),description_height=null!=this.$description?this.$description.outerHeight(!0):0,attachment=this.model.attributes.attachment,attachment_width=null!==attachment&&attachment.$img?attachment.$img[0].width:0,attachment_height=null!==attachment&&attachment.$img?attachment.$img[0].height:0,w=Math.min(attachment_width,container_width),h=attachment_height*w/attachment_width,_.isNaN(h)&&(h=0),question_height+description_height+h>window_height?(h=Math.max(this.getProperty("min_attachment_height"),window_height-question_height-description_height-this.getProperty("padding_bottom")),this.$el.css({paddingTop:0})):(paddings=this.getProperty("inner_padding"),this.$attachment&&(paddings+=this.getProperty("inner_padding")),description_height>0&&(paddings+=this.getProperty("inner_padding")),this.$questionWrap.css({marginTop:Math.max(0,(window_height-question_height-description_height-h-paddings-this.getProperty("padding_bottom"))/2)})),this.$attachment&&this.$el.find(".full-content").find("img").css({height:h,width:h/attachment_height*attachment_width})),this.$el.removeClass("resizing")},Header}(Backbone.View),SubHeader=function(_super){function SubHeader(){return _ref2=SubHeader.__super__.constructor.apply(this,arguments)}return __extends(SubHeader,_super),SubHeader.prototype.tagName="div",SubHeader.prototype.className="header sub",SubHeader.prototype.template='<div class="content"> <div class="content-wrapper"><div class="item"><span></span></div> <div class="question"><span></span></div> </div></div> <div class="overlay"></div> <div class="persistent background"></div> <div class="persistent"></div>',SubHeader.prototype.height=70,SubHeader.prototype.initialize=function(){return this.hide(),SubHeader.__super__.initialize.apply(this,arguments),this},SubHeader.prototype.show=function(){return this.$el.addClass("show"),this},SubHeader.prototype.hide=function(){return this.$el.removeClass("show"),this},SubHeader}(Header),namespace("App",function(exports){return exports.HeaderModel=HeaderModel,exports.Header=Header,exports.SubHeader=SubHeader})}.call(this),function(){var TextView,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};TextView=function(_super){function TextView(){return _ref=TextView.__super__.constructor.apply(this,arguments)}var UNAVAILABLE_VALUE,fillUnavailableVariables,getControlById,getVarsWhereEmitterIsNotAvailable,isEmitterAvailable,isEmitterBeforeConsumer,isFilled;return __extends(TextView,_super),TextView.prototype.template="",TextView.prototype.controls=[],TextView.prototype.templateSettings={interpolate:/\{\{([a-zA-Z0-9_ ]+)\}\}/g},UNAVAILABLE_VALUE="_____",TextView.prototype.initialize=function(options){return this.template=options.template||"",this.controls=options.controls,this.textModel=this.createModel(this.getUsedVars(this.template)),this.listenTo(this.textModel,"change",this.render),this},TextView.prototype.setTemplate=function(template){return this.template=template,this.updateModel(this.textModel,this.getUsedVars(this.template)),this.render()},TextView.prototype.createModel=function(array){var vars;return vars=_.object(array,[]),new Backbone.Model(vars)},TextView.prototype.updateModel=function(model,array){return _.each(array,function(varname){return null==model.attributes[varname]?model.set(varname,void 0):void 0}),model},TextView.prototype.isReadyForRender=function(){return fillUnavailableVariables.call(this),_.every(this.textModel.attributes,isFilled)},TextView.prototype.getUsedVars=function(sentence){return sentence.match(/[^[\{{][a-zA-Z0-9_]+(?=}})/g)},TextView.prototype.getText=function(){return _.template(this.template,this.textModel.toJSON(),this.templateSettings)},TextView.prototype.render=function(){return this.$el.html(this.getText()),this.$el},isFilled=function(value){return!(""===value||_.isNull(value)||_.isUndefined(value))},fillUnavailableVariables=function(){var unavailableVars,_this=this;return unavailableVars=getVarsWhereEmitterIsNotAvailable.call(this),_.each(unavailableVars,function(value,key){return _this.textModel.set(key,UNAVAILABLE_VALUE)})},getVarsWhereEmitterIsNotAvailable=function(){var _this=this;return _.pick(this.textModel.attributes,function(value,key){var controlId,emitter,varType;return varType=key.split("_")[0],controlId=parseInt(key.split("_")[1],10),emitter=getControlById.call(_this,controlId),"answer"===varType&&!isEmitterAvailable.call(_this,emitter)})},getControlById=function(controlId){return _.findWhere(this.controls,{id:controlId})},isEmitterAvailable=function(emitter){return emitter&&isEmitterBeforeConsumer.call(this,emitter)},isEmitterBeforeConsumer=function(emitter){return _.indexOf(this.controls,this.options.consumerControl)>_.indexOf(this.controls,emitter)},TextView}(Backbone.View),namespace("App",function(exports){return exports.TextView=TextView})}.call(this),function(){var TextConnector,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};TextConnector=function(){function TextConnector(options){this.setupScreenView=__bind(this.setupScreenView,this),this.setupFieldView=__bind(this.setupFieldView,this),this.options=$.extend({},this.defaults,options),this.hiddenFields=this.options.hiddenFields,this.connect()}return TextConnector.prototype.hiddenFields={},TextConnector.prototype.defaults={scoreCalculator:null,priceCalculator:null,currencyFormatter:null,appSettings:[],form:[],intro:null,outros:null,selectors:{terms:"scroll-area"}},TextConnector.prototype.getHiddenFields=function(){return this.hiddenFields.getAll()},TextConnector.prototype.connect=function(){this.connectFields(),this.connectIntro(),this.connectOutros()},TextConnector.prototype.connectFields=function(){var _this=this;_.each(this.options.form.controls,function(control){return control.isEmitter=!1,_this.setupFieldView({control:control,view:"question"}),_this.setupModel(control.question.textModel),_this.setupFieldView({control:control,view:"description"}),_this.setupModel(control.description.textModel),"terms"===control.type?(_this.setupFieldView({control:control,view:_this.options.selectors.terms}),_this.setupModel(control[_this.options.selectors.terms].textModel)):void 0})},TextConnector.prototype.connectIntro=function(){null!=this.options.intro&&(this.setupScreenView({control:this.options.intro,view:"text",type:"intro"}),this.setupModel(this.options.intro.text.textModel),this.setupScreenView({control:this.options.intro,view:"description",type:"intro"}),this.setupModel(this.options.intro.description.textModel))},TextConnector.prototype.connectOutros=function(){var _this=this;null!=this.options.outros&&_.each(this.options.outros,function(outro){return _this.setupScreenView({control:outro,view:"text",type:"outro"}),_this.setupModel(outro.text.textModel),_this.setupModel(outro.getUrlModel())})},TextConnector.prototype.setupModel=function(model){var vars,_this=this;vars=_.keys(model.attributes),_.each(vars,function(varname){var variable;variable=new App.Utils.Variable(varname),variable.setup(model,_this.options.form,_this.hiddenFields.getAll(),_this.options.scoreCalculator,_this.options.priceCalculator,_this.options.currencyFormatter,_this.options.numberFormatter)})},TextConnector.prototype.setupView=function(options){var control;control=options.control,control[options.view]=new App.TextView({el:options.selector,template:options.template,controls:this.options.form.controls,consumerControl:control}),control[options.view].render()},TextConnector.prototype.setupFieldView=function(options){this.setupView(_.extend(options,{selector:"#"+options.control.id+"."+options.control.type+" ."+options.view,template:options.control.$elem.find("."+options.view).html()}))},TextConnector.prototype.setupScreenView=function(options){var id,selector;id=options.control.$screen.attr("id"),selector="",null!=id&&""!==id&&(selector="#"+id),selector+="."+options.type+" ."+options.view,this.setupView(_.extend(options,{selector:selector,template:options.control.$screen.find("."+options.view).html()}))},TextConnector}(),namespace("App",function(exports){return exports.TextConnector=TextConnector})}.call(this),function(){var ControlsFactory,__slice=[].slice;ControlsFactory=function(){function ControlsFactory(fieldsData,browser,currencyFormatter,priceCalculator,featureDetection,settings,numberFormatter){this.fieldsData=fieldsData,this.browser=browser,this.currencyFormatter=currencyFormatter,this.priceCalculator=priceCalculator,this.featureDetection=featureDetection,this.settings=settings,this.numberFormatter=numberFormatter}return ControlsFactory.prototype.build=function(){var args,controls;return args=1<=arguments.length?__slice.call(arguments,0):[],controls=function(){switch(this.browser){case"default":return this.buildDefault.apply(this,args);case"touch":return this.buildTouch.apply(this,args);case"fallback":return this.buildFallback.apply(this,args)}}.call(this)},ControlsFactory.prototype.getFieldData=function(id){return _.findWhere(this.fieldsData,{id:id})},ControlsFactory.prototype.buildControl=function($el,fieldData,templates){var control,model,type;return type=fieldData.type,"opinion-scale"===type||"file-upload"===type?(fieldData=this.getFieldData(fieldData.id),control=this.buildControlUsingFactory($el,type,fieldData),$el.data("control",control)):(model=new Backbone.Model(fieldData),"group"===type?(control=this.buildControlUsingGroupClass($el,model,templates),$el.data("control",control)):control=this.buildControlUsingJqueryPlugin($el),control.model=model,control.isActive=!1,control.id=model.get("id"),control.$elem=$el,control.type=type,control.parent=$el.siblings("#"+$el.data("parent")).data("control"),control.description=$el.find(".description").html()),control},ControlsFactory.prototype.buildControlUsingFactory=function($el,type,fieldData){var control,controlFactory,fieldView;return controlFactory=new App.ControlFactory(type,this.browser,this.featureDetection,this.settings),fieldView=controlFactory.build(fieldData),control=new App.Control($el,fieldView,this.browser)},ControlsFactory.prototype.buildControlUsingJqueryPlugin=function($el){return $el.data("control")},ControlsFactory.prototype.buildControlUsingGroupClass=function($el,model,templates){return new App.Control.Group($el,model,templates,this.currencyFormatter,this.priceCalculator,this.numberFormatter)},ControlsFactory.prototype.buildDefault=function($controls,confirmButton,scroll,templates,footer){var commonOptions;return commonOptions={confirmButton:confirmButton},$controls.filter(".statement").statement(commonOptions),$controls.filter(".textfield").not("li[id*='creditCard']").textfield(commonOptions),$controls.filter(".textarea").textarea(commonOptions),$controls.filter(".number").not("li[id*='creditCard']").textfield(commonOptions),$controls.filter(".list").list(commonOptions),$controls.filter(".list-image").list(commonOptions),$controls.filter(".yes-no").yesNo(commonOptions),$controls.filter(".terms").terms(commonOptions),$controls.filter(".email").textfield(commonOptions),$controls.filter(".website").textfield(commonOptions),$controls.filter("li[id$='creditCardNumber']").textfield(_.extend({},commonOptions,{validator:App.validation.creditCardNumber})),$controls.filter("li[id$='creditCardCvc']").textfield(_.extend({},commonOptions,{validator:App.validation.creditCardCvc})),$controls.filter("li[id$='creditCardName']").textfield(commonOptions),$controls.filter(".rating").rating(commonOptions),$controls.filter(".dropdown").dropdown(_.extend({},commonOptions,{awesomise:!0,Scroll:scroll})),this.buildControls($controls,templates,footer)},ControlsFactory.prototype.buildTouch=function($controls,confirmButton,scroll,templates,footer){return $controls.filter(".statement").statement(),$controls.filter(".textfield").not("li[id*='creditCard']").textfield(),$controls.filter(".textarea").textarea(),$controls.filter(".number").textfield(),$controls.filter(".list").list({confirmButton:confirmButton}),$controls.filter(".list-image").list({confirmButton:confirmButton}),$controls.filter(".yes-no").yesNo(),$controls.filter(".terms").terms(),$controls.filter(".email").textfield(),$controls.filter(".website").textfield(),$controls.filter("li[id$='creditCardNumber']").textfield({validator:App.validation.creditCardNumber}),$controls.filter("li[id$='creditCardCvc']").textfield({validator:App.validation.creditCardCvc}),$controls.filter("li[id$='creditCardName']").textfield(),$controls.filter(".rating").rating(),$controls.filter(".dropdown").dropdown({awesomise:!1}),this.buildControls($controls,templates,footer)},ControlsFactory.prototype.buildControls=function($controls,templates,footer){var controls,_this=this;return controls=[],$controls.each(function(i,el){var $el,control;return $el=$(el),control=_this.buildControl($el,$el.data("model"),templates),_this.createParentConnections(control),_this.addAttachment(control,footer),control.init(),controls.push(control)}),controls},ControlsFactory.prototype.createParentConnections=function(control){null!=control.parent&&control.$elem.addClass("sub-question"),null!=control.parent&&(control.parent.addSubquestion(control),control.parent.has_button||(control.connect=control.parent,control.$elem.addClass("connected"),control.parent.$elem.addClass("connected"),null==control.parent.connect&&(control.parent.connect=control,control.$elem.addClass("first")))),"default"===this.browser&&("group"!==control.type||control.has_button||control.$elem.addClass("connected"))},ControlsFactory.prototype.addAttachment=function(control,footer){var $attachment,format;$attachment=control.$elem.find(".attachment"),$attachment.length?(format="touch"===this.browser?Globals.isMobile?"small":"large":"default",control.attachment=new App.Attachment($attachment,{$question:control.$elem.find(".question"),$description:control.$elem.find(".description"),attachLimit:control.attachLimit[format],footerHeight:footer.get("blurHeight"),questionType:control.type,browser:this.browser,preventUpdate:!0})):control.attachment=!1},ControlsFactory.prototype.buildFallback=function($fields){var controls,fieldTypes,self,_this=this;return self=this,controls=[],fieldTypes={textfield:App.Textfield,textarea:App.Textarea,number:App.Number,email:App.Email,website:App.Website,list:App.List,"list-image":App.ListImage,"yes-no":App.YesNo,rating:App.Rating,terms:App.Terms,dropdown:App.Dropdown,statement:App.Statement,group:App.Group},$fields.each(function(i,el){var $field,control,fieldData,fieldId,parentControl,parentID,_ref;return $field=$(el),fieldId=$field.attr("id"),fieldData=_this.getFieldData(parseInt(fieldId,10)),null==fieldData||"opinion-scale"!==(_ref=fieldData.type)&&"file-upload"!==_ref||(control=_this.buildControlUsingFactory($field,fieldData.type,fieldData)),$.each(fieldTypes,function(fieldType,Class){return $field.hasClass(fieldType)?control="group"===fieldType?new Class($field,self.currencyFormatter,self.priceCalculator):new Class($field):void 0}),(null!=fieldId?fieldId.match("creditCardNumber"):void 0)&&control.setCustomValidator(App.validation.creditCardNumber),(null!=fieldId?fieldId.match("creditCardCvc"):void 0)&&control.setCustomValidator(App.validation.creditCardCvc),null!=control?(parentID=control.parent,parentControl=_.find(controls,function(control){return control.id===parentID&&parentID}),null!=parentControl&&parentControl.addSubquestion(control),control.parent=parentControl,controls.push(control)):void 0}),controls},ControlsFactory}(),namespace("App",function(exports){return exports.ControlsFactory=ControlsFactory})}.call(this),function(){var ControlFactory;ControlFactory=function(){function ControlFactory(type,browser,featureDetector,settings){switch(type){case"opinion-scale":return new App.factories.OpinionScaleFactory(browser);case"file-upload":return new App.factories.FileUploadFactory(browser,featureDetector,settings.colors)}}return ControlFactory}(),namespace("App",function(exports){return exports.ControlFactory=ControlFactory})}.call(this),function(){var Control,minFieldHeight,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};minFieldHeight={"opinion-scale":{"default":180,large:180,small:140},"file-upload":{"default":0,large:0,small:0}},Control=function(){function Control($el,fieldView,browser){this.$el=$el,this.fieldView=fieldView,this.browser=browser,this.markValidationError=__bind(this.markValidationError,this),this.fieldModel=this.fieldView.getFieldModel(),this.attachPropertiesForUseInLegacy(),this.$question=this.$el.find(".question > span"),this.$index=this.$el.find(".item > span"),this.$el.find(".control").html(this.fieldView.render().$el),this.fieldModel.on("change:value",this.onChange,this),this.fieldModel.on("change:question",this.renderQuestion,this),this.fieldModel.on("change:error",this.checkError,this),this.error=form.error||App.Error}var doAutoScroll,triggerValueChange;return Control.prototype.fieldModel=null,Control.prototype.fieldView=null,Control.prototype.$index=null,Control.prototype.$question=null,Control.prototype.model=null,Control.prototype.isActive=!1,Control.prototype.isVisible=null,Control.prototype.id=null,Control.prototype.type=null,Control.prototype.parent=null,Control.prototype.description=null,Control.prototype.$elem=null,Control.prototype.value=null,Control.prototype.pipeValue="",Control.prototype.isCompleted=!1,Control.prototype.required=!1,Control.prototype.done=!1,Control.prototype.confirmText="default",Control.prototype.attachLimit=null,Control.prototype.getFieldModel=function(){return this.fieldModel},Control.prototype.attachPropertiesForUseInLegacy=function(){this.$elem=this.$el,this.model=this.fieldModel,this.id=this.fieldModel.get("id"),this.type=this.fieldModel.get("type"),this.parent=this.$el.siblings("#"+this.$el.data("parent")).data("control"),this.description=this.fieldModel.get("description"),this.attachLimit=minFieldHeight[this.type]},Control.prototype.onChange=function(model,value){this.value=value,this.error.hide(this.$el),this.setPipeValue(),this.isCompleted=null!=this.value,triggerValueChange.call(this),typeform.Form.check(),doAutoScroll.call(this),"fallback"===this.browser&&this.setFocus()},Control.prototype.init=function(){},Control.prototype.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&this.$index.html(value)},Control.prototype.bindEvents=function(){this.fieldView.bindEvents()},Control.prototype.unbindEvents=function(){this.fieldView.unbindEvents()},Control.prototype.open=function(){var _base;return"function"==typeof(_base=this.fieldView).open&&_base.open(),this.done=!0},Control.prototype.advanceArrow=function(direction){return this.fieldView.onArrowKeyPress(direction)},Control.prototype.checkEnter=function(){return this.fieldView.onEnterKeyPress()},Control.prototype.preSelectFirst=function(){return!1},Control.prototype.preSelectLast=function(){return!1},Control.prototype.setValue=function(callback){return callback&&callback(),this},Control.prototype.setPipeValue=function(){return this.pipeValue=this.fieldModel.get("pipeValue"),this},Control.prototype.validate=function(onSuccess,showErrorMessage,globalFormSubmit){var isValid;return null==showErrorMessage&&(showErrorMessage=!0),isValid=this.fieldModel.validate(null,showErrorMessage,globalFormSubmit),isValid&&"function"==typeof onSuccess&&onSuccess(),isValid},Control.prototype.checkError=function(model,errorKey){return this.error.hide(this.$el),_.isEmpty(errorKey)||this.error.show(this.$el,App.Texts[errorKey]),this},Control.prototype.resize=function(){},Control.prototype.update=function(obj){this.fieldModel.set(obj)},Control.prototype.renderQuestion=function(){var question;question=this.fieldModel.get("question"),this.$question.html(question),_.isEmpty(question)?this.$el.hide():this.$el.show()},Control.prototype.setFocus=function(enable,animate){if(null==enable&&(enable=!0),null==animate&&(animate=!1),enable){if(this.$el.hasClass("focus"))return;typeform.Form.unsetFocus(),this.$el.addClass("focus"),animate&&$("html, body").scrollTop(this.$el.offset().top)}else this.$el.removeClass("focus")},Control.prototype.markValidationError=function(){return this.$elem.find(".confirm > .button").addClass("red")},triggerValueChange=function(){return null!=this.value?this.$el.trigger("change-value",this):void 0},doAutoScroll=function(){return null!=this.value&&this.model.get("useAutoscroll")?"function"==typeof form.autoNext?form.autoNext(!0):void 0:void 0},Control}(),namespace("App",function(exports){return exports.Control=Control})}.call(this),function(){var Sanitize,sanitize,template;sanitize=function(value){var quotedString;return _.isString(value)?(quotedString=JSON.stringify(value),quotedString.substring(1,quotedString.length-1)):value},template=function(template,value){return template.replace("<%=a%>",sanitize(value))},Sanitize={sanitize:sanitize,template:template},namespace("App",function(exports){return exports.Sanitize=Sanitize})}.call(this),function(){var OpinionScaleModel,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};OpinionScaleModel=function(_super){function OpinionScaleModel(){return this.setValue=__bind(this.setValue,this),_ref=OpinionScaleModel.__super__.constructor.apply(this,arguments)}return __extends(OpinionScaleModel,_super),OpinionScaleModel.prototype.defaults={type:"opinion-scale",maxValue:0,negativeLabel:"",neutralLabel:"",positiveLabel:"",value:null,pipeValue:"",required:!1,startAtOne:!1,error:"",useAutoscroll:!0},OpinionScaleModel.prototype.choicesCollection=null,OpinionScaleModel.prototype.resetError=function(){this.set("error","")},OpinionScaleModel.prototype.initialize=function(){return this.choicesCollection=new App.components.ChoicesCollection(this.createChoicesFromSteps(),{startAtOne:this.attributes.startAtOne}),this.on("change:maxValue change:startAtOne",this.updateChoicesCollection),this.on("change:negativeLabel change:neutralLabel change:positiveLabel",this.updateConnectors),this.on("change:value",this.setPipeValue),this.listenTo(this.choicesCollection,"change:checked",this.setValue,this),this.updateConnectors(),this},OpinionScaleModel.prototype.updateConnectors=function(){return this.choicesCollection.showNegativeConnector(!_.isEmpty(this.attributes.negativeLabel)),this.choicesCollection.showNeutralConnector(!_.isEmpty(this.attributes.neutralLabel)),this.choicesCollection.showPositiveConnector(!_.isEmpty(this.attributes.positiveLabel)),this},OpinionScaleModel.prototype.getValidationError=function(){return this.attributes.required&&_.isNull(this.attributes.value)?"must-select":""},OpinionScaleModel.prototype.validate=function(){var error;return error=this.getValidationError(),this.set("error",error),_.isEmpty(error)},OpinionScaleModel.prototype.updateChoicesCollection=function(){return this.choicesCollection.set(this.createChoicesFromSteps()),this.choicesCollection.setStartAtOne(this.attributes.startAtOne),this.updateConnectors(),this},OpinionScaleModel.prototype.setValue=function(model){return this.resetError(),model.get("checked")?this.set("value",model.get("value")):this.set("value",null),this},OpinionScaleModel.prototype.hasLabels=function(){var labels;return labels=this.getLabelsToDisplay(),!(_.isEmpty(labels.negativeLabel)&&_.isEmpty(labels.neutralLabel)&&_.isEmpty(labels.positiveLabel))},OpinionScaleModel.prototype.getLabelsToDisplay=function(){return{negativeLabel:this.attributes.negativeLabel,neutralLabel:this.isOdd(this.attributes.maxValue)?this.attributes.neutralLabel:"",positiveLabel:this.attributes.positiveLabel}},OpinionScaleModel.prototype.isOdd=function(num){return num%2===1},OpinionScaleModel.prototype.getChoicesCollection=function(){return this.choicesCollection},OpinionScaleModel.prototype.createChoicesFromSteps=function(){var i,num,stepsCollection;for(stepsCollection=[],i=0;i<this.attributes.maxValue;)num=this.getNumberToDisplay(i),stepsCollection.push({label:num.toString(),value:num}),i++;return stepsCollection},OpinionScaleModel.prototype.getNumberToDisplay=function(index){return this.attributes.startAtOne?index+1:index},OpinionScaleModel.prototype.setResponses=function(levels){return this.choicesCollection.setResponses(levels),this},OpinionScaleModel.prototype.getAverageResponses=function(){return this.choicesCollection.getAverageResponses()},OpinionScaleModel.prototype.setPipeValue=function(){var pipeValue,_ref1;return pipeValue=null!=(_ref1=this.attributes.value)?_ref1.toString():void 0,this.set("pipeValue",pipeValue),pipeValue},OpinionScaleModel}(Backbone.Model),namespace("App.models",function(exports){return exports.OpinionScaleModel=OpinionScaleModel})}.call(this),function(){var OpinionScaleFactory,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};OpinionScaleFactory=function(){function OpinionScaleFactory(browser){this.browser=browser,this.createChoiceView=__bind(this.createChoiceView,this)}return OpinionScaleFactory.prototype.browser=null,OpinionScaleFactory.prototype.useKeyboard=function(){return"default"===this.browser},OpinionScaleFactory.prototype.build=function(fieldData){var choicesView,fieldModel,fieldView,template,_base;return fieldModel=new App.models.OpinionScaleModel(fieldData),choicesView=new App.components.ChoicesView({className:"layout-columns",collection:fieldModel.getChoicesCollection(),createChoiceView:this.createChoiceView,keyboard:this.useKeyboard()?"function"==typeof(_base=App.Service).Keyboard?new _base.Keyboard:void 0:null,browser:this.browser}),template=$.trim($("#component-opinion-scale").html()),fieldView=new App.components.OpinionScaleView(choicesView,fieldModel,template)},OpinionScaleFactory.prototype.createChoiceView=function(choiceModel,positionClass){var choiceView;return null==positionClass&&(positionClass=""),choiceView=new App.components.ChoiceView(_.extend({model:choiceModel},this.getChoicePropertiesByBrowser(positionClass)))},OpinionScaleFactory.prototype.getChoicePropertiesByBrowser=function(positionClass){return"fallback"===this.browser?{className:"choice color-secondary text-align-center text-size-s",template:$("#component-choice-simple").html(),onRender:function(){},onCheck:function(){}}:{className:"choice choice-square style-transparent-choice without-padding text-size-xl text-antialiased "+positionClass,template:$("#component-choice-square").html(),onRender:App.Utils.setStepClassByLightness,onCheck:App.Utils.selectEffect}},OpinionScaleFactory}(),namespace("App.factories",function(exports){return exports.OpinionScaleFactory=OpinionScaleFactory})}.call(this),function(){var OpinionScaleView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};OpinionScaleView=function(_super){function OpinionScaleView(choicesView,fieldModel,template){this.choicesView=choicesView,this.fieldModel=fieldModel,this.template=template,this.listenTo(this.fieldModel,"change:positiveLabel change:neutralLabel change:negativeLabel change:maxValue",this.renderLabels,this),Backbone.View.apply(this,[])}return __extends(OpinionScaleView,_super),OpinionScaleView.prototype.choicesView=null,OpinionScaleView.prototype.fieldModel=null,OpinionScaleView.prototype.template="",OpinionScaleView.prototype.$choices=null,OpinionScaleView.prototype.$labels=null,OpinionScaleView.prototype.getFieldModel=function(){return this.fieldModel
},OpinionScaleView.prototype.initialize=function(){return this.$el.html(this.template),null==this.$choices&&(this.$choices=this.$el.find(".component-choices")),null==this.$labels&&(this.$labels=this.$el.find(".labels")),this},OpinionScaleView.prototype.bindEvents=function(){return this.choicesView.bindEvents(),this},OpinionScaleView.prototype.unbindEvents=function(){return this.choicesView.unbindEvents(),this},OpinionScaleView.prototype.onArrowKeyPress=function(direction){return this.choicesView.onArrowKeyPress(direction)},OpinionScaleView.prototype.onEnterKeyPress=function(){return this.choicesView.onEnterKeyPress()},OpinionScaleView.prototype.render=function(){return this.renderChoices(),this.renderLabels(),this},OpinionScaleView.prototype.renderChoices=function(){return this.$choices.html(this.choicesView.render().$el),this},OpinionScaleView.prototype.renderLabels=function(){return this.showLabels(),this.renderLabelsToDisplay(),this},OpinionScaleView.prototype.showLabels=function(){return this.fieldModel.hasLabels()?this.$labels.show():this.$labels.hide(),this},OpinionScaleView.prototype.renderLabelsToDisplay=function(){var data,label,_i,_len,_ref;for(data=this.fieldModel.getLabelsToDisplay(),_ref=["negativeLabel","neutralLabel","positiveLabel"],_i=0,_len=_ref.length;_len>_i;_i++)label=_ref[_i],this.renderLabel(label,data);return this},OpinionScaleView.prototype.renderLabel=function(label,data){var _name;return null==this[_name="$"+label]&&(this[_name]=this.$el.find("."+label)),this["$"+label].html(data[label]),this},OpinionScaleView}(Backbone.View),namespace("App.components",function(exports){return exports.OpinionScaleView=OpinionScaleView})}.call(this),function(){var FileUploadModel,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};FileUploadModel=function(_super){function FileUploadModel(){return _ref=FileUploadModel.__super__.constructor.apply(this,arguments)}var STATUS;return __extends(FileUploadModel,_super),STATUS={DEFAULT:"default",UPLOADING:"uploading",SUCCESS:"success"},FileUploadModel.prototype.defaults={id:null,fileName:"",fileSize:null,fileType:null,progress:0,maxSize:10485760,status:STATUS.DEFAULT,value:null,pipeValue:"",calculatorValue:!1,logicValue:!1,required:!1,token:"",error:"",useAutoscroll:!1},FileUploadModel.prototype.initialize=function(){return this.on("change:status",this.setValue),this.on("change:fileName",this.setLogicValue),this.on("change:fileName",this.setPipeValue),this.on("change:fileName",this.setCalculatorValue),this},FileUploadModel.prototype.resetError=function(){this.set("error","")},FileUploadModel.prototype.setValue=function(){this.attributes.status===STATUS.SUCCESS?this.set("value",this.generateUploadedFilename()):this.set("value",null)},FileUploadModel.prototype.generateUploadedFilename=function(){return this.attributes.token+"-"+this.attributes.fileName},FileUploadModel.prototype.getValidationError=function(globalFormSubmit){if(globalFormSubmit){if(this.attributes.status===STATUS.UPLOADING)return"file-upload-processing";if(this.attributes.required&&_.isNull(this.attributes.value))return"file-upload-must-upload"}return this.attributes.required&&_.isNull(this.attributes.value)&&this.attributes.status===STATUS.DEFAULT?"file-upload-must-upload":""},FileUploadModel.prototype.validate=function(callback,showError,globalFormSubmit){var error;return this.resetError(),error=this.getValidationError(globalFormSubmit),this.set("error",error),_.isEmpty(error)},FileUploadModel.prototype.checkFileSize=function(){var error;return error="",this.attributes.fileSize>this.attributes.maxSize&&(error="file-upload-sizeLimit"),this.set("error",error),""===error},FileUploadModel.prototype.setStatusDefault=function(){this.set({status:STATUS.DEFAULT,fileName:"",progress:0,value:null})},FileUploadModel.prototype.setStatusProgress=function(){this.set("status",STATUS.UPLOADING)},FileUploadModel.prototype.setStatusSuccess=function(obj){this.set({status:STATUS.SUCCESS,token:obj.token,error:""})},FileUploadModel.prototype.setStatusError=function(){this.set({status:STATUS.DEFAULT,fileName:"",progress:0,error:"file-upload-upload-error"})},FileUploadModel.prototype.getMaxSizeInMB=function(){return this.attributes.maxSize/1048576},FileUploadModel.prototype.isImage=function(){var validTypes;return validTypes=["image/png","image/gif","image/jpeg","image/svg+xml"],null!=this.attributes.fileType&&_.contains(validTypes,this.attributes.fileType)},FileUploadModel.prototype.setPipeValue=function(){var pipeValue;return pipeValue=this.attributes.fileName||"",this.set("pipeValue",pipeValue),pipeValue},FileUploadModel.prototype.setCalculatorValue=function(){var ready;return ready=!_.isEmpty(this.attributes.fileName),this.set("calculatorValue",ready),ready},FileUploadModel.prototype.setLogicValue=function(){var ready;return ready=!_.isEmpty(this.attributes.fileName),this.set("logicValue",ready),ready},FileUploadModel}(Backbone.Model),namespace("App.models",function(exports){return exports.FileUploadModel=FileUploadModel})}.call(this),function(){var FileUploadView,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};FileUploadView=function(_super){function FileUploadView(){return _ref=FileUploadView.__super__.constructor.apply(this,arguments)}var STATUS;return __extends(FileUploadView,_super),FileUploadView.prototype.model=null,FileUploadView.prototype.s3Uploader=null,FileUploadView.prototype.translations={choose:"",uploading:"",sizeLimit:""},FileUploadView.prototype.isPreview=!1,FileUploadView.prototype.templates={el:""},FileUploadView.prototype.$text=null,FileUploadView.prototype.$file=null,STATUS={DEFAULT:"default",UPLOADING:"uploading",SUCCESS:"success"},FileUploadView.prototype.events={"change input":"onFileChange"},FileUploadView.prototype.initialize=function(options){return this.isPreview=options.isPreview,this.templates=_.extend({},this.templates,options.templates),this.translations=_.extend({},this.translations,options.translations),this.s3Uploader=options.s3Uploader,this.requestCredentials(),this.model.on("change:status",this.render,this),this.$el.html(this.templates.el()),this.$text=this.$el.find(".box-text"),this.customInitialize(options),this.$file=this.$el.find("input"),this.setMultiple(options.multiple),this},FileUploadView.prototype.requestCredentials=function(){return this.isPreview||this.s3Uploader.requestCredentials(),this},FileUploadView.prototype.customInitialize=function(){return this.colorSettings=this.options.colorSettings,this.model.on("change:progress",this.updateProgressBar,this),this.$progressBar=$(this.templates.progressBar()),this.$progressBarTarget=this.$el.find(".progress-bar-target")},FileUploadView.prototype.updateProgressBar=function(model,progress){null==this.$bar&&(this.$bar=this.$progressBar.children(".bar")),this.$bar.css("width",""+progress+"%")},FileUploadView.prototype.customInitializeElements=function(){},FileUploadView.prototype.setMultiple=function(multiple){return multiple&&this.$file.attr("multiple","multiple"),this},FileUploadView.prototype.render=function(){var maxSize,sizeLimitText,status;return status=this.model.get("status"),status===STATUS.DEFAULT?(sizeLimitText=this.translations.sizeLimit,maxSize=this.model.getMaxSizeInMB(),this.$text.html(""+sizeLimitText+": "+maxSize+" MB"),this.hideProgress()):status===STATUS.UPLOADING?this.showProgress():status===STATUS.SUCCESS&&(this.hideProgress(),this.$text.empty()),this},FileUploadView.prototype.getFieldModel=function(){return this.model},FileUploadView.prototype.escapeFilename=function(filename){return filename.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/\s]/g,"_")},FileUploadView.prototype.getFileInfo=function(target){var data,file,files,fullPath;return data={},files=target.files,files?(file=files[0],data.fileName=this.escapeFilename(this.getFileName(file.name)),data.fileSize=file.size,data.fileType=file.type):(fullPath=target.value,data.fileName=this.escapeFilename(this.getFileNameIE(fullPath))),data},FileUploadView.prototype.getFileData=function(target){var files;return files=target.files,files?files[0]:void 0},FileUploadView.prototype.getFileNameIE=function(fullPath){return fullPath.replace(/^.*[\\\/]/,"")},FileUploadView.prototype.getFileName=function(fullPath){return fullPath.replace(/[\uD800-\uF8FF]/g,"x").replace(/[\\\/]/,"")},FileUploadView.prototype.onFileChange=function(evt){var fileData,fileInfo;return fileInfo=this.getFileInfo(evt.target),this.model.set(fileInfo),this.model.resetError(),this.model.checkFileSize()?(fileData=this.getFileData(evt.target),this.upload(fileData,this.$file,fileInfo),this.generatePreview(fileData)):this.model.setStatusDefault(),this},FileUploadView.prototype.upload=function(fileData,$file,fileInfo){this.isPreview?this.model.setStatusSuccess(fileInfo.fileName):(this.model.setStatusProgress(),this.s3Uploader.upload(fileData,$file,fileInfo))},FileUploadView.prototype.generatePreview=function(){},FileUploadView.prototype.showProgress=function(){return this.$progressBarTarget.empty(),this.s3Uploader.canContinuouslyUpdateProgress()?this.$progressBarTarget.html(this.$progressBar):new Spinner({color:this.colorSettings.primary,top:"30%"}).spin(this.$progressBarTarget[0])},FileUploadView.prototype.hideProgress=function(){return this.$progressBarTarget.empty()},FileUploadView}(Backbone.View),namespace("App.components",function(exports){return exports.FileUploadView=FileUploadView})}.call(this),function(){var RichFileUploadView,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};RichFileUploadView=function(_super){function RichFileUploadView(){return this.onLoadFileImage=__bind(this.onLoadFileImage,this),_ref=RichFileUploadView.__super__.constructor.apply(this,arguments)}var STATUS;return __extends(RichFileUploadView,_super),RichFileUploadView.prototype.fileReader=null,RichFileUploadView.prototype.templates={el:"",cloudIcon:"",fileIcon:"",textStart:"",textUploading:"",textPreview:""},RichFileUploadView.prototype.confirmButtonView=null,RichFileUploadView.prototype.$file=null,RichFileUploadView.prototype.$content=null,RichFileUploadView.prototype.$cancel=null,RichFileUploadView.prototype.$preview=null,RichFileUploadView.prototype.$cloudIcon=null,RichFileUploadView.prototype.$fileIcon=null,RichFileUploadView.prototype.$progressBar=null,RichFileUploadView.prototype.onRender=function(){},RichFileUploadView.prototype.onError=function(){},STATUS={DEFAULT:"default",UPLOADING:"uploading",SUCCESS:"success"},RichFileUploadView.prototype.events={"change input":"onFileChange","dragover input":"onDragover","dragleave input":"onDragleave","click .box-cancel":"onCancel"},RichFileUploadView.prototype.customInitialize=function(options){return RichFileUploadView.__super__.customInitialize.apply(this,arguments),this.fileReader=options.fileReader,this.onRender=options.onRender,this.confirmButtonView=options.confirmButtonView,this.fileReader&&(this.fileReader.onload=this.onLoadFileImage),this.$cancel=this.$el.find(".box-cancel"),this.$image=this.$el.find(".box-image"),this.$progressBarTarget=this.$el.find(".box-image"),this.$preview=$("<img/>"),this.$cloudIcon=$(this.templates.cloudIcon()),this.$fileIcon=$(this.templates.fileIcon()),this.renderConfirmButton(),this},RichFileUploadView.prototype.open=function(){return this.checkConfirmButtonVisibility(this.model.get("status")),this},RichFileUploadView.prototype.render=function(){var status;return status=this.model.get("status"),this.resetFile(status),this.switchStatusClass(status),this.checkInputVisibility(status),this.checkCloseIconVisibility(status),this.checkConfirmButtonVisibility(status),this.renderText(status),this.renderContent(status),this.onRender(this.$el),this},RichFileUploadView.prototype.resetFile=function(status){var $clone;return status===STATUS.DEFAULT&&($clone=this.$file.clone(),this.$file.replaceWith($clone),this.$file=$clone),this},RichFileUploadView.prototype.switchStatusClass=function(){return this.$el.alterClass("status-*","status-"+this.model.attributes.status),this},RichFileUploadView.prototype.getTextKey=function(status){switch(status){case STATUS.DEFAULT:return"textStart";case STATUS.UPLOADING:return"textUploading";case STATUS.SUCCESS:return"textPreview"}},RichFileUploadView.prototype.renderText=function(status){var text;return text=this.templates[this.getTextKey(status)]({fileName:this.model.get("fileName"),maxFileSize:this.model.getMaxSizeInMB(),textChoose:this.translations.choose,textUploading:this.translations.uploading,textSizeLimit:this.translations.sizeLimit}),this.$text.html(text),this},RichFileUploadView.prototype.renderContent=function(status){return status===STATUS.DEFAULT?(this.hideProgress(),this.$image.html(this.$cloudIcon)):status===STATUS.UPLOADING?this.showProgress():status===STATUS.SUCCESS&&(this.hideProgress(),this.$image.html(this.getPreview())),this},RichFileUploadView.prototype.renderConfirmButton=function(){return null!=this.confirmButtonView&&this.$el.append(this.confirmButtonView.render().$el),this},RichFileUploadView.prototype.onCancel=function(){return this.model.resetError(),this.s3Uploader.abort(),this.model.setStatusDefault(),this},RichFileUploadView.prototype.getPreview=function(){return this.model.isImage()?this.$preview:this.$fileIcon},RichFileUploadView.prototype.generatePreview=function(file){return this.fileReader?(this.model.isImage()&&this.fileReader.readAsDataURL(file),this):!1},RichFileUploadView.prototype.onLoadFileImage=function(evt){this.$preview.attr({src:_.clone(evt.target.result),title:this.model.get("fileName")})},RichFileUploadView.prototype.checkInputVisibility=function(status){return status===STATUS.DEFAULT?this.$file.show():this.$file.hide(),this},RichFileUploadView.prototype.checkCloseIconVisibility=function(status){return status===STATUS.DEFAULT?this.$cancel.hide():this.$cancel.show(),this},RichFileUploadView.prototype.checkConfirmButtonVisibility=function(status){var show,_ref1;return show=status===STATUS.SUCCESS,"function"==typeof form.checkConfirm&&form.checkConfirm(show,null!=(_ref1=this.confirmButtonView)?_ref1.$el:void 0,this.$el,this.model.get("id")),this},RichFileUploadView.prototype.bindEvents=function(){return this},RichFileUploadView.prototype.unbindEvents=function(){return this},RichFileUploadView.prototype.onArrowKeyPress=function(){return!0},RichFileUploadView.prototype.onEnterKeyPress=function(){var status;return status=this.model.get("status"),status===STATUS.DEFAULT?(this.$file.click(),!1):!0},RichFileUploadView.prototype.onDragover=function(){return this.$el.addClass("pre-selected"),this},RichFileUploadView.prototype.onDragleave=function(){return this.$el.removeClass("pre-selected"),this},RichFileUploadView}(App.components.FileUploadView),namespace("App.components",function(exports){return exports.RichFileUploadView=RichFileUploadView})}.call(this),function(){var FileUploadFactory;FileUploadFactory=function(){function FileUploadFactory(browser,featureDetector,colorSettings){this.browser=browser,this.featureDetector=featureDetector,this.colorSettings=colorSettings}return FileUploadFactory.prototype.browser=null,FileUploadFactory.prototype.featureDetector=null,FileUploadFactory.prototype.build=function(fieldData){var fieldModel,fieldView,s3Uploader;return fieldModel=new App.models.FileUploadModel(fieldData),s3Uploader=new App.Service.S3Uploader(fieldModel.get("id"),this.featureDetector,{requestCredentialsBaseUrl:"/app/form/field/uploadCredentials/",onUploadProgress:function(progress){return fieldModel.set("progress",progress)},onSuccess:function(response){return fieldModel.setStatusSuccess(response)},onError:function(){return fieldModel.setStatusError()},onAbort:function(){return fieldModel.setStatusDefault()}}),fieldView=this.createFieldView(fieldModel,s3Uploader)},FileUploadFactory.prototype.generateChooseText=function(){var text;return text=App.Texts["file-upload-choose"],this.featureDetector.fileDragAndDrop()&&(text+=App.Texts["file-upload-drag"]),text},FileUploadFactory.prototype.getTemplate=function(selector){return _.template($.trim($(selector).html()))},FileUploadFactory.prototype.createFieldView=function(fieldModel,s3Uploader){return"fallback"===this.browser?this.createFallbackFieldView(fieldModel,s3Uploader):this.createRichFieldView(fieldModel,s3Uploader)},FileUploadFactory.prototype.getViewOptions=function(fieldModel,s3Uploader){return{model:fieldModel,s3Uploader:s3Uploader,colorSettings:this.colorSettings,multiple:this.featureDetector.uploadUsingMultiple(),translations:{choose:this.generateChooseText(),uploading:App.Texts["file-upload-uploading"],sizeLimit:App.Texts["file-upload-maxSize"]}}},FileUploadFactory.prototype.createRichFieldView=function(fieldModel,s3Uploader){var fileReader,options;return window.FileReader&&(fileReader=new FileReader),options=_.extend({},this.getViewOptions(fieldModel,s3Uploader),{fileReader:fileReader,confirmButtonView:this.createConfirmButton(),className:"file-upload-box container",onRender:App.Utils.setStepClassByLightness,isPreview:"field"===Globals.parent,templates:{el:this.getTemplate("#component-file-upload-box"),cloudIcon:this.getTemplate("#icon-cloud"),fileIcon:this.getTemplate("#icon-file"),progressBar:this.getTemplate("#component-file-upload-progress-bar"),textStart:this.getTemplate("#component-file-upload-text-start"),textUploading:this.getTemplate("#component-file-upload-text-uploading"),textPreview:this.getTemplate("#component-file-upload-text-preview")}}),new App.components.RichFileUploadView(options)},FileUploadFactory.prototype.createFallbackFieldView=function(fieldModel,s3Uploader){var options;return options=_.extend({},this.getViewOptions(fieldModel,s3Uploader),{className:"file-upload-box-simple",templates:{el:this.getTemplate("#component-file-upload-box-simple"),progressBar:this.getTemplate("#component-file-upload-progress-bar")}}),new App.components.FileUploadView(options)},FileUploadFactory.prototype.createConfirmButton=function(){return"default"===this.browser?new App.components.ConfirmButtonView({template:this.getTemplate("#component-confirm-button"),className:"confirm container",buttonView:new App.components.ButtonView({model:new App.components.ButtonModel({label:"<span>"+App.Texts["tab-button"]+'</span><span class="confirm"></span>',extra:"",type:"nav",icon:"tick"})}),onRender:App.Utils.setStepClassByLightness}):null},FileUploadFactory}(),namespace("App.factories",function(exports){return exports.FileUploadFactory=FileUploadFactory})}.call(this),function(){var ChoiceModel,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ChoiceModel=function(_super){function ChoiceModel(){return _ref=ChoiceModel.__super__.constructor.apply(this,arguments)}return __extends(ChoiceModel,_super),ChoiceModel.prototype.defaults={label:"",value:null,checked:!1,preselected:!1,showLineConnector:!1,percentResponses:null,responses:0},ChoiceModel.prototype.initialize=function(){return this.on("change:checked",this.onChangeChecked),this},ChoiceModel.prototype.onChangeChecked=function(){return this.attributes.checked&&this.set("preselected",!0),this},ChoiceModel.prototype.toogle=function(){return this.set("checked",!this.attributes.checked),this},ChoiceModel}(Backbone.Model),namespace("App.components",function(exports){return exports.ChoiceModel=ChoiceModel})}.call(this),function(){var ChoiceView,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ChoiceView=function(_super){function ChoiceView(){return _ref=ChoiceView.__super__.constructor.apply(this,arguments)}return __extends(ChoiceView,_super),ChoiceView.prototype.tagName="li",ChoiceView.prototype.template="",ChoiceView.prototype.model=null,ChoiceView.prototype.className="choice container",ChoiceView.prototype.onRender=function(){},ChoiceView.prototype.onCheck=function(){},ChoiceView.prototype.responsesLevelTemplate='<div class="level"></div>',ChoiceView.prototype.initialize=function(options){return this.template=_.template(options.template),this.onRender=options.onRender,this.onCheck=options.onCheck,this.listenTo(this.model,"change:checked",this.setCheckedClass,this),this.listenTo(this.model,"change:preselected",this.setPreSelectedClass,this),this.listenTo(this.model,"change:showLineConnector",this.setConnectorClass,this),this.listenTo(this.model,"change:percentResponses",this.renderResponsesLevel,this),this},ChoiceView.prototype.serializeData=function(){var data;return data=this.model.toJSON(),data.checked=this.model.get("checked")?"checked":"",data},ChoiceView.prototype.render=function(){return this.setCheckedClass(),this.setConnectorClass(),this.$el.html(this.template(this.serializeData())),this.renderResponsesLevel(),this.onRender(this.$el),this},ChoiceView.prototype.setConnectorClass=function(){this.setClassForAttr("showLineConnector")},ChoiceView.prototype.setCheckedClass=function(){return this.setClassForAttr("checked"),this.model.get("checked")&&this.onCheck(this.$el),this.$el.find("input").prop("checked",this.model.get("checked")),this},ChoiceView.prototype.setPreSelectedClass=function(){return this.setClassForAttr("preselected"),this},ChoiceView.prototype.setClassForAttr=function(attribute){return this.model.get(attribute)?this.$el.addClass(attribute):this.$el.removeClass(attribute),this},ChoiceView.prototype.renderResponsesLevel=function(){var $percentResponses,percentResponses;return percentResponses=this.model.get("percentResponses"),null!=percentResponses?($percentResponses=$(this.responsesLevelTemplate),$percentResponses.css("height",percentResponses+"%"),this.$el.append($percentResponses),this):void 0},ChoiceView}(Backbone.View),namespace("App.components",function(exports){return exports.ChoiceView=ChoiceView})}.call(this),function(){var ChoicesCollection,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ChoicesCollection=function(_super){function ChoicesCollection(){return _ref=ChoicesCollection.__super__.constructor.apply(this,arguments)}return __extends(ChoicesCollection,_super),ChoicesCollection.prototype.model=App.components.ChoiceModel,ChoicesCollection.prototype.options=null,ChoicesCollection.prototype.defaults={startAtOne:!0},ChoicesCollection.prototype.initialize=function(data,options){return this.options=_.extend({},this.defaults,options),this.on("change:checked",this.onCheck,this),this},ChoicesCollection.prototype.showNegativeConnector=function(show){return this.setShowLineConnector(this.first(),show),this},ChoicesCollection.prototype.showNeutralConnector=function(show){var model;return model=this.getCentralChoice(),this.setShowLineConnector(model,show),this},ChoicesCollection.prototype.getCentralChoice=function(){return this.isOdd(this.length)?this.at(Math.floor(this.length/2)):void 0},ChoicesCollection.prototype.isOdd=function(num){return num%2===1},ChoicesCollection.prototype.showPositiveConnector=function(show){return this.setShowLineConnector(this.last(),show),this},ChoicesCollection.prototype.setShowLineConnector=function(model,show){return null!=model&&model.set("showLineConnector",show),this},ChoicesCollection.prototype.setStartAtOne=function(startAtOne){return this.options.startAtOne=startAtOne,this},ChoicesCollection.prototype.onCheck=function(checkedModel){return this.uncheckOtherModels(checkedModel),this},ChoicesCollection.prototype.uncheckOtherModels=function(checkedModel){return checkedModel.get("checked")?(this.each(function(model){return model!==checkedModel?model.set({checked:!1,preselected:!1}):void 0}),this):void 0},ChoicesCollection.prototype.selectByNumber=function(number){var index;return index=this.options.startAtOne?number-1:number,this.selectByIndex(index),this},ChoicesCollection.prototype.selectByIndex=function(index){var _ref1;return null!=(_ref1=this.at(index))&&_ref1.toogle(),this},ChoicesCollection.prototype.getPreselectedChoice=function(){return this.findWhere({preselected:!0})},ChoicesCollection.prototype.getPreselectedChoiceIndex=function(){return this.indexOf(this.getPreselectedChoice())},ChoicesCollection.prototype.preselect=function(index){var _ref1,_ref2;return null!=(_ref1=this.getPreselectedChoice())&&_ref1.set("preselected",!1),null!=(_ref2=this.at(index))&&_ref2.set("preselected",!0),this},ChoicesCollection.prototype.removePreselect=function(index){var _ref1;return null!=(_ref1=this.at(index))&&_ref1.set("preselected",!1),!0},ChoicesCollection.prototype.preselectPrevious=function(){var index;return index=this.getPreselectedChoiceIndex(),0===index?!1:(this.preselect(index-1),this)},ChoicesCollection.prototype.preselectNext=function(){var index;return index=this.getPreselectedChoiceIndex(),index===this.length-1?!1:(this.preselect(index+1),this)},ChoicesCollection.prototype.tooglePreselected=function(){var _ref1;return null!=(_ref1=this.getPreselectedChoice())&&_ref1.toogle(),this},ChoicesCollection.prototype.containsTwoDigitsChoice=function(){return this.options.startAtOne?this.length>=10:this.length>10},ChoicesCollection.prototype.getChoiceWithLabel=function(label){return this.find(function(choiceModel){return choiceModel.get("label")===label})},ChoicesCollection.prototype.setResponses=function(choice){var _this=this;return _.each(choice,function(choice){var _ref1;return null!=(_ref1=_this.getChoiceWithLabel(choice.label))?_ref1.set(choice):void 0}),this},ChoicesCollection.prototype.getSumResponses=function(){return this.reduce(function(memo,model){return memo+model.get("responses")*model.get("value")},0)},ChoicesCollection.prototype.getTotalResponses=function(){return this.reduce(function(memo,model){return memo+model.get("responses")},0)},ChoicesCollection.prototype.getAverageResponses=function(){var average,totalResponses;return totalResponses=this.getTotalResponses(),average=totalResponses>0?this.getSumResponses()/totalResponses:0,average.toFixed(2)},ChoicesCollection}(Backbone.Collection),namespace("App.components",function(exports){return exports.ChoicesCollection=ChoicesCollection})}.call(this),function(){var ChoicesView,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ChoicesView=function(_super){function ChoicesView(){return this.renderChoice=__bind(this.renderChoice,this),this.onKeyup=__bind(this.onKeyup,this),this.onClickChoice=__bind(this.onClickChoice,this),this.onMouseleave=__bind(this.onMouseleave,this),this.onMouseover=__bind(this.onMouseover,this),_ref=ChoicesView.__super__.constructor.apply(this,arguments)}return __extends(ChoicesView,_super),ChoicesView.prototype.tagName="ul",ChoicesView.prototype.collection=null,ChoicesView.prototype.className="choices",ChoicesView.prototype.$document=null,ChoicesView.prototype.createChoiceView=null,ChoicesView.prototype.keyboard=null,ChoicesView.prototype.options=null,ChoicesView.prototype.defaults={browser:null},ChoicesView.prototype.initialize=function(options){return this.options=_.extend({},this.defaults,options),this.$document=$(document),this.createChoiceView=options.createChoiceView,this.keyboard=options.keyboard,this.listenTo(this.collection,"add remove",this.render,this),"fallback"===this.options.browser&&this.bindFallbackEvents(),this},ChoicesView.prototype.bindEvents=function(){return"default"===this.options.browser?this.bindDefaultEvents():"touch"===this.options.browser&&this.bindTouchEvents(),this},ChoicesView.prototype.bindDefaultEvents=function(){return null!=this.keyboard&&this.$document.on("keyup.choices",this.onKeyup),this.$el.on("click.choices",".choice",this.onClickChoice),this.$el.on("mouseover.choices",".choice",this.onMouseover),this.$el.on("mouseout.choices",".choice",this.onMouseleave),this},ChoicesView.prototype.bindTouchEvents=function(){return this.$el.on("touchend.choices",".choice",this.onClickChoice),this},ChoicesView.prototype.bindFallbackEvents=function(){return this.$el.on("change.choices",".choice",this.onClickChoice),this},ChoicesView.prototype.unbindEvents=function(){return this.$el.off(".choices"),this.$document.off(".choices"),this},ChoicesView.prototype.onMouseover=function(evt){var index;return index=$(evt.currentTarget).index(),this.collection.preselect(index),this},ChoicesView.prototype.onMouseleave=function(evt){var index;return index=$(evt.currentTarget).index(),this.collection.removePreselect(index),this},ChoicesView.prototype.onArrowKeyPress=function(direction){return this.keyboard.isLeftDirection(direction)?(this.collection.preselectPrevious(),!1):this.keyboard.isRightDirection(direction)?(this.collection.preselectNext(),!1):!0},ChoicesView.prototype.onEnterKeyPress=function(){return this.onConfirmPreselect()},ChoicesView.prototype.onConfirmPreselect=function(){return null!=this.collection.getPreselectedChoice()?(this.collection.tooglePreselected(),!1):!0},ChoicesView.prototype.onClickChoice=function(evt){var index;return index=$(evt.currentTarget).index(),this.collection.selectByIndex(index),this},ChoicesView.prototype.onKeyup=function(evt){return this.keyboard.isSpace(evt)?this.onConfirmPreselect():(this.checkNumberKeyup(evt),this)},ChoicesView.prototype.checkNumberKeyup=function(evt){var number;return number=this.collection.containsTwoDigitsChoice()?this.keyboard.getNumberUsingMultipleDigits(evt):this.keyboard.getNumber(evt),null!=number&&this.collection.selectByNumber(number),this},ChoicesView.prototype.render=function(){return this.$el.empty(),this.collection.forEach(this.renderChoice),this},ChoicesView.prototype.renderChoice=function(model,index){var choiceView,positionClass;return positionClass=this.getPositionClass(index),choiceView=this.createChoiceView(model,positionClass),this.appendChoiceView(choiceView.render()),this},ChoicesView.prototype.getPositionClass=function(index){return 0===index?"first":index===this.collection.length-1?"last":""},ChoicesView.prototype.appendChoiceView=function(choiceView){return this.$el.append(choiceView.$el),this},ChoicesView}(Backbone.View),namespace("App.components",function(exports){return exports.ChoicesView=ChoicesView})}.call(this),function(){var ScreenCollection;ScreenCollection=function(){function ScreenCollection(screens){this.screens=screens,this.resetActive()}return ScreenCollection.prototype.screens=null,ScreenCollection.prototype.currentActive=null,ScreenCollection.prototype.get=function(){return this.screens},ScreenCollection.prototype.hide=function(){_.each(this.screens,function(screen){return screen.hide()})},ScreenCollection.prototype.setActiveById=function(id){this.currentActive.isActive=!1,this.currentActive=_.find(this.screens,function(screen){return parseInt(screen.id,10)===id
}),this.currentActive.isActive=!0},ScreenCollection.prototype.resetActive=function(){this.currentActive=this.screens[0]},ScreenCollection.prototype.open=function(){this.currentActive.show(),this.currentActive.open()},ScreenCollection.prototype.resize=function(){_.each(this.screens,function(screen){return screen.resizeComponents()}),_.each(this.screens,function(screen){return screen.preCalculateContentHeight()}),_.each(this.screens,function(screen){return screen.resizeLayout()})},ScreenCollection.prototype.isBrandedOutroActive=function(){return this.currentActive.isDefaultBranded},ScreenCollection}(),namespace("App.components",function(exports){return exports.ScreenCollection=ScreenCollection})}.call(this),function(){var ConfirmButtonView,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ConfirmButtonView=function(_super){function ConfirmButtonView(){return _ref=ConfirmButtonView.__super__.constructor.apply(this,arguments)}return __extends(ConfirmButtonView,_super),ConfirmButtonView.prototype.template=null,ConfirmButtonView.prototype.buttonView=null,ConfirmButtonView.prototype.$buttonWrapper=null,ConfirmButtonView.prototype.$text=null,ConfirmButtonView.prototype.onRender=null,ConfirmButtonView.prototype.initialize=function(options){return this.template=options.template,this.buttonView=options.buttonView,this.onRender=options.onRender,this.$el.html(this.template()),this.$buttonWrapper=this.$el.find(".button-wrapper"),this.$text=this.$el.find(".text"),this},ConfirmButtonView.prototype.render=function(){return this.renderButton(),this.renderText(),this.onRender(this.$el),this},ConfirmButtonView.prototype.renderText=function(){return this.$text.html(App.Texts["button-tip-default"]),this},ConfirmButtonView.prototype.renderButton=function(){return this.$buttonWrapper.html(this.buttonView.render().$el),this},ConfirmButtonView}(Backbone.View),namespace("App.components",function(exports){return exports.ConfirmButtonView=ConfirmButtonView})}.call(this),function(){var Calculation,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Calculation=function(_super){function Calculation(){return _ref=Calculation.__super__.constructor.apply(this,arguments)}return __extends(Calculation,_super),Calculation.prototype.defaults={answer:null,operation:"",value:0,variable:null,applicableModification:0,currentValue:null},Calculation.prototype.operators={add:function(a){return a},subtract:function(a){return-a}},Calculation.prototype.evaluate=function(){var applicableModification;applicableModification=this.isEqual(this.attributes.currentValue,this.attributes.answer)||this.contains(this.attributes.currentValue,this.attributes.answer)?this.operators[this.attributes.operation](this.attributes.value):0,this.attributes.applicableModification=applicableModification},Calculation.prototype.isEqual=function(a,b){return _.isNull(a)||_.isNull(b)?!1:a===b||a.toString()===b.toString()},Calculation.prototype.contains=function(a,b){var choices;return _.isObject(a)?(choices=a.choices,_.isObject(choices)?this.containsForMultipleValues(choices,b):this.containsForSingleValues(choices,b)):!1},Calculation.prototype.containsForMultipleValues=function(choices,b){return _.contains(_.values(choices),b)},Calculation.prototype.containsForSingleValues=function(choices,b){return choices===b},Calculation}(Backbone.Model),namespace("App.Service.Calculator",function(exports){return exports.Calculation=Calculation})}.call(this),function(){var Calculator,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Calculator=function(_super){function Calculator(){return _ref=Calculator.__super__.constructor.apply(this,arguments)}return __extends(Calculator,_super),Calculator.prototype.defaults={fieldCalculationsCollection:[],seedValue:0,total:0},Calculator.prototype.initialize=function(){return this.evaluate()},Calculator.prototype.connect=function(controls){this.attributes.fieldCalculationsCollection.forEach(function(fieldCalculations){var control;return control=_.findWhere(controls,{id:fieldCalculations.get("fieldId")}),fieldCalculations.setControl(control)})},Calculator.prototype.hasCalculations=function(){return _.some(this.attributes.fieldCalculationsCollection.invoke("hasCalculations"))},Calculator.prototype.getValue=function(fieldId){var total;return null==fieldId&&(fieldId=null),total=this.attributes.seedValue,this.attributes.fieldCalculationsCollection.find(function(fieldCalculations){var control;return control=fieldCalculations.control,null!=control&&control.isActive&&control.isVisible&&(total+=fieldCalculations.get("applicableModification")),fieldCalculations.get("fieldId")===fieldId}),total},Calculator.prototype.evaluate=function(){this.set({total:this.getValue()})},Calculator}(Backbone.Model),namespace("App.Service.Calculator",function(exports){return exports.Calculator=Calculator})}.call(this),function(){var CalculatorFactory;CalculatorFactory=function(){function CalculatorFactory(){}return CalculatorFactory.build=function(formData){var priceCalculations,priceSeedValue,scoreCalculations;return scoreCalculations=new Backbone.Collection,priceCalculations=new Backbone.Collection,_.each(formData.fields,function(field){scoreCalculations.add(new App.Service.Calculator.FieldCalculationsCollection({fieldId:field.id,calculations:new Backbone.Collection(CalculatorFactory.filterCalculations(field.calculations,"score"),{model:App.Service.Calculator.Calculation})})),priceCalculations.add(new App.Service.Calculator.FieldCalculationsCollection({fieldId:field.id,calculations:new Backbone.Collection(CalculatorFactory.filterCalculations(field.calculations,"price"),{model:App.Service.Calculator.Calculation})}))}),priceSeedValue=CalculatorFactory.getPaymentPrice(formData.fields),{scoreCalculator:new App.Service.Calculator.Calculator({fieldCalculationsCollection:scoreCalculations,seedValue:0}),priceCalculator:new App.Service.Calculator.Calculator({fieldCalculationsCollection:priceCalculations,seedValue:priceSeedValue})}},CalculatorFactory.filterCalculations=function(calculations,variable){return _.filter(calculations,function(calculation){return calculation.variable===variable})},CalculatorFactory.getPaymentPrice=function(fields){var paymentField;return paymentField=_.find(fields,function(field){return"payment"===field.type}),null!=paymentField?paymentField.price:0},CalculatorFactory}(),namespace("App.Service.Calculator",function(exports){return exports.CalculatorFactory=CalculatorFactory})}.call(this),function(){var FieldCalculationsCollection,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};FieldCalculationsCollection=function(_super){function FieldCalculationsCollection(){return _ref=FieldCalculationsCollection.__super__.constructor.apply(this,arguments)}return __extends(FieldCalculationsCollection,_super),FieldCalculationsCollection.prototype.defaults={applicableModification:0,fieldId:null,calculations:[]},FieldCalculationsCollection.prototype.control=null,FieldCalculationsCollection.prototype.setValue=function(value){this.attributes.calculations.forEach(function(calculation){return calculation.set({currentValue:value}),calculation.evaluate()}),this.evaluate()},FieldCalculationsCollection.prototype.setControl=function(control){var fieldModel;return this.control=control,null!=this.control?("file-upload"===this.control.type?(fieldModel=this.control.getFieldModel(),this.connectOnStatusChange(fieldModel),this.setValue(fieldModel.get("calculatorValue"))):this.connectOnValueChange(),this):void 0},FieldCalculationsCollection.prototype.connectOnValueChange=function(){var _this=this;return this.control.$elem.on("change-value",function(event,control){return _this.setValue(control.value)}),this},FieldCalculationsCollection.prototype.connectOnStatusChange=function(model){var _this=this;return model.on("change:calculatorValue",function(model,value){return _this.setValue(value),typeform.Form.check()}),this},FieldCalculationsCollection.prototype.hasCalculations=function(){return this.attributes.calculations.length>0},FieldCalculationsCollection.prototype.evaluate=function(){var total;total=0,this.attributes.calculations.forEach(function(calculation){total+=calculation.get("applicableModification")}),this.set({applicableModification:total})},FieldCalculationsCollection}(Backbone.Model),namespace("App.Service.Calculator",function(exports){return exports.FieldCalculationsCollection=FieldCalculationsCollection})}.call(this),function(){var JumpsModel,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};JumpsModel=function(_super){function JumpsModel(){return _ref=JumpsModel.__super__.constructor.apply(this,arguments)}return __extends(JumpsModel,_super),JumpsModel.prototype.defaults={id:null,origin:null,destination:{id:null,type:""},evaluations:[]},JumpsModel.prototype.setControls=function(controls){var _this=this;return this.controls=controls,"true"!==this.attributes.evaluations?_.each(this.attributes.evaluations,function(evaluation){return _.isObject(evaluation)?evaluation.controls=_this.controls:void 0}):void 0},JumpsModel.prototype.evaluate=function(){var arrayToEval,_this=this;return arrayToEval=[],_.isObject(this.attributes.evaluations)?(_.each(this.attributes.evaluations,function(evaluation){return null!=evaluation.get("operator")&&arrayToEval.push(App.Sanitize.sanitize(evaluation.get("operator"))),null!=evaluation.get("condition")?arrayToEval.push(evaluation.evaluate().toString()):void 0}),eval(arrayToEval.join(" "))):!0},JumpsModel}(Backbone.Model),namespace("App.Service.LogicJumps",function(exports){return exports.JumpsModel=JumpsModel})}.call(this),function(){var JumpsData,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};JumpsData=function(_super){function JumpsData(){return _ref=JumpsData.__super__.constructor.apply(this,arguments)}return __extends(JumpsData,_super),JumpsData.prototype.getOutgoing=function(id){return null==id&&(id=!1),id?this.filter(function(jump){return jump.attributes.origin===id}):void 0},JumpsData.prototype.getWhereOriginIsHiddenFields=function(){return this.filter(function(jump){return"hidden"===jump.attributes.originType})},JumpsData.prototype.getSubmit=function(){return this.filter(function(jump){var origin;return origin=jump.toJSON().origin,"submit"===origin?jump:void 0})},JumpsData}(Backbone.Collection),namespace("App.Service.LogicJumps",function(exports){return exports.JumpsData=JumpsData})}.call(this),function(){var LogicJumpsControllerFactory;LogicJumpsControllerFactory=function(){function LogicJumpsControllerFactory(){}return LogicJumpsControllerFactory.build=function(jumps,scoreCalculator,priceCalculator,outrosCollection,hiddenFields){var jumpsData,jumpsModels,logicJumpsController;return jumpsModels=_.map(jumps,function(jump){return jump.evaluations=jump.conditions,"true"!==jump.evaluations&&(jump.evaluations=_.map(jump.conditions,function(evaluationData){return new App.Service.LogicJumps.EvaluatorFactory(evaluationData,scoreCalculator,priceCalculator,hiddenFields)})),new App.Service.LogicJumps.JumpsModel(jump)}),jumpsData=new App.Service.LogicJumps.JumpsData(jumpsModels),logicJumpsController=new App.Service.LogicJumps.LogicJumpsController(jumpsData,outrosCollection)},LogicJumpsControllerFactory}(),namespace("App.Service.LogicJumps",function(exports){return exports.LogicJumpsControllerFactory=LogicJumpsControllerFactory})}.call(this),function(){var EvaluatorFactory;EvaluatorFactory=function(){function EvaluatorFactory(evaluationData,scoreCalculator,priceCalculator,hiddenFields){return"score"===evaluationData.variable||"price"===evaluationData.variable?new App.Service.LogicJumps.CalculatorConditionEvaluator(evaluationData,{calculator:"score"===evaluationData.variable?scoreCalculator:priceCalculator}):"hidden"===evaluationData.variable?new App.Service.LogicJumps.HiddenFieldsConditionEvaluator(evaluationData,{hiddenFields:hiddenFields}):"file-upload"===evaluationData.fieldType?new App.Service.LogicJumps.FileUploadConditionEvaluator(evaluationData):new App.Service.LogicJumps.FieldConditionEvaluator(evaluationData)}return EvaluatorFactory}(),namespace("App.Service.LogicJumps",function(exports){return exports.EvaluatorFactory=EvaluatorFactory})}.call(this),function(){var LogicJumpsController,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};LogicJumpsController=function(){function LogicJumpsController(jumps,outrosCollection){this.jumps=jumps,this.outrosCollection=outrosCollection,this.getDestinationIndex=__bind(this.getDestinationIndex,this),this.jump=__bind(this.jump,this),this.processJump=__bind(this.processJump,this),this.checkForControl=__bind(this.checkForControl,this)}return LogicJumpsController.prototype.jumps=null,LogicJumpsController.prototype.controls=null,LogicJumpsController.prototype.values=[],LogicJumpsController.prototype.onBackwardJump=function(){},LogicJumpsController.prototype.setControls=function(controls){var _this=this;this.controls=controls,this.jumps.forEach(function(jump){return jump.setControls(_this.controls)})},LogicJumpsController.prototype.check=function(){var hasJumpedWithHiddenFields;this.outrosCollection.resetActive(),hasJumpedWithHiddenFields=this.checkHiddenFields(),hasJumpedWithHiddenFields||this.checkFromControlIndex(0)},LogicJumpsController.prototype.checkHiddenFields=function(){var hasJumped,jumps;return jumps=this.jumps.getWhereOriginIsHiddenFields(),hasJumped=this.processJumps(jumps)},LogicJumpsController.prototype.checkFromControlIndex=function(index){var controls;return controls=_.rest(this.controls,index),_.every(controls,this.checkForControl),!0},LogicJumpsController.prototype.checkForControl=function(control){var continueControlsLoop,hasJumped,hasJumps,jumps;return control.set("isActive",!0),jumps=this.jumps.getOutgoing(control.id),hasJumps=!_.isEmpty(jumps),hasJumped=this.processJumps(jumps),hasJumps&&!hasJumped&&this.hasJumpsAndNotJumped(control),continueControlsLoop=!hasJumps},LogicJumpsController.prototype.processJumps=function(jumps){var hasJumped;return hasJumped=!_.every(jumps,this.processJump)},LogicJumpsController.prototype.processJump=function(jump){var continueJumpsLoop;return continueJumpsLoop=!0,jump.evaluate()&&(this.jump(jump.get("origin"),jump.get("destination")),continueJumpsLoop=!1),continueJumpsLoop},LogicJumpsController.prototype.hasJumpsAndNotJumped=function(control){var index;return index=_.indexOf(this.controls,control),control.isCompleted?this.checkFromControlIndex(index+1):this.hideControls(index+1,_.size(this.controls)),!1},LogicJumpsController.prototype.getControlById=function(id){var control;return control=_.findWhere(this.controls,{id:id})},LogicJumpsController.prototype.jump=function(controlId,destination){var control,jumpFrom,jumpTo;return jumpTo=this.getDestinationIndex(destination),control=this.getControlById(controlId),jumpFrom=_.indexOf(this.controls,control),jumpFrom>jumpTo?(this.doBackwardJump(control,destination),jumpTo=_.size(this.controls)):this.checkFromControlIndex(jumpTo),this.hideControls(jumpFrom+1,jumpTo),this.activeOutro(destination),!1},LogicJumpsController.prototype.doBackwardJump=function(control,destination){var destinationControl;destinationControl=this.getControlById(destination.id),control.$elem.hasClass("focus")&&destinationControl.isActive&&this.onBackwardJump(destinationControl)},LogicJumpsController.prototype.hideControls=function(from,to){var i,_i;for(i=_i=from;to>=from?to>_i:_i>to;i=to>=from?++_i:--_i)this.controls[i].set("isActive",!1)},LogicJumpsController.prototype.getDestinationIndex=function(destination){var destinationControl,index;return"submit"===destination||"outro"===destination.type?index=_.size(this.controls):(destinationControl=_.find(this.controls,function(control){return control.id===destination.id}),index=_.indexOf(this.controls,destinationControl)),index},LogicJumpsController.prototype.activeOutro=function(destination){"submit"===destination?this.outrosCollection.setActiveById(0):"outro"===destination.type&&this.outrosCollection.setActiveById(destination.id)},LogicJumpsController.prototype.getOutgoing=function(id){return this.jumps.getOutgoing(id)},LogicJumpsController}(),namespace("App.Service.LogicJumps",function(exports){return exports.LogicJumpsController=LogicJumpsController})}.call(this),function(){var ConditionEvaluator,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ConditionEvaluator=function(_super){function ConditionEvaluator(){return _ref=ConditionEvaluator.__super__.constructor.apply(this,arguments)}return __extends(ConditionEvaluator,_super),ConditionEvaluator.prototype.defaults={condition:"",id:null,operator:null},ConditionEvaluator.prototype.controls=null,ConditionEvaluator}(Backbone.Model),namespace("App.Service.LogicJumps",function(exports){return exports.ConditionEvaluator=ConditionEvaluator})}.call(this),function(){var FieldConditionEvaluator,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};FieldConditionEvaluator=function(_super){function FieldConditionEvaluator(){return _ref=FieldConditionEvaluator.__super__.constructor.apply(this,arguments)}return __extends(FieldConditionEvaluator,_super),FieldConditionEvaluator.prototype.evaluate=function(){var collectResults,equalityOperator,fieldValue,operator,_this=this;return fieldValue=this.getFieldValue(),null==fieldValue?!1:(operator=this.getOperator(this.attributes.condition),_.isObject(fieldValue)?(collectResults=[],equalityOperator=["===","=="],_.each(fieldValue,function(value){var conditionResult;return conditionResult=eval(App.Sanitize.template(_this.attributes.condition,value)),collectResults.push(conditionResult)}),_.reduce(collectResults,function(a,b){return __indexOf.call(equalityOperator,operator)>=0?a||b:a&&b})):eval(App.Sanitize.template(this.attributes.condition,fieldValue)))},FieldConditionEvaluator.prototype.getOperator=function(condition){var operator,regex;return regex=/%>(.\D*)/,operator=condition.match(regex)[1],operator.match(/\"/g)&&(operator=operator.split('"')[1]),operator},FieldConditionEvaluator.prototype.getFieldValue=function(){var control;if(control=_.findWhere(this.controls,{id:this.attributes.field}),control.isCompleted)switch(control.type){case"list":case"list-image":return control.logicValue;case"number":return parseInt(control.value,10);case"textarea":return control.value.replace(/\n/g,"#");case"dropdown":return control.value.trim();default:return control.value}},FieldConditionEvaluator}(App.Service.LogicJumps.ConditionEvaluator),namespace("App.Service.LogicJumps",function(exports){return exports.FieldConditionEvaluator=FieldConditionEvaluator})}.call(this),function(){var FileUploadConditionEvaluator,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};FileUploadConditionEvaluator=function(_super){function FileUploadConditionEvaluator(){return _ref=FileUploadConditionEvaluator.__super__.constructor.apply(this,arguments)}return __extends(FileUploadConditionEvaluator,_super),FileUploadConditionEvaluator.prototype.getControl=function(){return _.findWhere(this.controls,{id:this.attributes.field})},FileUploadConditionEvaluator.prototype.getLogicValue=function(){return this.getControl().getFieldModel().get("logicValue")},FileUploadConditionEvaluator.prototype.evaluate=function(){return this.evaluateCondition(this.attributes.conditionName,this.getLogicValue())},FileUploadConditionEvaluator.prototype.evaluateCondition=function(condition,value){return _.isNull(value)?!1:"logic-condition-is"===condition?value===!0:"logic-condition-is-not"===condition?value===!1:void 0},FileUploadConditionEvaluator}(App.Service.LogicJumps.ConditionEvaluator),namespace("App.Service.LogicJumps",function(exports){return exports.FileUploadConditionEvaluator=FileUploadConditionEvaluator})}.call(this),function(){var CalculatorConditionEvaluator,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};CalculatorConditionEvaluator=function(_super){function CalculatorConditionEvaluator(){return _ref=CalculatorConditionEvaluator.__super__.constructor.apply(this,arguments)}return __extends(CalculatorConditionEvaluator,_super),CalculatorConditionEvaluator.prototype.calculator=null,CalculatorConditionEvaluator.prototype.initialize=function(data,options){return this.calculator=options.calculator},CalculatorConditionEvaluator.prototype.evaluate=function(){var calculatorValue,result;return calculatorValue=this.calculator.getValue(this.attributes.field),result=eval(App.Sanitize.template(this.attributes.condition,calculatorValue))},CalculatorConditionEvaluator}(App.Service.LogicJumps.ConditionEvaluator),namespace("App.Service.LogicJumps",function(exports){return exports.CalculatorConditionEvaluator=CalculatorConditionEvaluator})}.call(this),function(){var HiddenFieldsConditionEvaluator,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};HiddenFieldsConditionEvaluator=function(_super){function HiddenFieldsConditionEvaluator(){return _ref=HiddenFieldsConditionEvaluator.__super__.constructor.apply(this,arguments)}return __extends(HiddenFieldsConditionEvaluator,_super),HiddenFieldsConditionEvaluator.prototype.calculator=null,HiddenFieldsConditionEvaluator.prototype.initialize=function(data,options){return this.hiddenFields=options.hiddenFields},HiddenFieldsConditionEvaluator.prototype.evaluate=function(){var result,value;return(value=this.hiddenFields.get(this.attributes.hiddenField))?result=eval(App.Sanitize.template(this.attributes.condition,value)):!1},HiddenFieldsConditionEvaluator}(App.Service.LogicJumps.ConditionEvaluator),namespace("App.Service.LogicJumps",function(exports){return exports.HiddenFieldsConditionEvaluator=HiddenFieldsConditionEvaluator})}.call(this),function(){var HiddenFields,getParameterByName,parseUrl;HiddenFields=function(){function HiddenFields(keys,url){null==keys&&(keys={}),null==url&&(url=window.location.search),this.fields=parseUrl(keys,url)}return HiddenFields.prototype.fields={},HiddenFields.prototype.getAll=function(){return this.fields},HiddenFields.prototype.get=function(key){return this.fields[key]},HiddenFields}(),getParameterByName=function(name,searchString){var regex,results;return name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(searchString),null==results?"":decodeURIComponent(results[1])},parseUrl=function(keys,url){var key,values,_i,_len;for(values={},_i=0,_len=keys.length;_len>_i;_i++)key=keys[_i],values[key]=getParameterByName(key,url);return values},namespace("App.Service",function(exports){return exports.HiddenFields=HiddenFields})}.call(this),function(){var Keyboard;Keyboard=function(){function Keyboard(){}return Keyboard.prototype.directions={UP:0,DOWN:1,LEFT:2,RIGHT:3},Keyboard.prototype.keyCodes={key0:48,key9:57,numpad0:96,numpad9:105,space:32,enter:13},Keyboard.prototype.lastNumber=null,Keyboard.prototype.numberTimeout=null,Keyboard.prototype.numberDelay=1e3,Keyboard.prototype.getKeyCode=function(evt){var keyCode;return keyCode=document.all?evt.keyCode:evt.which},Keyboard.prototype.isSpace=function(evt){return this.getKeyCode(evt)===this.keyCodes.space},Keyboard.prototype.isEnter=function(evt){return this.getKeyCode(evt)===this.keyCodes.enter},Keyboard.prototype.getNumber=function(evt){return this.getNumberFromKeyCode(this.getKeyCode(evt))},Keyboard.prototype.getNumberUsingMultipleDigits=function(evt){var currentNumber,_this=this;return clearTimeout(this.numberTimeout),currentNumber=this.getNumberFromKeyCode(this.getKeyCode(evt)),null!=this.lastNumber&&(currentNumber=10*this.lastNumber+currentNumber),this.lastNumber=currentNumber,this.numberTimeout=_.delay(function(){return _this.lastNumber=null},this.numberDelay),currentNumber},Keyboard.prototype.getNumberFromKeyCode=function(keyCode){return keyCode>=this.keyCodes.key0&&keyCode<=this.keyCodes.key9?keyCode-this.keyCodes.key0:keyCode>=this.keyCodes.numpad0&&keyCode<=this.keyCodes.numpad9?keyCode-this.keyCodes.numpad0:void 0},Keyboard.prototype.isUpDirection=function(direction){return direction===this.directions.UP},Keyboard.prototype.isDownDirection=function(direction){return direction===this.directions.DOWN},Keyboard.prototype.isLeftDirection=function(direction){return direction===this.directions.LEFT},Keyboard.prototype.isRightDirection=function(direction){return direction===this.directions.RIGHT},Keyboard}(),namespace("App.Service",function(exports){return exports.Keyboard=Keyboard})}.call(this),function(){var S3Uploader,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};S3Uploader=function(){function S3Uploader(fieldId,featureDetector,options){this.fieldId=fieldId,this.featureDetector=featureDetector,this.onUploadAbort=__bind(this.onUploadAbort,this),this.onUploadFailed=__bind(this.onUploadFailed,this),this.onUploadComplete=__bind(this.onUploadComplete,this),this.onXhrLoad=__bind(this.onXhrLoad,this),this.onUploadProgress=__bind(this.onUploadProgress,this),this.uploadFileUsingIframe=__bind(this.uploadFileUsingIframe,this),this.uploadFileUsingXhr=__bind(this.uploadFileUsingXhr,this),this.uploadFile=__bind(this.uploadFile,this),this.onCredentialsSuccess=__bind(this.onCredentialsSuccess,this),this.options=_.extend({},this.defaults,options),this.uploadData=_.extend({},this.uploadDataDefaults)}return S3Uploader.prototype.uploadDataDefaults={AWSAccessKeyId:null,acl:null,policy:null,signature:null,key:null,file:null},S3Uploader.prototype.featureDetector=null,S3Uploader.prototype.uploadData=null,S3Uploader.prototype.folder=null,S3Uploader.prototype.token=null,S3Uploader.prototype.bucket=null,S3Uploader.prototype.uploadUrl=null,S3Uploader.prototype.fieldId=null,S3Uploader.prototype.credentialsXhr=null,S3Uploader.prototype.fileName="",S3Uploader.prototype.defaults={requestCredentialsBaseUrl:"",onUploadProgress:function(){},onSuccess:function(){},onError:function(){},onAbort:function(){}},S3Uploader.prototype.getUploadUrl=function(){return"https://"+this.bucket+".s3.amazonaws.com/"},S3Uploader.prototype.getRequestCredentialsUrl=function(){return this.options.requestCredentialsBaseUrl+this.fieldId+"?uploadStrategy="+this.getUploadStrategy()},S3Uploader.prototype.getUploadStrategy=function(){return this.featureDetector.xhrLevel2()?"xhr":"iframe"},S3Uploader.prototype.canContinuouslyUpdateProgress=function(){return"xhr"===this.getUploadStrategy()},S3Uploader.prototype.requestCredentials=function(){return this.credentialsXhr=$.ajax({url:this.getRequestCredentialsUrl()}).done(this.onCredentialsSuccess)},S3Uploader.prototype.onCredentialsSuccess=function(response){this.folder=response.folder,this.token=response.token,this.bucket=response.bucket,_.extend(this.uploadData,{AWSAccessKeyId:response.key,acl:response.acl,policy:response.policy,signature:response.signature,successActionRedirect:response.successActionRedirect})},S3Uploader.prototype.generateKey=function(fileName){return this.folder+this.token+"-"+fileName},S3Uploader.prototype.upload=function(fileData,$file,fileInfo){this.$file=$file,this.fileName=fileInfo.fileName,this.uploadData.file=fileData,this.credentialsXhr.done(this.uploadFile)},S3Uploader.prototype.uploadFile=function(){this.uploadData.key=this.generateKey(this.fileName),"xhr"===this.getUploadStrategy()?this.uploadFileUsingXhr():this.uploadFileUsingIframe()},S3Uploader.prototype.setupXhr=function(){this.uploadRequest=new window.XMLHttpRequest,this.uploadRequest.upload&&this.uploadRequest.upload.addEventListener("progress",this.onUploadProgress,!1),this.uploadRequest.addEventListener("load",this.onXhrLoad,!1),this.uploadRequest.addEventListener("abort",this.onUploadAbort,!1)},S3Uploader.prototype.uploadFileUsingXhr=function(){return this.setupXhr(),this.uploadRequest.open("POST",this.getUploadUrl(),!0),this.uploadRequest.setRequestHeader("Access-Control-Allow-Origin","*"),this.uploadRequest.send(this.convertToFormData()),this},S3Uploader.prototype.uploadFileUsingIframe=function(){var _this=this;return this.uploadRequest=$.ajax(this.getUploadUrl(),{method:"post",crossDomain:!0,data:{AWSAccessKeyId:this.uploadData.AWSAccessKeyId,acl:this.uploadData.acl,policy:this.uploadData.policy,signature:this.uploadData.signature,key:this.uploadData.key,success_action_redirect:this.uploadData.successActionRedirect},files:this.$file,iframe:!0,processData:!1}).complete(function(evt,status){return"success"===status?_this.onUploadComplete():"abort"===status?_this.onUploadAbort():void 0}),this},S3Uploader.prototype.abort=function(){this.uploadRequest&&this.uploadRequest.abort()},S3Uploader.prototype.convertToFormData=function(){var formData;return formData=new FormData,_.each(this.uploadData,function(value,key){return formData.append(key,value)}),formData},S3Uploader.prototype.onUploadProgress=function(evt){var percentLoaded;evt.lengthComputable&&(percentLoaded=this.calculatePercent(evt.loaded,evt.total),this.options.onUploadProgress(percentLoaded))},S3Uploader.prototype.calculatePercent=function(amount,total){return 0===total?100:Math.round(amount/total*100)},S3Uploader.prototype.onXhrLoad=function(){return 4===this.uploadRequest.readyState?this.uploadRequest.status>=200&&this.uploadRequest.status<300?this.onUploadComplete():this.onUploadFailed():void 0},S3Uploader.prototype.onUploadComplete=function(){this.options.onSuccess({token:this.token})},S3Uploader.prototype.onUploadFailed=function(evt){this.options.onError(evt)},S3Uploader.prototype.onUploadAbort=function(){this.options.onAbort()},S3Uploader}(),namespace("App.Service",function(exports){return exports.S3Uploader=S3Uploader
})}.call(this),function(){var SubmissionRepository=function(paths,isSubmittable){this.paths=paths,this.isSubmittable=isSubmittable};SubmissionRepository.prototype.getToken=function(){this.isSubmittable&&(this.tokenRequest=$.ajax({url:this.paths.token}),this.tokenRequest.done(_.bind(onTokenRequestResponse,this)),this.tokenRequest.fail(_.bind(onTokenRequestError,this)))},SubmissionRepository.prototype.submit=function(data,onSuccess,onError,onComplete){this.isSubmittable?$.when(this.tokenRequest).then(_.bind(submit,this,data,onSuccess,onError,onComplete)):onSuccess()};var onTokenRequestResponse=function(token){this.token=token},onTokenRequestError=function(){console&&console.error("Error while receiving token")},submit=function(data,onSuccess,onError,onComplete){var submitData=_.extend({},data,{token:this.token});$.ajax({method:"POST",url:this.paths.submit,data:{form:submitData}}).done(onSuccess).fail(onError).always(onComplete)};namespace("App",function(exports){exports.SubmissionRepository=SubmissionRepository})}(),function(){var defaults={isEnabled:!0},setFormVersionServed=function(formVersionServed){logAttribute.call(this,"typeform-version",formVersionServed)},setFont=function(font){logAttribute.call(this,"typeform-font",font.split(":")[0])},setCacheTypeServed=function(){logAttribute.call(this,"typeform-cache",this.cookies.getCacheType())},setUserAgent=function(ua){logAttribute.call(this,"typeform-ua",ua)},setFieldCountInNewRelic=function(fieldsOfType,fieldType){logAttribute.call(this,fieldType+"-count",fieldsOfType.length)},PerformanceLogger=function(newRelic,cookies,options){this.newrelic=window.newrelic||newRelic||App.Logger.dummyNewRelic,this.cookies=cookies,this.options=_.extend({},defaults,options)};PerformanceLogger.prototype.typeformLoaded=function(){logAction.call(this,"typeform-loaded")},PerformanceLogger.prototype.applyCustomAttributes=function(settings,serialisedForm,navigator){settings&&serialisedForm&&navigator&&(setFormVersionServed.call(this,settings.browser),setFont.call(this,settings.font),setUserAgent.call(this,navigator.userAgent),setCacheTypeServed.call(this),_.chain(serialisedForm.fields).groupBy("type").each(_.bind(setFieldCountInNewRelic,this)),setNumberOfChoices.call(this,"list",serialisedForm.fields),setNumberOfChoices.call(this,"list-image",serialisedForm.fields),setNumberOfAttachments.call(this,"image",serialisedForm.fields),setNumberOfAttachments.call(this,"video",serialisedForm.fields),setNumberOfScreens.call(this,"intros",serialisedForm.intros),setNumberOfScreens.call(this,"outros",serialisedForm.outros),setHasBackground.call(this,serialisedForm.design))};var setNumberOfChoices=function(type,fields){logAttribute.call(this,type+"-choices-count",getChoicesCountByType(type,fields))},setNumberOfAttachments=function(type,fields){logAttribute.call(this,"attachment-"+type+"-count",getAttachmentsCountByType(type,fields))},setNumberOfScreens=function(type,screens){logAttribute.call(this,type+"-count",screens.length)},setHasBackground=function(design){logAttribute.call(this,"has-background",!_.isEmpty(design.background))},getChoicesCountByType=function(type,fields){return _.reduce(fields,function(memo,field){return field.type===type&&(memo+=_.keys(field.choices).length),memo},0)},getAttachmentsCountByType=function(type,fields){return _.reduce(fields,function(memo,field){return field.attachment===type&&memo++,memo},0)},logAttribute=function(key,value){this.options.isEnabled&&this.newrelic.setCustomAttribute(key,value)},logAction=function(action){this.options.isEnabled&&this.newrelic.addPageAction(action)};namespace("App.Logger",function(exports){exports.PerformanceLogger=PerformanceLogger})}(),function(){var debugEnabled=!1,dummyNewRelic={addPageAction:function(action,args){debugEnabled&&console.debug&&console.debug("Custom action",action,args)},setCustomAttribute:function(attr,value){debugEnabled&&console.debug&&console.debug("Custom attribute",attr,value)}};namespace("App.Logger",function(exports){exports.dummyNewRelic=dummyNewRelic})}(),function(){var StripeService;StripeService=function(){function StripeService(Stripe,key){this.Stripe=Stripe,this.Stripe.setPublishableKey(key)}return StripeService.prototype.submit=function(details,callback,errback){return this.Stripe.card.createToken(details,function(status,response){return response.error?errback(response.error.code||"processing_error"):callback(response.id)})},StripeService}(),namespace("App.Utils",function(exports){return exports.StripeService=StripeService})}.call(this),function(){namespace("App.Utils",function(exports){exports.NullStripeService={submit:function(){}}})}(),function(){namespace("App.Utils",function(exports){exports.StripeServiceFactory={getStripeService:function(stripePublishableKey){return window.Stripe?new App.Utils.StripeService(Stripe,stripePublishableKey):App.Utils.NullStripeService}}})}(),function(){var AnswerVariable,HiddenVarible,PriceVariable,ScoreVariable,Variable,VariableFactory,getFormattedValue,_ref,_ref1,_ref2,_ref3,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};VariableFactory=function(){function VariableFactory(varname){var ret;return ret={},ret="var_price"===varname?new PriceVariable(varname):"var_score"===varname?new ScoreVariable(varname):/^answer_/.test(varname)?new AnswerVariable(varname):new HiddenVarible(varname)}return VariableFactory}(),Variable=function(){function Variable(varname){this.varname=null!=varname?varname:""}return Variable.prototype.setup=function(){},Variable}(),PriceVariable=function(_super){function PriceVariable(){return _ref=PriceVariable.__super__.constructor.apply(this,arguments)}return __extends(PriceVariable,_super),PriceVariable.prototype.setup=function(model,form,hiddenFields,scoreCalculator,priceCalculator,currencyFormatter,numberFormatter){var currency,paymentField,price,total,_this=this;paymentField=form.getPaymentField(),null!=paymentField?(currency=paymentField.getCurrency(),total=getFormattedValue(priceCalculator,numberFormatter),price=currencyFormatter.format(currency,total)):price="_____",model.set(this.varname,price),priceCalculator.on("change:total",function(){return total=getFormattedValue(priceCalculator,numberFormatter),model.set(_this.varname,currencyFormatter.format(currency,total))})},PriceVariable}(Variable),AnswerVariable=function(_super){function AnswerVariable(){return _ref1=AnswerVariable.__super__.constructor.apply(this,arguments)}return __extends(AnswerVariable,_super),AnswerVariable.prototype.setup=function(destinationModel,form){var emitter,emitterModel,fieldId;fieldId=parseInt(this.varname.split("_")[1],10),emitter=_.find(form.controls,function(control){return control.id===fieldId}),null!=emitter&&("file-upload"===emitter.type?(emitterModel=emitter.getFieldModel(),this.connectOnStatusChange(emitterModel,fieldId,destinationModel)):this.connectOnValueChange(emitter,fieldId,destinationModel),emitter.isEmitter=!0)},AnswerVariable.prototype.connectOnStatusChange=function(emitterModel,fieldId,destinationModel){return emitterModel.on("change:pipeValue",function(model,value){return destinationModel.set("answer_"+fieldId,value),typeform.Form.check()}),this},AnswerVariable.prototype.connectOnValueChange=function(emitter,fieldId,destinationModel){return emitter.$elem.on("change-value",function(event,control){return destinationModel.set("answer_"+fieldId,_.escape(control.pipeValue))}),this},AnswerVariable}(Variable),HiddenVarible=function(_super){function HiddenVarible(){return _ref2=HiddenVarible.__super__.constructor.apply(this,arguments)}return __extends(HiddenVarible,_super),HiddenVarible.prototype.setup=function(model,form,hiddenFields){var value,varnameWithoutNamespace;varnameWithoutNamespace=this.removeNamespace(this.varname),value=_.escape(hiddenFields[varnameWithoutNamespace]),("xxxxx"===value||""===value)&&(value="{{"+varnameWithoutNamespace+"}}"),model.set(this.varname,value)},HiddenVarible.prototype.removeNamespace=function(varname){return/^hidden_/.test(varname)&&(varname=varname.split("_")[1]),varname},HiddenVarible}(Variable),ScoreVariable=function(_super){function ScoreVariable(){return _ref3=ScoreVariable.__super__.constructor.apply(this,arguments)}return __extends(ScoreVariable,_super),ScoreVariable.prototype.setup=function(model,form,hiddenFields,scoreCalculator,priceCalculator,currencyFormatter,numberFormatter){var total,_this=this;total=getFormattedValue(scoreCalculator,numberFormatter),model.set(this.varname,total),scoreCalculator.on("change:total",function(){return total=getFormattedValue(scoreCalculator,numberFormatter),model.set(_this.varname,total)})},ScoreVariable}(Variable),getFormattedValue=function(calculator,numberFormatter){return numberFormatter.formatTo2Decimals(calculator.get("total"))},namespace("App.Utils",function(exports){return exports.Variable=VariableFactory,exports.PriceVariable=PriceVariable,exports.ScoreVariable=ScoreVariable,exports.AnswerVariable=AnswerVariable,exports.HiddenVarible=HiddenVarible})}.call(this),function(){var CurrencyFormatter;CurrencyFormatter=function(){function CurrencyFormatter(){}return CurrencyFormatter.prototype.currencies={EUR:"{quantity}",GBP:"{quantity}",CHF:"{quantity}&nbsp;CHF",NOK:"{quantity}&nbsp;NOK",SEK:"{quantity}&nbsp;SEK",DKK:"{quantity}&nbsp;DKK",KRW:"{quantity}",everythingElse:"${quantity}"},CurrencyFormatter.prototype.format=function(currencyCode,quantity){return(this.currencies[currencyCode]||this.currencies.everythingElse).replace("{quantity}",quantity)},CurrencyFormatter}(),namespace("App",function(exports){return exports.CurrencyFormatter=CurrencyFormatter})}.call(this),function(){var NumberFormatter={formatTo2Decimals:function(value){return Math.round(100*value)/100}};namespace("App",function(exports){return exports.NumberFormatter=NumberFormatter})}();var Textfield=function(elem,options){function isEmailAddress(str){var filter=/^\s*[^\s@]+@[^\s@]+\.[^\s@]+\s*$/;return 0==str.length?!1:filter.test(str)?!0:!1}function iswebsiteAddress(web){var val=$input.val();return/^(https?|ftp):\/\//i.test(web)||$input.val("http://"+val),/^((https?|ftp):)?[^:]*\..*$/.test($input.val())}var $input,$confirmButton,$span,$item,$spin,min,max,required,isEmailType,isWebsiteType,isNumberType,prevVal,_this=this,showConfirm=!1,$result=elem.children(".result");this.value="",this.pipeValue="",this.isCompleted=!1,this.required=elem.hasClass("required"),this.unique=elem.hasClass("unique"),this.done=!1,required=this.required,isEmailType=elem.hasClass("email"),isWebsiteType=elem.hasClass("website"),isNumberType=elem.hasClass("number"),this.confirmText="default",this.attachLimit={"default":180,large:170,small:155},this.confirmButton=options.confirmButton,this.init=function(){$span=elem.find(".question > span"),$item=elem.find(".item").children("span"),$input=elem.find("input"),""===$span.html()&&elem.hide(),$confirmButton=elem.find(".container.confirm"),isWebsiteType&&""===$input.val()&&$input.val("http://"),isNumberType&&(min=parseInt($input.attr("min")),max=parseInt($input.attr("max")))},this.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&$item.html(value)},this.bindEvents=function(){if(_this=this,"default"==Globals.browser){elem.on("keyup.e keydown.e","input",_inputEvents),$(window).on("scrollstop.e",_scroll);var checkForm=function(){_this.setValue(),elem.trigger("change-value",_this),typeform.Form.check()};$input.blur(checkForm)}else"touch"==Globals.browser&&elem.on("confirm.e","input",function(){""===$input.val()?elem.removeClass("filled"):elem.addClass("filled"),setTimeout(function(){_this.setValue(),typeform.Form.check(),form.next()},Globals.keyboardTimeout)})},this.unbindEvents=function(){"default"==Globals.browser&&$input.blur(),elem.off(".e").removeClass("ready"),$(window).off(".e")},this.preOpen=function(){this.bindEvents()},this.open=function(){if(this.done=!0,Globals.useFocus&&(_.defer(function(){elem.addClass("ready"),$input.focus()}),this.checkButton()),isWebsiteType){var val=$input.val();""===val?$input.val("http://"):$input.val("").val(val)}initialized=!0,showConfirm=!1},this.advanceArrow=function(direction){return App.Utils.isCaretAtStart($input)&&direction==App.Keyboard.UP||App.Utils.isCaretAtEnd($input)&&direction==App.Keyboard.DOWN},this.advanceTab=function(){return!0},this.checkEnter=function(){return!0},this.preSelectFirst=function(){return!1},this.preSelectLast=function(){return!1},this.setValue=function(callback){this.value=$input.val(),this.isCompleted=""!==this.value,isWebsiteType?(this.isCompleted="http://"!==this.value&&""!==this.value,this.pipeValue=this.isCompleted?this.value:""):this.pipeValue=this.value,callback&&callback()},this.validate=function(callback,showError){if(_this=this,showError="undefined"==typeof showError?!0:showError,showConfirm=!1,this.required&&""===this.value.trim())return showError&&form.error.show(elem,App.Texts.required),Globals.useFocus&&$input.focus(),!1;if(options.validator&&""!==$input.val()){var customValidationResults=options.validator($input.val());return!customValidationResults.isValid&&showError&&form.error.show(elem,customValidationResults.errorMessage),customValidationResults.isValid&&callback&&callback(),customValidationResults.isValid}if(isEmailType&&""!==$input.val()&&!isEmailAddress($input.val().toLowerCase()))return showError&&form.error.show(elem,App.Texts.email),Globals.useFocus&&$input.focus(),!1;if(isWebsiteType&&(this.required&&!iswebsiteAddress($input.val())||!this.required&&"http://"!==$input.val()&&""!==$input.val()&&!iswebsiteAddress($input.val())))return showError&&form.error.show(elem,App.Texts.website),Globals.useFocus&&$input.focus(),!1;if(isNumberType){if(""!==$input.val()&&!/^-?[0-9.,]+$/.test($input.val()))return showError&&form.error.show(elem,App.Texts.invalid),!1;if(""!==$input.val()&&(min&&parseInt($input.val(),10)<min||max&&parseInt($input.val(),10)>max))return showError&&(translationKey="minmax",isNaN(min)&&(translationKey="max"),isNaN(max)&&(translationKey="min"),str=App.Texts[translationKey].replace("{{MAX}}",max).replace("{{MIN}}",min),form.error.show(elem,str)),!1}if(this.unique&&""!==$input.val()){var data={};if(data={value:$input.val()},hasError=!1,_this.startLoading(),$.ajax(Globals.uniquePath+elem.attr("id"),{data:data,type:"POST",async:!1,success:function(){},error:function(){showError&&form.error.show(elem,App.Texts.duplicated),Globals.useFocus&&$input.focus(),hasError=!0},complete:function(){_this.stopLoading()}}),hasError)return!1}return callback&&callback(),!0},this.showResult=function(){this.value?$result.show().children("span").html(this.value):$result.hide()},this.resize=function(){},this.update=function(obj){var question=obj.question;""===question?elem.hide():elem.show(),$span.html(question),$input.val()||$input.unbind(".placeholder").bind("focus .placeholder",function(){$(this).val()==App.Texts["default-text"]&&$(this).val("").removeClass("placeholder")}).bind("blur .placeholder",function(){$(this).val()||$(this).val(App.Texts["default-text"]).addClass("placeholder")}).val(App.Texts["default-text"]).addClass("placeholder")},this.startLoading=function(){"default"==Globals.browser?_this.confirmButton.startLoading():($spin=$("<div class='spin'></div>"),$input.after($spin),opts={lines:12,length:2.3,width:2.5,radius:8,color:$input.css("color"),speed:2.1,trail:60,shadow:!1,hwaccel:!1},spinner=new Spinner(opts).spin($spin[0]))},this.stopLoading=function(){"default"==Globals.browser?_this.confirmButton.stopLoading():$spin.remove()},this.checkButton=function(){_this.confirmButton.check(this.isFilled(),$confirmButton,$input)},this.isFilled=function(){return!(!$input.val()||isWebsiteType&&"http://"==$input.val())};var _inputEvents=function(evt){if(key=document.all?evt.keyCode:evt.which,"default"==Globals.browser&&!elem.hasClass("focus"))return!1;if("keydown"==evt.type)!isNumberType||App.Keyboard.isNumber(key)||evt.ctrlKey||evt.shiftKey||evt.metaKey||App.Keyboard.isShiftOnly(key)||App.Keyboard.isTab(key)||App.Keyboard.isArrowDown(key)||App.Keyboard.isArrowUp(key)||App.Keyboard.isArrowLeft(key)||App.Keyboard.isArrowRight(key)||App.Keyboard.isPageUp(key)||App.Keyboard.isPageDown(key)||App.Keyboard.isEnter(key)||App.Keyboard.isAlt(key)||App.Keyboard.isDelete(key)||App.Keyboard.isSupr(key)||App.Keyboard.isUppercase(key)||App.Keyboard.isEsc(key)||(evt.stopPropagation(),evt.preventDefault(),"default"==Globals.browser&&App.ShakeAnimation.shake(elem,onShakeAnimationComplete)),App.Utils.isCaretAtStart($input)||!App.Keyboard.isArrowUp(key)&&!App.Keyboard.isArrowLeft(key)||evt.stopPropagation(),App.Utils.isCaretAtEnd($input)||!App.Keyboard.isArrowDown(key)&&!App.Keyboard.isArrowRight(key)||evt.stopPropagation(),App.Keyboard.isSpace(key)&&evt.stopPropagation(),prevVal=$input.val();else if("keyup"==evt.type&&(evt.shiftKey||9==key||13==key||App.Keyboard.isArrowDown(key)||App.Keyboard.isArrowUp(key)?(evt.stopPropagation(),evt.preventDefault()):("default"==Globals.browser&&_this.checkButton(),form.error.hide(elem),elem.removeClass("ko")),isNumberType)){var domEl=$input[0],start=domEl.selectionStart,end=domEl.selectionEnd,contentLength=$input.val().length;$input.val($input.val().replace(/[^0-9\-+]/g,"").replace(/((?!^)[+\-])/g,""));var numRemovedCharacters=contentLength-$input.val().length;domEl.setSelectionRange(start-numRemovedCharacters,end-numRemovedCharacters)}},_scroll=function(){showConfirm=!1},onShakeAnimationComplete=function(){$input.focus()}};$.fn.textfield=function(options){return this.each(function(){var element=$(this);if(!element.data("control")){var textfield=new Textfield(element,options||{});element.data("control",textfield)}})};var Textarea=function(elem,options){function createAutoresize(){$textarea.autosize({callback:function(){center()},append:"\n"})}function center(){var currentHeight=$textarea.outerHeight();currentHeight!=savedHeight&&savedHeight>0&&($(window).scrollTop($(window).scrollTop()+currentHeight-savedHeight),form.updatePositions()),savedHeight=currentHeight}var $textarea,$confirmButton,$wrapper,$span,$item,required,_this=this,windowHeight=0,savedHeight=0,showConfirm=!1,$result=elem.children(".result");this.value="",this.pipeValue="",this.isCompleted=!1,this.required=elem.hasClass("required"),this.done=!1,required=this.required,this.confirmText="textarea",this.attachLimit={"default":200,large:200,small:120},this.confirmButton=options.confirmButton,this.init=function(){$textarea=elem.find("textarea"),$span=elem.find(".question").children("span"),$item=elem.find(".item").children("span"),""==$span.html()&&elem.hide(),$confirmButton=elem.find(".container.confirm"),"default"==Globals.browser&&createAutoresize(),$wrapper=elem.children(".wrapper")},this.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&$item.html(value)},this.bindEvents=function(){if(_this=this,Globals.useKeyboardEvents){var checkForm=function(){_this.setValue(),elem.trigger("change-value",_this),typeform.Form.check()},checkFormWhenEmpty=function(){""===$(this).val()&&checkForm()};elem.on("keydown.e keyup.e","textarea",_textareaEvent).on("keyup.e","textarea",_.debounce(this.checkButton,200,!0)),$(window).on("scrollstart.e",checkForm),elem.on("keyup.e","textarea",checkFormWhenEmpty)}$("body").addClass("confirm-text-textarea"),"default"==Globals.browser?$wrapper.height(""):"touch"==Globals.browser&&elem.on("confirm.e","textarea",function(){""===$textarea.val()?elem.removeClass("filled"):elem.addClass("filled"),setTimeout(function(){form.next()},Globals.keyboardTimeout)}),elem.on("change.e","textarea",function(){_this.setValue(),typeform.Form.check()})},this.unbindEvents=function(){$("body").removeClass("confirm-text-textarea"),"default"==Globals.browser&&$textarea.blur(),$wrapper.height(elem.children(".wrapper").height()),$(window).off(".e"),elem.off(".e").removeClass("ready")},this.preOpen=function(){this.bindEvents()},this.open=function(){this.done=!0,showConfirm=!1,Globals.useFocus&&(_.defer(function(){$textarea.focus(),elem.addClass("ready")}),this.checkButton()),initialized=!0},this.advanceArrow=function(direction){return App.Utils.isCaretAtStart($textarea)&&direction==App.Keyboard.UP||App.Utils.isCaretAtEnd($textarea)&&direction==App.Keyboard.DOWN},this.advanceTab=function(){return!0},this.checkEnter=function(){return!0},this.preSelectFirst=function(){return!1},this.preSelectLast=function(){return!1},this.setValue=function(callback){this.value=$textarea.val(),this.pipeValue=this.value,this.isCompleted=""!==this.value,callback&&callback()},this.validate=function(callback,showError){return showError="undefined"==typeof showError?!0:showError,setFocus=!Globals.isTouch,showConfirm=!1,"boolean"==typeof callback&&(setFocus=callback),this.required&&""==this.value?(showError&&form.error.show(elem,App.Texts.required),setFocus&&$textarea.focus(),!1):(callback&&callback(),!0)},this.resize=function(){windowHeight=$(window).height()},this.showResult=function(){this.value?$result.show().children("span").html(this.value):$result.hide()},this.update=function(obj){var question=obj.question;""===question?elem.hide():elem.show(),$span.html(question),$textarea.val()||$textarea.unbind(".placeholder").bind("focus .placeholder",function(){$(this).val()==App.Texts["default-text"]&&$(this).val("").removeClass("placeholder")}).bind("blur .placeholder",function(){$(this).val()||$(this).val(App.Texts["default-text"]).addClass("placeholder")}).val(App.Texts["default-text"]).addClass("placeholder"),createAutoresize()},this.checkButton=function(){_this.confirmButton.check(_this.isFilled(),$confirmButton,$textarea)},this.isFilled=function(){return""!==$textarea.val()};var _textareaEvent=function(evt){"keydown"==evt.type?(key=document.all?evt.keyCode:evt.which,App.Keyboard.isSpace(key)&&evt.stopPropagation(),App.Keyboard.isEnter(key)&&evt.shiftKey&&evt.stopPropagation(),App.Utils.isCaretAtStart($textarea)||!App.Keyboard.isArrowUp(key)&&!App.Keyboard.isArrowLeft(key)||evt.stopPropagation(),App.Utils.isCaretAtEnd($textarea)||!App.Keyboard.isArrowDown(key)&&!App.Keyboard.isArrowRight(key)||evt.stopPropagation()):"keyup"==evt.type&&(key=document.all?evt.keyCode:evt.which,evt.shiftKey||9==key||App.Keyboard.isShiftOnly(key)?(evt.stopPropagation(),evt.preventDefault()):(form.error.hide(elem),$textarea.val()||_this.checkButton()))}};$.fn.textarea=function(options){return this.each(function(){var element=$(this);if(!element.data("control")){var textarea=new Textarea(element,options||{});element.data("control",textarea)}})};var Statement=function(elem){{var $span,$button;elem.find(".container.confirm")}this.value="",this.pipeValue="",this.isCompleted=!0,this.required=!1,this.done=!1,this.confirmText="default",this.attachLimit={"default":140,large:130,small:100},this.quoteMarksEnabled=elem.data("model").quoteMarksEnabled,this.init=function(){$span=elem.find(".question > span"),$button=elem.find(".button > span"),$quote=elem.find(".item"),""===$span.html()&&elem.hide(),this.setQuotes(this.quoteMarksEnabled)},this.set=function(attr,value){this[attr]=value,("isActive"===attr||"isVisible"===attr)&&(this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"))},this.bindEvents=function(){var evt="touch"===Globals.browser?"touchend":"mouseup";elem.on(evt+".e",".button",_.debounce(function(){return typeform.Form.check(),form.autoNext(),$(this).removeClass("active"),!1},Globals.debounceWait,!0))},this.unbindEvents=function(){elem.off(".e")},this.preOpen=function(){this.bindEvents()},this.open=function(){this.done=!0},this.setQuotes=function(quoteMarks){quoteMarks===!1?$quote.hide():$quote.show()},this.advanceArrow=function(){return!0},this.advanceTab=function(){return!0},this.checkEnter=function(){return!0},this.preSelectFirst=function(){return!1},this.preSelectLast=function(){return!1},this.setValue=function(callback){callback&&callback()},this.validate=function(callback){return callback&&callback(),!0},this.showResult=function(){},this.resize=function(){},this.update=function(obj){var question=obj.question;""===question?elem.hide():elem.show(),$button.html(""===obj.button?App.Texts["continue-button"]:obj.button),this.setQuotes(obj.quoteMarksEnabled),$span.html(question)}};$.fn.statement=function(){return this.each(function(){var element=$(this);if(!element.data("control")){var statement=new Statement(element);element.data("control",statement)}})};var Terms=function(elem){function setDimensions(){$buttons.css("display","inline-block"),width=0,$buttons.each(function(){$(this).css("width",""),$(this).width()>width&&(width=$(this).width())}),$buttons.css({width:width+5,display:"block"})}function selectButtonById(id){var $button=$buttons.eq(id),$aux=$buttons.eq(!id);$button.hasClass("selected")?($button.removeClass("selected"),hasSelection=!1):(form.error.hide(elem),$button.addClass("selected").children(".aux").selectEffect(2),$aux.removeClass("selected"),hasSelection=!0),elem.data("control").setValue(),typeform.Form.check(),1==hasSelection&&form.autoNext(!0),enable=$button.hasClass("selected")||$aux.hasClass("selected"),"undefined"!=typeof $footerNav&&($footerNav.enable(enable),$tabNavbutton.enable(enable))}var $span,$item,KEY_YES=89,KEY_NO=78,ready=!1,$tabNavbutton=elem.find(".button.nav.next"),$keys=elem.find(".keys"),$buttons=$keys.children("li"),$scrollArea=elem.find(".scroll-area");this.value="",this.pipeValue="",this.isCompleted=!1,this.required=elem.hasClass("required"),this.done=!1,this.confirmText="default",this.attachLimit={"default":170,large:190,small:145},this.init=function(){$span=elem.find(".question").children("span"),$item=elem.find(".item").children("span"),""===$span.html()&&elem.hide(),KEY_YES=$buttons.eq(0).children(".letter").children("span").html().charCodeAt(0),KEY_NO=$buttons.eq(1).children(".letter").children("span").html().charCodeAt(0)},this.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&$item.html(value)},this.bindEvents=function(){ready=!0;var evt="touch"===Globals.browser?"touchend":"mouseup";elem.on(evt+".e","li",_.debounce(_click,Globals.debounceWait,!0)),Globals.useKeyboardEvents&&$(document).on("keydown.e",_keyboard)},this.unbindEvents=function(){ready=!1,elem.off(".e"),$(document).off(".e")},this.preOpen=function(){this.bindEvents(),$buttons.removeClass("pre-selected"),useKeyNav&&(navType==App.Keyboard.UP&&$keys.children(":last-child").addClass("pre-selected"),navType==App.Keyboard.DOWN&&$keys.children().eq(0).addClass("pre-selected"))},this.open=function(){this.done=!0},this.advanceArrow=function(direction){if($preSelected=$keys.find(".pre-selected"),$preSelected.removeClass("pre-selected"),direction==App.Keyboard.DOWN||direction==App.Keyboard.UP)if($preSelectedCandidate=direction==App.Keyboard.DOWN?$preSelected.next("li"):$preSelected.prev("li"),$preSelected.length){if(!$preSelectedCandidate.length)return!0}else $preSelectedCandidate.length||($preSelectedCandidate=direction==App.Keyboard.DOWN?$keys.children().eq(0):$keys.children(":last-child"));else $preSelectedCandidate=direction==App.Keyboard.RIGHT?$preSelected.next("li"):$preSelected.prev("li"),$preSelectedCandidate.length||($preSelectedCandidate=direction==App.Keyboard.RIGHT?$keys.children().eq(0):$keys.children(":last-child"));return ready&&$preSelectedCandidate.addClass("pre-selected"),!1},this.advanceTab=function(){return!0},this.checkEnter=function(){return $keys.find(".pre-selected").length?(selectButtonById($keys.find(".pre-selected").index()),!1):!0},this.preSelectFirst=function(){return $keys.children("li:first").addClass("pre-selected"),!0},this.preSelectLast=function(){return $keys.children("li:last").addClass("pre-selected"),!0},this.setValue=function(callback){this.value="",$buttons.eq(0).hasClass("selected")&&(this.value="1"),$buttons.eq(1).hasClass("selected")&&(this.value="0"),this.isCompleted=""!==this.value,this.pipeValue=function(){switch(this.value){case"0":return App.Texts.no;case"1":return App.Texts.yes;default:return""}}.call(this),callback&&callback()},this.validate=function(callback,showError){return showError="undefined"==typeof showError?!0:showError,!this.required||""!==this.value&&"0"!==this.value?(callback&&callback(),!0):(showError&&form.error.show(elem,App.Texts.terms),!1)},this.resize=function(){"touch"==Globals.browser&&$(window).width()<Globals.responsiveThreshold||setDimensions()},this.update=function(obj){var question=obj.question;""===question?elem.hide():(elem.show(),setDimensions()),$span.html(question),$scrollArea.html(obj.text)};var _keyboard=function(evt){key=document.all?evt.keyCode:evt.which,"keydown"==evt.type&&(key==KEY_YES?selectButtonById(0):key==KEY_NO?selectButtonById(1):App.Keyboard.isSpace(key)?($keys.find(".pre-selected").length&&selectButtonById($keys.find(".pre-selected").index()),evt.preventDefault()):(App.Keyboard.isArrowDown(key)||App.Keyboard.isArrowUp(key))&&evt.preventDefault())},_click=function(){return selectButtonById($(this).index()),!1}};$.fn.terms=function(){return this.each(function(){var element=$(this);if(!element.data("control")){var terms=new Terms(element);element.data("control",terms)}})};var YesNo=function(elem){function setDimensions(){var width=0;return $buttons.each(function(){var currentWidth=$(this).width();currentWidth>width&&(width=currentWidth)}),width}function selectButtonById(id){var $button=$buttons.eq(id),$aux=$buttons.eq(!id);$button.hasClass("selected")?($button.removeClass("selected"),hasSelection=!1):(form.error.hide(elem),$button.addClass("selected").children(".aux").selectEffect(2),$aux.removeClass("selected"),hasSelection=!0),elem.data("control").setValue(),typeform.Form.check(),1==hasSelection&&form.autoNext(!0),enable=$button.hasClass("selected")||$aux.hasClass("selected"),"undefined"!=typeof $footerNav&&($footerNav.enable(enable),$tabNavbutton.enable(enable))}var $span,$item,KEY_YES=89,KEY_NO=78,ready=!1,$tabNavbutton=elem.find(".button.nav.next"),$keys=elem.find(".keys"),$buttons=$keys.children("li");this.value="",this.pipeValue="",this.isCompleted=!1,this.required=elem.hasClass("required");var required=this.required;this.done=!1,this.confirmText="default",this.attachLimit={"default":170,large:190,small:145},this.init=function(){$span=elem.find(".question").children("span"),$item=elem.find(".item").children("span"),KEY_YES=$buttons.eq(0).children(".letter").children("span").html().charCodeAt(0),KEY_NO=$buttons.eq(1).children(".letter").children("span").html().charCodeAt(0),""===$span.html()&&elem.hide(),$tabNavbutton.enable(!required)},this.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&$item.html(value)},this.bindEvents=function(){ready=!0;var evt="touch"===Globals.browser?"touchend":"mouseup";elem.on(evt+".e","li",_.debounce(_click,Globals.debounceWait,!0)),Globals.useKeyboardEvents&&$(document).on("keydown.e",_keyboard)},this.unbindEvents=function(){ready=!1,elem.off(".e"),$(document).off(".e")},this.preOpen=function(){this.bindEvents(),$buttons.removeClass("pre-selected"),useKeyNav&&(navType==App.Keyboard.UP&&$keys.children(":last-child").addClass("pre-selected"),navType==App.Keyboard.DOWN&&$keys.children().eq(0).addClass("pre-selected"))},this.open=function(){this.done=!0},this.advanceArrow=function(direction){if($preSelected=$keys.find(".pre-selected"),$preSelected.removeClass("pre-selected"),direction==App.Keyboard.DOWN||direction==App.Keyboard.UP)if($preSelectedCandidate=direction==App.Keyboard.DOWN?$preSelected.next("li"):$preSelected.prev("li"),$preSelected.length){if(!$preSelectedCandidate.length)return!0
}else $preSelectedCandidate.length||($preSelectedCandidate=direction==App.Keyboard.DOWN?$keys.children().eq(0):$keys.children(":last-child"));else $preSelectedCandidate=direction==App.Keyboard.RIGHT?$preSelected.next("li"):$preSelected.prev("li"),$preSelectedCandidate.length||($preSelectedCandidate=direction==App.Keyboard.RIGHT?$keys.children().eq(0):$keys.children(":last-child"));return ready&&$preSelectedCandidate.addClass("pre-selected"),!1},this.advanceTab=function(){return!0},this.checkEnter=function(){return $keys.find(".pre-selected").length?(selectButtonById($keys.find(".pre-selected").index()),!1):!0},this.preSelectFirst=function(){return $keys.children("li:first").addClass("pre-selected"),!0},this.preSelectLast=function(){return $keys.children("li:last").addClass("pre-selected"),!0},this.setValue=function(callback){this.value="",$buttons.eq(0).hasClass("selected")&&(this.value="1"),$buttons.eq(1).hasClass("selected")&&(this.value="0"),this.isCompleted=""!==this.value,this.pipeValue=function(){switch(this.value){case"0":return App.Texts.no;case"1":return App.Texts.yes;default:return""}}.call(this),callback&&callback()},this.validate=function(callback,showError){return showError="undefined"==typeof showError?!0:showError,this.required&&""===this.value?(showError&&form.error.show(elem,App.Texts["must-select"]),!1):(callback&&callback(),!0)},this.resize=function(windowWidth){this.maxWidth=null;var isMobile="touch"==Globals.browser&&windowWidth<Globals.responsiveThreshold;isMobile||(this.maxWidth=setDimensions())},this.applyResize=function(){_.isNull(this.maxWidth)||$buttons.css({width:this.maxWidth+5})},this.update=function(obj){var question=obj.question;""===question?elem.hide():(elem.show(),setDimensions()),$span.html(question)};var _keyboard=function(evt){key=document.all?evt.keyCode:evt.which,"keydown"==evt.type&&(key==KEY_YES?selectButtonById(0):key==KEY_NO?selectButtonById(1):App.Keyboard.isSpace(key)?($keys.find(".pre-selected").length&&selectButtonById($keys.find(".pre-selected").index()),evt.preventDefault()):(App.Keyboard.isArrowDown(key)||App.Keyboard.isArrowUp(key))&&evt.preventDefault())},_click=function(){return selectButtonById($(this).index()),!1}};$.fn.yesNo=function(){return this.each(function(){var element=$(this);if(!element.data("control")){var yesNo=new YesNo(element);element.data("control",yesNo)}})};var Rating=function(elem){function resize(){containerWidth=$icons.width(),margin=Globals.isMobile?3:7,size=Math.min((containerWidth-totalSteps*margin)/totalSteps,maxFontSize),$icons.css("font-size",size-3+"px").children().css({width:size})}function addIcons(steps){$icons.empty();var label="",back="";$(steps).each(function(i,val){"default"==Globals.browser&&(label="<div class='label fontFamily secondaryColor'><div class='letter'><span>"+val+"</span></div></div>",back="<div class='icon back'></div>"),$icons.append("<li><div class='center-wrapper'><div class='center'><div class='icon'></div>"+back+label+"</div></div></li>")}),totalSteps=$(steps).length}function select($li){$leftSiblings=$li.prevAll(),$rightSiblings=$li.nextAll(),$li.hasClass("selected")&&!$li.next(".selected").length?($li.removeClass("selected"),isScale||$leftSiblings.removeClass("selected")):(form.error.hide(elem),$li.selectEffect(2).addClass("selected"),isScale||$leftSiblings.addClass("selected")),_.defer(function(){elem.data("control").setValue(),typeform.Form.check(),elem.data("control").value>0&&form.autoNext(!0)}),isScale||$rightSiblings.removeClass("selected")}function over($li){$li.addClass("hover"),isScale||$li.prev().length&&over($li.prev())}function out($li){$li.add($li.siblings()).removeClass("hover")}var $navButton,$span,$item,required,totalSteps,$icons,currentQuestion,$questions,currentQuestion,is1,maxFontSize=66,hasMoveMouse=(new Array,!1);this.value=null,this.pipeValue="",this.isCompleted=!1,this.required=elem.hasClass("required"),this.unique=elem.hasClass("unique"),this.done=!1,required=this.required,this.confirmText="default",this.attachLimit={"default":170,large:135,small:120},isScale=!1,this.init=function(){$span=elem.find(".question > span"),$item=elem.find(".item").children("span"),$navButton=elem.find("div.button"),""===$span.html()&&elem.hide(),$icons=elem.find(".icons"),obj=$icons.data("steps"),"undefined"!=typeof obj&&addIcons(obj.steps),currentQuestion=0,$questions=elem.find(".questions > li")},this.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&$item.html(value)},this.bindEvents=function(){var evt="touch"===Globals.browser?"touchend":"mouseup";elem.on(evt+".e",".icons li",_.debounce(_select,Globals.debounceWait,!0)),"default"==Globals.browser&&elem.on("mouseover.e mousemove.e mouseleave.e",".icons li",_mouse),Globals.useKeyboardEvents&&$(document).on("keyup.e keydown.e",_documentKeyboard)},this.unbindEvents=function(){elem.off(".e"),$(document).off(".e"),$(window).off(".e")},this.preOpen=function(){hasMoveMouse=!1,this.bindEvents()},this.open=function(){this.done=!0},this.advanceArrow=function(direction){return direction==App.Keyboard.LEFT||direction==App.Keyboard.RIGHT?($icons.children().removeClass("hover selected"),$selected=$icons.children(".pre-selected:last"),direction==App.Keyboard.LEFT?($selected.removeClass("pre-selected"),$candidate=$selected.prev()):($candidate=$selected.length?$selected.next():$icons.children().eq(0),$candidate.addClass("pre-selected")),!1):!0},this.advanceTab=function(){return!0},this.checkEnter=function(){return $candidate=$icons.find(".pre-selected:last"),$candidate.length?(select($candidate),!1):!0},this.preSelectFirst=function(){return!1},this.preSelectLast=function(){return!1},this.setValue=function(callback){selectedIndex=$icons.find(".selected:last").index(),this.value=null,selectedIndex>=0&&(this.value=selectedIndex+1),this.pipeValue=this.value||"",elem.find(".hover").removeClass("hover"),this.isCompleted=this.value>0,callback&&callback()},this.validate=function(callback,showError){return showError="undefined"==typeof showError?!0:showError,this.required&&null===this.value?(showError&&form.error.show(elem,App.Texts["must-select"]),!1):(callback&&callback(),!0)},this.showResult=function(){},this.resize=resize,firstResize=!0,this.update=function(obj){var question=obj.question;""===question?elem.hide():(elem.show(),firstResize&&(resize(),firstResize=!1)),$span.html(question),obj.steps&&($icons.html(),addIcons(obj.steps),resize()),obj.shape&&(elem.removeClass(/^icon-/).addClass("icon-"+obj.shape),resize())};var _select=function(){return select($(this)),!1},_mouse=function(evt){return"mousemove"==evt.type?hasMoveMouse=!0:"mouseover"==evt.type?($icons.children(".pre-selected").removeClass("pre-selected"),over($(this))):"mouseleave"==evt.type&&out($(this)),!1},_documentKeyboard=function(evt){key=document.all?evt.keyCode:evt.which;var val;"keyup"==evt.type?($icons.find(".hover").removeClass("hover"),key>=48&&57>=key?totalSteps>=key-48&&(val=key-47):key>=96&&105>=key&&totalSteps>=key-96&&(val=key-95),"undefined"!=typeof val&&(val-=1,0==val&&(is1?val=10:($icons.find(".selected").removeClass("selected"),form.autoNext(!0))),is1=1==val,setTimeout(function(){is1=!1},1e3),0!=val&&select($icons.children().eq(val-1)))):App.Keyboard.isSpace(key)&&select($icons.find(".pre-selected:last"))}};$.fn.rating=function(){return this.each(function(){var element=$(this);if(!element.data("control")){var rating=new Rating(element);element.data("control",rating)}})};var List=function(elem,options){function resize(windowWidth){isPictureChoice?_this.setPictureChoiceDimensions():"touch"==Globals.browser?(windowWidth>=Globals.responsiveThreshold||_this.isCreditCard)&&_this.setMultipleChoiceDimensions():_this.setMultipleChoiceDimensions()}function getRow(index){for(i=0;index>=leftColumn[i];)i++;return 0===i?0:i-1}function setMultipleChoiceDimensions(){var $lis=$ul.find("li");return liWidth=0,$lis.each(function(){var currentWidth=$(this).width();currentWidth>liWidth&&(liWidth=currentWidth)}),liWidth+=5}function savePCDimensions(){$ul.find(".image-wrapper > img").each(function(){$(this).data("width")||$(this).data("width",$(this).attr("width")).data("height",$(this).attr("height"))})}function checkCustom(){$customLi.hasClass("open")?resetOther():($customLi.removeClass("selected").addClass("open"),"default"!=Globals.browser||isPictureChoice||(w=Math.max(liWidth,windowInnerWidth/3),$customLi.css("width",w)),"default"===Globals.browser&&$(document).one("mouseup.e",_inputBlur),$otherInput.focus())}function addCustom(){checkCustom();var valor=$otherInput.val();""===valor?(valor=defaultTextOther,elem.removeClass("filled")):elem.addClass("filled"),$customLi.find("span.val").html(valor),$otherInput.blur(),valor!=defaultTextOther&&setTimeout(function(){select($customLi)},300)}function checkSelect($li){$li.hasClass("custom")?checkCustom():select($li)}function select($li){multiple&&!hasAlert&&setTimeout(function(){$multiple.addClass("intermitent").selectEffect(2),hasAlert=!0},1100),Globals.isTouch||$customLi.hasClass("open")&&resetOther(),$li.hasClass("selected")?$li.removeClass("selected"):(form.error.hide(elem),multiple||$li.siblings(".selected").removeClass("selected"),$li.addClass("selected").children(".aux").selectEffect(2),multiple||_.defer(function(){form.autoNext(!0)})),elem.data("control").setValue(),typeform.Form.check(),multiple&&(0!==$ul.children(".selected").length?_this.confirmButton.show($confirm):_this.confirmButton.hide($confirm))}function changeDomByMultiple(multiple){multiple?elem.addClass("multiple"):elem.removeClass("multiple")}function changeDomByVertical(vertical){vertical?elem.addClass("vertical"):elem.removeClass("vertical")}function resetOther(){$customLi.removeClass("open"),"default"!=Globals.browser||isPictureChoice||$customLi.css("width",liWidth)}function replaceHtml(oldEl,html){var newEl=oldEl.cloneNode(!1);return newEl.innerHTML=html,oldEl.parentNode.replaceChild(newEl,oldEl),newEl}var isPictureChoice,vertical,$multiple,$span,$item,$ul,$customLi,defaultTextOther,$otherInput,$confirm,multiple,required,randomize,numItems,supersize,_this=this,prevTop=0,hasMove=!1,startY=0,hasAlert=!1,ready=!1,liWidth=0,windowInnerWidth=0,useFreezeFrame=!0,letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],innerPositions=[],leftColumn=[];this.value={choices:void 0,other:""},this.logicValue={},this.pipeValue="",this.isCompleted=!1,this.isCreditCard=elem.attr("id")?elem.attr("id").indexOf("creditCard")>-1:!1,this.required=elem.hasClass("required"),this.multiple=elem.hasClass("multiple"),randomize=elem.hasClass("randomize"),supersize=elem.hasClass("supersize"),this.vertical=elem.hasClass("vertical"),this.done=!1,multiple=this.multiple,required=this.required,vertical=this.vertical,isPictureChoice=elem.hasClass("list-image"),this.confirmText="default",this.attachLimit=multiple?{"default":165,large:165,small:124}:{"default":138,large:132,small:97},this.confirmButton=options.confirmButton,this.init=function(){var self=this;$span=elem.find(".question").children("span"),$item=elem.find(".item").children("span"),$multiple=elem.find(".multiple"),""===$span.html()&&elem.hide(),$ul=elem.find("ul"),$customLi=$ul.children(".custom"),randomize&&$ul.children("li").not(".custom").shuffle().each(function(index,li){$(li).find(".letter > span").html(letters[index])}),numItems=$ul.children().length,$otherInput=elem.find(".custom :text"),defaultTextOther=elem.find("li.custom").find("span.val").html(),$confirm=elem.find(".container.confirm"),isPictureChoice&&(savePCDimensions(),Globals.isIOs===!0&&(this.IOSGifLayer=this.createIOSGifLayer()),elem.find(".columns img").lazyload({effect:"fadeIn",event:"lazyload",load:function(){var img=$(this);img.data("loaded",!0),useFreezeFrame&&self.isImageAGif(img)&&("default"===Globals.browser&&self.applyFrezzeGif(img),Globals.isIOs===!0&&self.addGifToLayer(img))}})),changeDomByMultiple(multiple),changeDomByVertical(vertical),windowInnerWidth=window.innerWidth},this.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&$item.html(value)},this.bindEvents=function(){ready=!0,Globals.useKeyboardEvents&&$(document).on("keydown.e keyup.e",_documentKeydown),"touch"==Globals.browser?elem.on("touchstart.e touchmove.e touchend.e","li",_selectLi).on("confirm.e","input",function(){setTimeout(function(){_okCustom()},Globals.keyboardTimeout)}):"default"==Globals.browser&&elem.on("mouseup.e","li",_.debounce(_selectLi,Globals.debounceWait,!0)).on("mouseup.e","input",_inputMouseUp).on("keydown.e keyup.e","input",_inputKeyboard).on("mouseup.e",".ok-confirm .button",_okCustom)},this.unbindEvents=function(){$ul.children(".pre-selected").removeClass("pre-selected"),ready=!1,$(document).off(".e"),elem.off(".e"),resetOther()},this.preOpen=function(){this.bindEvents(),useKeyNav&&(navType==App.Keyboard.UP||navType==App.Keyboard.DOWN)&&(navType==App.Keyboard.UP&&($preselected=$ul.children(":last-child")),navType==App.Keyboard.DOWN&&($preselected=$ul.children().eq(0)),$preselected.addClass("pre-selected"),form.centerElement(elem,$preselected)),$multiple.removeClass("intermitent")},this.open=function(){this.done=!0,$ul.find(".selected").length||(hasAlert=!1,isPictureChoice&&elem.find("img").trigger("lazyload"))},this.advanceArrow=function(direction){if($preSelected=$ul.find(".pre-selected"),$preSelected.length){if(direction==App.Keyboard.LEFT&&($preSelectedCandidate=0===$preSelected.index()?$ul.children(":last-child"):$preSelected.prev()),direction==App.Keyboard.RIGHT&&($preSelectedCandidate=$preSelected.index()==$ul.children(":last-child").index()?$ul.children().eq(0):$preSelected.next()),direction==App.Keyboard.UP){if(preSelectedRow=getRow($preSelected.index()),preSelectedColumn=$preSelected.index()-leftColumn[preSelectedRow],0===preSelectedRow)return!0;candidateIndex=leftColumn[preSelectedRow-1]+preSelectedColumn,$preSelectedCandidate=$ul.children().eq(candidateIndex)}if(direction==App.Keyboard.DOWN){if(preSelectedRow=getRow($preSelected.index()),preSelectedColumn=$preSelected.index()-leftColumn[preSelectedRow],"undefined"==typeof leftColumn[preSelectedRow+1])return!0;candidateIndex=leftColumn[preSelectedRow+1]+preSelectedColumn,candidateIndex>$ul.children(":last-child").index()&&(candidateIndex=$ul.children(":last-child").index()),$preSelectedCandidate=$ul.children().eq(candidateIndex)}}else if($preSelectedCandidate=direction==App.Keyboard.RIGHT||direction==App.Keyboard.DOWN?$ul.children().eq(0):$ul.children(":last-child"),direction==App.Keyboard.UP)return!0;offset=$preSelectedCandidate.offset().top-window.pageYOffset,$(window).height()-100<offset?form.center(offset-$(window).height()/2):100>offset&&form.center(-offset),$ul.children(".hover").removeClass("hover"),$preSelectedCandidate.addClass("pre-selected"),$preSelected.removeClass("pre-selected")},this.advanceTab=function(){return!0},this.checkEnter=function(){var $pre=elem.find(".pre-selected");return $pre.length&&!$pre.hasClass("selected")?(checkSelect($pre),!1):!0},this.preSelectFirst=function(){return $ul.children("li:first").addClass("pre-selected"),!0},this.preSelectLast=function(){return $ul.children("li:last").addClass("pre-selected"),!0},this.setValue=function(callback){var selected,$selected,values=[];this.multiple?($selected=$ul.children(".selected:not(.custom)"),$selected.length&&(selected={},$selected.each(function(){id=$(this).attr("id"),selected["choice:"+id]=$(this).find(':hidden[name="value"]').val(),values.push(id)}))):($selected=$ul.children(".selected"),selected=$selected.find(':hidden[name="value"]').val(),values.push($selected.attr("id"))),this.value.choices=selected,this.logicValue=values;var hasOther=$customLi.is(".selected")&&$otherInput.val();hasOther?("undefined"==typeof this.value.choices&&(this.value.choices={}),this.multiple&&(this.value.choices["choice:other"]="!other"),this.value.other=$otherInput.val(),this.logicValue.push(this.value.other)):this.value.other="",this.isCompleted=!_.isEmpty(this.value.choices)||""!==this.value.other,this.pipeValue=this.getPipeValue(this.value),callback&&callback()},this.getPipeValue=function(value){return values="undefined"==typeof value.choices?[""]:"string"==typeof value.choices?[value.choices]:_.values(value.choices),"undefined"!=typeof value.choices&&""!==value.other&&values.push(value.other),values=_.without(values,"!other"),values=_.map(values,function(value){return/^!choice/.test(value)?value.split("!choice:")[1]:value}),values.join(", ")},this.validate=function(callback,showError){return showError="undefined"==typeof showError?!0:showError,this.required&&0===$ul.children(".selected").length?(showError&&form.error.show(elem,App.Texts["must-select"]),!1):(callback&&callback(),!0)},this.resize=function(windowWidth){resize(windowWidth)},this.select=function($li){select($li)},this.triggerLazyload=function(){this.$elem.find(".image-wrapper img").each(function(){$(this).trigger("lazyload")})},this.load=function(){var self=this;this.$elem.find(".image-wrapper img").each(function(){var img=$(this);""!==img.attr("src")&&self.isImageAGif(img)&&(self.isImageLoaded(img)?self.restartGif(img):img.data("focus",!0))})},this.restartGif=function(img){"touch"==Globals.browser?setTimeout(function(){var src=img.attr("src");img.removeAttr("src").attr("src",src)},10):img.trigger("focusenter")},this.pause=function(){var self=this;this.$elem.find(".image-wrapper img").each(function(){var img=$(this);self.isImageAGif(img)&&img.trigger("focusleave")})},this.isImageAGif=function($img){var originalImage=$img.data("original");return originalImage&&"gif"===originalImage.slice(-3)?!0:!1},this.applyFrezzeGif=function($img){this.frezzeGif($img),freezeframe.run($img,$img.data("focus")),this.resizeFreezeContainer($img)},this.frezzeGif=function($img){$img.addClass("freezeframe")},this.createIOSGifLayer=function(){var gifLayer=$("<div />").addClass("ios-picture-choice-gif-layer");return $("body").append(gifLayer),gifLayer},this.addGifToLayer=function(img){var gif=$("<img />");gif.attr("src",img.attr("src")),gif.css({"margin-left":-(img.width()-1),"margin-top":-(img.height()-1),height:img.height(),width:img.width()}),this.IOSGifLayer.append(gif)},this.resizeFreezeContainer=function($img){var freezeContainer=$img.parent();freezeContainer.css("position","absolute"),freezeContainer.css("width",$img.width()),freezeContainer.css("height",$img.height()),freezeContainer.css("margin-left",$img.css("margin-left")),freezeContainer.css("margin-top",$img.css("margin-top")),freezeContainer.css("top","50%"),freezeContainer.css("left","50%")},this.isImageLoaded=function($img){return $img.data("loaded")?!0:!1},this.update=function(obj){self=this;var question=obj.question;if(""===question?elem.hide():elem.show(),$span.html(question),"undefined"!=typeof obj.options){isPictureChoice||$ul.empty();var arrayOptions=obj.options;randomize=obj.randomize,supersize=obj.supersize;var arrayLength=arrayOptions.length;(arrayLength<$ul.children().length||randomize)&&$ul.empty(),$customLi.remove();var cont=0;if(isPictureChoice){for(var i in arrayOptions){var caption=obj.labelsEnabled?obj.options[i].caption:"",picture=supersize?obj.options[i].picturesupersize:obj.options[i].picture,width=supersize?obj.options[i].widthsupersize:obj.options[i].width,height=supersize?obj.options[i].heightsupersize:obj.options[i].height;(""!==caption||""!==picture)&&($li=$ul.children().eq(i),$li.length?($li.find(".caption").html(caption),$li.find(".image-wrapper > img").attr("src")!=picture&&$li.find(".image-wrapper > img").attr({src:picture,width:width,height:height}).data({width:width,height:height})):($imgWrapper=$('<div class="image-wrapper"></div>'),$img=$('<img src="'+picture+'" width="'+width+'" height="'+height+'" style="display:block"/>'),$img.data({width:width,height:height}),$li=$('<li class="secondaryColorBorder container"><div class="tick-wrapper"></div><span class="tick"></span><div class="text"><div class="secondaryColor label"><div class="secondaryColor letter"><span>'+letters[cont]+'</span></div><div class="caption">'+caption+'</div></div></div><div class="aux secondaryColorBorder"><div class="inset"></div><div class="bg"></div><div class="bd"></div><img class="light" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient.png"><img class="dark" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient-dark.png"><div class="overlay"></div></div></li>'),$ul.append($li.prepend($imgWrapper.append($img)))),cont++)}_.defer(function(){resize(),self.applyResize()})}else{var liHTML="";for(var j in arrayOptions){var val=obj.options[j];""!==val&&(liHTML+='<li class="secondaryColorBorder container"><div class="aux secondaryColorBorder"><div class="inset"></div><div class="bg"></div><div class="bd"></div><img class="light" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient.png"><img class="dark" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient-dark.png"><div class="overlay"></div></div><div class="secondaryColor letter"><span>'+letters[cont++]+'</span></div><span class="secondaryColor label">'+val+'</span><span class="secondaryColor tick"></span></li>')}$ul[0]=replaceHtml($ul[0],liHTML),resize(),this.applyResize()}}obj.other&&(isPictureChoice?($customLi=$('<li class="custom secondaryColorBorder container"> <div class="tick-wrapper"></div> <span class="tick"></span> <div class="image-wrapper"><img src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/other.png" width="124" height="115"> <span class="val">'+App.Texts.other+'</span> <input class="other-field secondaryColor" type="text" autocomplete="off"> <div class="button-wrapper ok-confirm"> <div class="button fontFamily nav tick enabled">	</div> </div> </div> <div class="text"> <div class="secondaryColor label"> <div class="secondaryColor letter"><span>'+letters[cont++]+'</span></div> </div> </div> <div class="aux secondaryColorBorder "> <div class="inset"></div> <div class="bg"></div> <div class="bd"></div> <img class="light" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient.png"> <img class="dark" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient-dark.png"> <div class="overlay"></div> </div></li>'),$ul.append($customLi),savePCDimensions(),resize(),this.applyResize()):($customLi=$('<li class="custom secondaryColorBorder container"> <input type="hidden" name="value" value="!other" autocomplete="off"> <div class="secondaryColor letter"><span>'+letters[cont++]+'</span></div> <span class="secondaryColor label ellipsis"><span class="val">'+App.Texts.other+'</span></span> <input class="other-field secondaryColor" type="text" autocomplete="off"> <div class="button-wrapper ok-confirm"> <div class="button fontFamily nav tick enabled">	</div> </div> <span class="secondaryColor tick"></span> <div class="aux secondaryColorBorder "> <div class="inset"></div> <div class="bg"></div> <div class="bd"></div> <img class="light" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient.png"> <img class="dark" src="https://s3-eu-west-1.amazonaws.com/typeform-media-static/container-gradient-dark.png"> <div class="overlay"></div> </div> <div class="clear"></div> </li>'),$ul.append($customLi))),$otherInput=$customLi.find("input:text"),defaultTextOther=App.Texts.other,"undefined"!=typeof obj.multiple&&(multiple=obj.multiple,changeDomByMultiple(obj.multiple),resize(),this.applyResize()),"undefined"!=typeof obj.vertical&&(vertical=obj.vertical,changeDomByVertical(obj.vertical),resize(),this.applyResize()),("undefined"!=typeof obj.options||obj.other)&&App.Utils.setContainerColor(App.Utils.getCssValue("backgroundColor","background-color"),App.Utils.getCssValue("secondaryColor","color"))},this.setMultipleChoiceDimensions=function(){this.maxWidth=setMultipleChoiceDimensions()},this.applyResize=function(){if(isPictureChoice){var imageMargin=25,numImages=this.getNumImagesPerRow(this.containerWidth,supersize,Globals.browser),itemWidth=parseInt(this.containerWidth/numImages,10)-imageMargin;$ul.find(".image-wrapper").each(function(){_this.resizePictureChoice($(this),supersize,itemWidth,this.containerWidth)}),liWidth=itemWidth}else{var $lis=$ul.find("li");$lis.css("width",this.maxWidth)}},this.setPictureChoiceDimensions=function(){var width=$ul.width();Globals.isTouch||(width-=20),this.containerWidth=width},this.getNumImagesPerRow=function(containerWidth,supersize,browser){var numImages=4;return 500>containerWidth&&(numImages=3),(350>containerWidth||supersize)&&(numImages=2),500>containerWidth&&supersize&&"touch"==browser&&(numImages=1),350>containerWidth&&supersize&&(numImages=1),numImages},this.resizePictureChoice=function($container,supersize,itemWidth){$container.css(supersize?{width:itemWidth,height:.75*itemWidth}:{width:itemWidth,height:itemWidth}),$img=$container.children("img"),defaultImageWidth=parseInt($img.data("width"),10),defaultImageHeight=parseInt($img.data("height"),10),dimensions=this.calculatePictureChoiceImage(itemWidth,supersize,defaultImageWidth,defaultImageHeight),$img.css({marginLeft:-dimensions.width/2,marginTop:-dimensions.height/2,width:dimensions.width,height:dimensions.height})},this.calculatePictureChoiceImage=function(itemWidth,supersize,defaultImageWidth,defaultImageHeight){var width,height,ratio=supersize?.75:1;return defaultImageWidth*ratio>defaultImageHeight?(height=defaultImageHeight*itemWidth/defaultImageWidth,width=itemWidth):defaultImageWidth==defaultImageHeight?height=width=defaultImageHeight*itemWidth*ratio/defaultImageWidth:(width=defaultImageWidth*itemWidth*ratio/defaultImageHeight,height=itemWidth*ratio),(width>defaultImageWidth||height>defaultImageHeight)&&(width=defaultImageWidth,height=defaultImageHeight),{width:Math.round(width),height:Math.round(height)}},this.sortKeyboardNavigation=function(){innerPositions=[],leftColumn=[],$ul.children().each(function(index,li){currentTop=$(li).position().top,prevTop!=currentTop&&(arrIndex=innerPositions.push(currentTop),leftColumn.push(index),prevTop=currentTop)})};var _documentKeydown=function(evt){if(!elem.hasClass("focus"))return!1;if(key=document.all?evt.keyCode:evt.which,"keydown"==evt.type)if(evt.ctrlKey||evt.metaKey||evt.preventDefault(),key>=65&&90>=key)$key=elem.find("li:eq("+(key-65)+")"),$key.length&&checkSelect($key);else{if(App.Keyboard.isSpace(key)){var $pre=elem.find(".pre-selected");return $pre.length&&checkSelect($pre),!1}if("8"==key){var $pre=$ul.children(".pre-selected");$pre.length&&$pre.hasClass("selected")&&checkSelect($pre)}}},_inputKeyboard=function(evt){evt.stopPropagation(),key=document.all?evt.keyCode:evt.which,"keydown"==evt.type&&(App.Keyboard.isTab(key)&&evt.shiftKey?(evt.preventDefault(),addCustom()):App.Keyboard.isTab(key)&&!evt.shiftKey||App.Keyboard.isEnter(key)?(evt.preventDefault(),addCustom()):App.Keyboard.isEsc(key)&&($otherInput.val(""),addCustom()))},_selectLi=function(e){if(oe=e.originalEvent,"touchstart"==e.type)hasMove=!1,startY=oe.touches[0].pageY;else if("touchmove"==e.type)hasMove=Math.abs(startY-oe.touches[0].pageY)>20;else if("touchend"==e.type||"mouseup"==e.type){if(hasMove)return!0;e.stopPropagation(),checkSelect($(e.currentTarget))}},_okCustom=function(){return addCustom(),!1},_inputBlur=function(){resetOther()},_inputMouseUp=function(e){e.stopPropagation()}};$.fn.list=function(options){return this.each(function(){var element=$(this);if(!element.data("control")){var list=new List(element,options||{});element.data("control",list)}})},function(){!function($){return this.Dropdown=function(){function Dropdown(element,options){this.options=$.extend({},defaults,options),this.$elem=$(element),this.$question=this.$elem.find(".question > span"),this.$item=this.$elem.find(".item > span"),this.$select=this.$elem.find("select"),this.required=this.$elem.hasClass("required"),this.$confirm=this.$elem.find(".container.confirm"),this.$active=!1,this.value="",this.pipeValue="",this.isMac=-1!==navigator.userAgent.indexOf("Mac OS X")?!0:!1}var defaults,done,hasSelect,removeAccents,setDropdownHeight,_controlHeight,_inputEvents,_mousewheel,_open,_reset,_touch;return defaults={awesomise:!1,openAnswer:!1,Scroll:!1},Dropdown.prototype.attachLimit={"default":180,large:160,small:120},done=!1,Dropdown.prototype.init=function(){var $notFound,$wrapper,self;return self=this,this.data=[],this.options.awesomise?(this.$select.children("option").map(function(index){return index>0?self.data.push($(this).attr("value")):void 0}),this.$input=$("<input class='secondaryColor' type='text' placeholder='"+App.Texts["type-select"]+"'/>"),$wrapper=$("<div class='input-wrapper'><a href='#' class='cross secondaryColor'><span></span></a><a href='#' class='triangle'><span></span></a></div>"),$notFound=$('<div class="not-found"><div class="text secondaryColor">'+App.Texts["not-found"]+"</div></div>"),this.$select.after($wrapper.append(this.$input,$notFound)),this.$select.remove(),this.$input.typeahead({minLength:0,items:400,wrapper:'<div class="dropdown-wrapper nano"></div>',menu:'<ul class="typeahead dropdown-menu nano-content"></ul>',item:'<li class="container step'+window.containerStep+'"><a class="secondaryColor" href="#"></a><span class="secondaryColor tick"></span><div class="aux secondaryColorBorder"><div class="inset"></div><div class="bg"></div><div class="bd"></div><img class="light" src="/bundles/quickyformapp/images/container-gradient.png"/><img class="dark" src="/bundles/quickyformapp/images/container-gradient-dark.png"/><div class="overlay"></div></div></li>',source:this.data,matcher:function(item){return~removeAccents(item.toLowerCase()).indexOf(removeAccents(this.query.toLowerCase()))},updater:function(item){return self.$active&&self.$active.removeClass("selected"),self.$active=self.$nanoScroll.find(".active"),self.$active.addClass("selected").children(".aux").selectEffect(2),setTimeout(function(){return self.$nanoScroll.hide(0),self.setValue(),typeform.Form.check(),form.autoNext(!1)},700),item},onProcess:function(results){return results?self.$elem.removeClass("not-found"):self.$elem.addClass("not-found")},onDropdownShow:function(){var limit;return self.$elem.addClass("dropdown-show"),$("body").addClass("focus-current"),form.error.hide(self.$elem),setTimeout(function(){return self.$nanoScroll.css("height",self.$input.data("dropdown-height")).show(0),self.$nanoScroll.nanoScroller()},0),setTimeout(function(){return self.$nanoScroll.css("height",self.$input.data("dropdown-height")).show(0),self.$nanoScroll.nanoScroller()},1e3),limit=self.position.next-10,window.pageYOffset<limit&&(self.$nanoScroll.hide(0),self.options.Scroll.scrollToPos(limit,function(){return setTimeout(function(){return self.$nanoScroll.show(0)},150)})),$(window).on("mousewheel.typeahead",self,_mousewheel),self.$elem.off(".triangle").on("click.triangle",".triangle",self,!1)},onDropdownHide:function(){return self.$elem.removeClass("dropdown-show"),$("body").removeClass("focus-current"),$(window).off("mousewheel.typeahead"),self.$nanoScroll.hide(0),setTimeout(function(){return self.$elem.off(".triangle").on("click.triangle",".triangle",self,_open)},200)},onActive:function($li){var liOffset;return $li.addClass("active"),liOffset=$li[0].offsetTop,self.$nanoContent.stop(!0,!0).animate({scrollTop:liOffset-self.$input.data("dropdown-height")/2},200)}},setTimeout(function(){return self.$nanoScroll=self.$elem.find(".dropdown-wrapper"),self.$nanoContent=self.$nanoScroll.children(".nano-content"),self.$nanoScroll.nanoScroller({contentClass:"dropdown-menu",preventPageScrolling:!0})},1e3))):this.$select.after("<div class='dropdown-icon'></div>")},Dropdown.prototype.set=function(attr,value){return this[attr]=value,("isActive"===attr||"isVisible"===attr)&&(this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active")),"index"===attr&&value?this.$item.html(value):void 0
},Dropdown.prototype.bindEvents=function(){var _this=this;return this.options.awesomise?(this.$input.on("keyup.e keydown.e",this,_inputEvents),this.$elem.on("click.e","input",this,_open).on("click.triangle",".triangle",this,_open).on("click.e",".cross",this,_reset).on("change.e input.e","input",function(){return _this.setValue(),typeform.Form.check()}),$(window).on("scrollstop.e",this,_controlHeight)):(this.$select.on("change.e",this,_touch),Globals.isIPad?void 0:this.$select.on("touchstart.e blur.e",_touch))},Dropdown.prototype.unbindEvents=function(){return this.options.awesomise?(this.$input.blur().off(".e"),$(window).off(".e"),this.$elem.off(".triangle")):(this.$select.off(".e"),this.$select.blur()),this.$elem.off(".e")},Dropdown.prototype.preOpen=function(){return this.bindEvents()},Dropdown.prototype.open=function(){var _this=this;return this.done=!0,this.options.awesomise&&(setDropdownHeight(this),Globals.useFocus)?_.defer(function(){return _this.$input.focus()}):void 0},Dropdown.prototype.advanceArrow=function(){},Dropdown.prototype.advanceTab=function(){return!0},Dropdown.prototype.checkEnter=function(){return!1},Dropdown.prototype.preSelectFirst=function(){return!1},Dropdown.prototype.preSelectLast=function(){return!1},Dropdown.prototype.setValue=function(callback){return this.value=this.options.awesomise?this.$input.val():this.$select.val(),this.pipeValue=this.value,this.isCompleted=""!==this.value,callback?callback():void 0},Dropdown.prototype.validate=function(callback,showError){var found,result;return showError="undefined"==typeof showError?!0:showError,this.required&&""===this.value?(showError&&form.error.show(this.$elem,App.Texts.required),!1):!this.options.awesomise||""===this.value||this.options.openAnswer||(result=this.$input.val(),found=!this.data.every(function(option){return result!==option}))?(callback&&callback(),!0):(showError&&form.error.show(this.$elem,App.Texts["type-select"]),!1)},Dropdown.prototype.resize=function(){},Dropdown.prototype.showResult=function(){},Dropdown.prototype.update=function(obj){var question;return question=obj.question,""===question?this.$elem.hide():(this.$elem.show(),this.$question.html(question)),this.options.awesomise?this.$input.data("typeahead").source=obj.options:void 0},removeAccents=function(r){return r=r.replace(new RegExp("\\s","g"),""),r=r.replace(new RegExp("[]","g"),"a"),r=r.replace(new RegExp("","g"),"ae"),r=r.replace(new RegExp("","g"),"c"),r=r.replace(new RegExp("[]","g"),"e"),r=r.replace(new RegExp("[]","g"),"i"),r=r.replace(new RegExp("","g"),"n"),r=r.replace(new RegExp("[]","g"),"o"),r=r.replace(new RegExp("","g"),"oe"),r=r.replace(new RegExp("[]","g"),"u"),r=r.replace(new RegExp("[]","g"),"y"),r=r.replace(new RegExp("\\W","g"),"")},setDropdownHeight=function(self){var h,offset;return offset=112,"field"===Globals.parent&&(offset=50),h=$(window).height()-self.$input.offset().top+window.pageYOffset-offset,self.$input.data("dropdown-height",h),h},hasSelect=!1,_inputEvents=function(e){var key,self;return key=document.all?e.keyCode:e.which,self=e.data,(App.Keyboard.isArrowLeft(key)||App.Keyboard.isArrowRight(key))&&e.stopPropagation(),"keydown"===e.type?App.Keyboard.isEnter(key)?!1:!0:"keyup"===e.type?(form.error.hide(self.$elem),!0):void 0},_open=function(e){var self;return self=e.data,self.$input.focus().data("typeahead").lookup(),!1},_reset=function(e){var self;return self=e.data,self.$elem.removeClass("not-found"),self.$input.val("").focus(),!1},_touch=function(e){var self,_this=this;return self=e.data,"change"===e.type?($(this).blur(),self.setValue(),typeform.Form.check(),form.autoNext("fast")):"touchstart"===e.type?($("body").addClass("dropdown-focus"),$(window).on("touchmove.w",function(e){return"INPUT"!==e.target.nodeName&&"TEXTAREA"!==e.target.nodeName?$(_this).blur():void 0})):"blur"===e.type||"focusout"===e.type?($("body").removeClass("dropdown-focus"),$(window).off(".w")):void 0},_controlHeight=function(e){var h,self;return self=e.data,h=setDropdownHeight(self),"undefined"!=typeof self.$nanoScroll?self.$nanoScroll.css("height",h):void 0},_mousewheel=function(e,deltaY){var self,sliderY;return self=e.data,sliderY=self.isMac?-deltaY:40*-deltaY,self.$nanoScroll.children().scrollTop(self.$nanoScroll.children().scrollTop()+sliderY),!1},Dropdown}(),$.fn.dropdown=function(options){var args;return args=$.makeArray(arguments).slice(1),this.each(function(){var obj;return obj=$.data(this,"control"),obj?"string"==typeof options?obj[command].apply(obj,args):void 0:$.data(this,"control",new Dropdown(this,options))})}}(jQuery)}.call(this),function(){var Group;Group=function(){function Group($elem,model,templates,currencyFormatter,priceCalculator,numberFormatter){var _this=this;this.$elem=$elem,this.model=model,this.templates=templates,this.currencyFormatter=currencyFormatter,this.priceCalculator=priceCalculator,this.numberFormatter=numberFormatter,this.has_button=null!=this.$elem.data("button"),this.subQuestions=[],this.$span=this.$elem.find(".question > span"),this.$item=this.$elem.find(".item > span"),this.$button_wrap=this.$elem.find(".button-wrap"),this.checkButton(),""===this.$span.html()&&this.$elem.hide(),this.isPaymentField()&&(this.model.set("filled",!1),this.compileTemplates(),this.model.on("change:price change:currency",this.renderStripeDescription,this),this.priceCalculator.on("change:total",function(){return model.set({price:_this.priceCalculator.get("total")})}))}return Group.prototype.$elem=null,Group.prototype.$span=null,Group.prototype.$item=null,Group.prototype.$button_wrap=null,Group.prototype.value="",Group.prototype.pipeValue="",Group.prototype.isCompleted=!0,Group.prototype.required=!1,Group.prototype.done=!1,Group.prototype.confirmText="default",Group.prototype.attachLimit={"default":140,large:130,small:100},Group.prototype.stripeTemplates=null,Group.prototype.isPaymentField=function(){return null!=this.model.get("price")&&null!=this.model.get("currency")},Group.prototype.init=function(){return this.isPaymentField()&&this.renderStripeDescription(),this},Group.prototype.addSubquestion=function(child){var _this=this;child.$elem.on("change-value",function(){return _this.model.set("filled",_this.isFilled())}),this.subQuestions.push(child)},Group.prototype.getSubquestions=function(){return this.subQuestions},Group.prototype.getActiveAndVisibleSubquestions=function(){return _.where(this.subQuestions,{isVisible:!0,isActive:!0})},Group.prototype.isFilled=function(){return _.some(this.getValues(),function(value){return null!=value&&""!==value})},Group.prototype.getPrice=function(){var _this=this;return{amount:this.model.get("price"),currency:this.model.get("symbol"),toString:function(){return _this.model.get("symbol")+_this.model.get("price")}}},Group.prototype.getCurrency=function(){return this.model.get("currency")},Group.prototype.getValues=function(){var values;return values={},_.each(this.subQuestions,function(control){return values[control.model.get("name")]=_.isObject(control.value)?control.value.choices||"":control.value}),values},Group.prototype.compileTemplates=function(){return this.stripeTemplates={priceSentence:_.template(_.unescape(App.Texts.payment_description_price)),stripeBanner:_.template(_.unescape(App.Texts.payment_description_stripe)),stripeDescription:_.template(this.templates.stripeDescription)}},Group.prototype.renderStripeDescription=function(){var priceSentence,stripeBanner,stripeDescription,total;total=this.numberFormatter.formatTo2Decimals(this.model.get("price")),priceSentence=this.stripeTemplates.priceSentence({price:this.currencyFormatter.format(this.model.get("currency"),total)}),stripeBanner=this.stripeTemplates.stripeBanner({logo:this.templates.stripeLogo}),stripeDescription=this.stripeTemplates.stripeDescription({price:priceSentence,advice:App.Texts.payment_description_advice,stripeBanner:stripeBanner}),null!=this.$stripeDescription?this.$stripeDescription.html(stripeDescription):(this.$stripeDescription=$($.parseHTML(stripeDescription)),this.$elem.find(".control").prepend(this.$stripeDescription))},Group.prototype.set=function(attr,value){this[attr]=value,"isActive"===attr||"isVisible"===attr?this.isVisible&&this.isActive?this.$elem.addClass("active"):this.$elem.removeClass("active"):"index"===attr&&value&&this.$item.html(value)},Group.prototype.bindEvents=function(){var evt;evt="touch"===Globals.browser?"touchend":"mouseup",this.$elem.on(evt+".e",".button",_.debounce(function(){return typeform.Form.check(),form.autoNext(),$(this).removeClass("active"),!1},Globals.debounceWait,!0))},Group.prototype.unbindEvents=function(){return this.$elem.off(".e")},Group.prototype.preOpen=function(){return this.bindEvents()},Group.prototype.open=function(){return this.done=!0},Group.prototype.advanceArrow=function(){return!0},Group.prototype.advanceTab=function(){return!0},Group.prototype.checkEnter=function(){return!0},Group.prototype.preSelectFirst=function(){return!1},Group.prototype.preSelectLast=function(){return!1},Group.prototype.setValue=function(callback){callback&&callback()},Group.prototype.validate=function(callback){return callback&&callback(),!0},Group.prototype.resize=function(){},Group.prototype.update=function(obj){var button_text,question;null!=obj.price&&null!=obj.currency&&this.model.set({price:obj.price,currency:obj.currency}),question=obj.question,""===question?this.$elem.hide():this.$elem.show(),"undefined"!=typeof obj.button&&(this.has_button=!_.isNull(obj.button)),this.checkButton(),this.has_button&&(button_text=""===obj.button?App.Texts["continue-button"]:obj.button,this.$button_wrap.find(".button > span").html(button_text)),this.$span.html(question),obj.placeholder&&"undefined"==typeof this.$placeholder&&(this.$placeholder=$("<div id='placeholder'></div>").html(obj.placeholder),this.$elem.append(this.$placeholder))},Group.prototype.checkButton=function(){this.has_button?this.$button_wrap.show():this.$button_wrap.hide()},Group}(),namespace("App.Control",function(exports){return exports.Group=Group})}.call(this),function(){var ButtonModel,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ButtonModel=function(_super){function ButtonModel(){return _ref=ButtonModel.__super__.constructor.apply(this,arguments)}return __extends(ButtonModel,_super),ButtonModel.prototype.defaults={label:"",extra:"",type:"",enabled:!0,sending:!1},ButtonModel}(Backbone.Model),namespace("App.components",function(exports){return exports.ButtonModel=ButtonModel})}.call(this),function(){var ButtonView,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ButtonView=function(_super){function ButtonView(){return _ref=ButtonView.__super__.constructor.apply(this,arguments)}return __extends(ButtonView,_super),ButtonView.prototype.model=null,ButtonView.prototype.className="button",ButtonView.prototype.tagName="div",ButtonView.prototype.events={click:"onClick",touchend:"onTouchend"},ButtonView.prototype.defaults={translations:{and:"and"}},ButtonView.prototype.initialize=function(options){return this.options=_.extend({},this.defaults,options),this.listenTo(this.model,"change:label change:extra",this.renderText,this),this.listenTo(this.model,"change:sending",this.renderSending,this),this.listenTo(this.model,"change:type",this.setTypeClass,this),this.listenTo(this.model,"change:enabled",this.setEnabledClass,this),this},ButtonView.prototype.render=function(){return this.renderText(),this.setTypeClass(),this.setEnabledClass(),this},ButtonView.prototype.renderText=function(){this.$el.html(this.getFullText())},ButtonView.prototype.renderSending=function(){this.model.get("sending")?(this.$el.width(this.$el.width()),this.$el.html("...")):(this.$el.width("auto"),this.renderText())},ButtonView.prototype.getFullText=function(){var text;return text=this.model.get("label"),_.isEmpty(this.model.get("extra"))||(_.isEmpty(text)||(text+=this.options.translations.and),text+=this.model.get("extra")),text},ButtonView.prototype.setTypeClass=function(){this.$el.removeClass(this.model.previous("type")),this.$el.addClass(this.model.get("type"))},ButtonView.prototype.setEnabledClass=function(){this.model.get("enabled")?this.$el.addClass("enabled"):this.$el.removeClass("enabled")},ButtonView.prototype.onClick=function(){this.trigger("click")},ButtonView.prototype.onTouchend=function(){this.trigger("touchend")},ButtonView.prototype.show=function(){return this.$el.show(),this},ButtonView.prototype.hide=function(){return this.$el.hide(),this},ButtonView}(Backbone.View),namespace("App.components",function(exports){return exports.ButtonView=ButtonView})}.call(this),function(){var AppFactory,isBuildPreview,isDesignPreview,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};AppFactory=function(){function AppFactory($typeform){this.$typeform=$typeform,this.buildScreen=__bind(this.buildScreen,this),window.Globals={browser:settings.browser,pageTransitionDelay:300,keyboardTimeout:500,debounceWait:200,useKeyboardEvents:"default"===settings.browser,useKeyboardScroll:!1,useFocus:"default"===settings.browser&&"field"!==settings.parent,isTouch:"default"!==settings.browser,responsiveThreshold:"default"===settings.browser?0:600,isMobile:"touch"===settings.browser&&$(window).width()<600,uniquePath:settings.uniquePath,uid:settings.uid,token:settings.token,language:settings.language,hiddenFieldsEnabled:settings.hiddenFieldsEnabled,signupPath:settings.signupPath,parent:settings.parent,lessPath:settings.lessPath,showLogo:settings.showLogo,isIe9:!1,isIOs:!1,isAndroid:!1,isChrome:!1,isFirefox:!1,isIPad:!1,vendor:/webkit/i.test(navigator.appVersion)?"-webkit-":/firefox/i.test(navigator.userAgent)?"-moz-":"opera"in window?"-O-":""},this.detectBrowser()}return AppFactory.prototype.$typeform=null,AppFactory.prototype.observer=null,AppFactory.prototype.browser=null,AppFactory.prototype.build=function(){var controlsFactory,currencyFormatter,hiddenFields,hiddenKeys,logicJumpsController,numberFormatter,outrosCollection,paymentField,priceCalculator,resizeWindow,scoreCalculator,submissionRepository,submitButton,texts,typeform,updateSubmitButtonText,_ref,_ref1,_this=this;return this.observer=_.extend({},Backbone.Events),this.browser=settings.browser,texts={},$("#texts").children().each(function(){return texts[$(this).attr("id")]=$(this).html()}).end().remove(),window.App.Texts=texts,submitButton=new App.components.ButtonView({translations:{and:texts.and},model:new App.components.ButtonModel({type:"general hover-effect",label:texts["submit-button"],enabled:!0})}),currencyFormatter=new App.CurrencyFormatter,numberFormatter=App.NumberFormatter,outrosCollection=this.buildOutrosCollection(),hiddenKeys={},settings.hiddenFieldsEnabled&&(hiddenKeys=settings.hiddenFields),hiddenFields=new App.Service.HiddenFields(hiddenKeys,window.location.search),_ref=App.Service.Calculator.CalculatorFactory.build(serializedForm),scoreCalculator=_ref.scoreCalculator,priceCalculator=_ref.priceCalculator,logicJumpsController=App.Service.LogicJumps.LogicJumpsControllerFactory.build(jumps,scoreCalculator,priceCalculator,outrosCollection,hiddenFields),controlsFactory=new App.ControlsFactory(serializedForm.fields,this.browser,currencyFormatter,priceCalculator,new App.Utils.FeatureDetector(Modernizr,window,this.browser,App.Utils.BrowserDetector),settings,numberFormatter),submissionRepository=new App.SubmissionRepository(window.settings.paths,window.settings.collect),submissionRepository.getToken(),typeform=new App.Typeform(this.$typeform,logicJumpsController,scoreCalculator,priceCalculator,submitButton,settings,currencyFormatter,numberFormatter,controlsFactory,this.observer,outrosCollection,hiddenFields,window.App.singletons.performanceLogger,submissionRepository),paymentField=null!=(_ref1=typeform.Form)?_ref1.getPaymentField():void 0,updateSubmitButtonText=function(){var currency,formatedPrice,total;if(null!=paymentField)return currency=paymentField.getCurrency(),total=numberFormatter.formatTo2Decimals(priceCalculator.get("total")),formatedPrice=currencyFormatter.format(currency,total),paymentField.isFilled()?submitButton.model.set("extra",texts.pay.replace("{{amount}}",formatedPrice)):submitButton.model.set("extra","")},updateSubmitButtonText(),priceCalculator.on("change:total",updateSubmitButtonText),null!=paymentField&&paymentField.model.on("change:filled",updateSubmitButtonText),"field"===settings.parent&&(superframe.initUpdateEvent&&superframe.initUpdateEvent(function(evt,obj){return _this.$typeform.trigger("updateControl",[obj])}),resizeWindow=function(){return $("#preview").css("height",superframe.innerHeight)},$(window).bind("resize",resizeWindow),resizeWindow()),typeform},AppFactory.prototype.buildOutrosCollection=function(){var outros,_this=this;return outros=[],this.$typeform.find(".outro").each(function(index,outro){return outros.push(_this.buildScreen(outro))}),new App.components.ScreenCollection(outros)},AppFactory.prototype.buildScreen=function(screen){var $screen,options;return $screen=$(screen),options={browser:this.browser,url:$screen.find("#redirect-button-url").val()},"fallback"===this.browser?new App.FallbackScreen($screen,options):new App.Screen($screen,this.observer,options)},AppFactory.prototype.detectBrowser=function(){if(navigator.userAgent.match(/msie/i)?navigator.userAgent.match(/9/)&&(Globals.isIe9=!0,$("body").addClass("ie9")):-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")?$("body").addClass("safari"):navigator.userAgent.match(/firefox/i)&&$("body").addClass("mozilla"),/(iPhone|iPod|iPad)/i.test(navigator.userAgent)){if(Globals.isIOs=!0,$("body").addClass("ios"),/CriOS/i.test(navigator.userAgent)&&(Globals.isChrome=!0),/(iPad)/i.test(navigator.userAgent)&&(Globals.isIPad=!0),/(iPhone|iPod)/i.test(navigator.userAgent))return $("body").addClass("iphone")}else if(/(Android)/i.test(navigator.userAgent)&&(Globals.isAndroid=!0,$("body").addClass("android"),/Chrome/i.test(navigator.userAgent)&&(Globals.isChrome=!0,$("body").addClass("chrome")),/Firefox/i.test(navigator.userAgent)))return Globals.isFirefox=!0},AppFactory}(),$(function(){var appFactory;return appFactory=new AppFactory($("#typeform")),window.typeform=appFactory.build()}),isDesignPreview=function(parentPage){return"design"===parentPage},isBuildPreview=function(parentPage){return"field"===parentPage},namespace("App.singletons",function(exports){var cookiesAdapter;return cookiesAdapter=new App.Utils.CookiesAdapter(window.Cookies),exports.performanceLogger=new App.Logger.PerformanceLogger(window.newrelic,cookiesAdapter,{isEnabled:null!=window.settings&&!isDesignPreview(window.settings.parent)&&!isBuildPreview(window.settings.parent)}),exports.performanceLogger.applyCustomAttributes(window.settings,serializedForm,navigator)})}.call(this);